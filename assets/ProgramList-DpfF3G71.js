import{j as r,u as j}from"./index-oRYx91ZM.js";import{d as P,b as d}from"./react-vendor-DQubVtpq.js";import{E as N,P as C}from"./ProgramModal-DK9YdCbu.js";import{j as E}from"./firebase-vendor-D8cnFtZG.js";import{F as A}from"./TrashIcon-DAbwCWt1.js";const L={Any:"bg-gray-500",Beginner:"bg-green-600",Intermediate:"bg-yellow-600",Advanced:"bg-red-600"},S=({onSelect:l})=>{const u=P(),{programs:c,addProgram:b,refresh:n,deleteProgram:f}=j(),[w,g]=d.useState(!1),[h,o]=d.useState(null),[x,p]=d.useState(null),m=E();d.useEffect(()=>{if(m.currentUser)try{n()}catch(e){console.error("Error refreshing programs:",e),o("Failed to load programs")}},[m.currentUser,n]);const v=async e=>{o(null);const t=m.currentUser;if(!t){o("You must be logged in to create a program");return}const i={name:e.name,description:e.description||"",level:e.level.toLowerCase(),createdBy:t.uid,sessions:[],isPublic:!1,tags:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};console.log("[ProgramList] Creating new program:",i);try{await b(i),console.log("[ProgramList] Program created successfully"),g(!1),await n();const s=c.find(a=>a.name===e.name&&a.userId===t.uid&&a.createdBy===t.uid);s?u(`/programs/${s.id}`):console.log("[ProgramList] Created program not found in list, staying on programs page")}catch(s){const a=s instanceof Error?s.message:"Failed to create program";console.error("[ProgramList] Error in handleAdd:",s),o(a)}},y=async(e,t,i)=>{if(i.stopPropagation(),window.confirm(`Are you sure you want to delete the program "${t}"? This action cannot be undone.`)){p(e),o(null);try{console.log("[ProgramList] Deleting program:",e),await f(e),console.log("[ProgramList] Program deleted successfully"),await n()}catch(s){const a=s instanceof Error?s.message:"Failed to delete program";console.error("[ProgramList] Error deleting program:",s),o(a)}finally{p(null)}}};return r.jsxs("div",{className:"relative min-h-screen pb-20",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Programs"}),h&&r.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:h}),c.length===0?r.jsx("div",{className:"text-center p-8 text-gray-500",children:"No programs found. Click the + button to create one."}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:c.map(e=>r.jsxs("div",{className:"relative bg-[#23272F] rounded-xl p-4 flex flex-col items-start justify-between min-h-[120px] shadow-md cursor-pointer overflow-hidden group",onClick:()=>l?l(e.id):u(`/programs/${e.id}`),children:[r.jsx("div",{className:"absolute right-3 top-3 opacity-20 text-5xl pointer-events-none select-none",children:r.jsx("span",{role:"img","aria-label":"kettlebell",children:"ðŸ‹ï¸â€â™‚ï¸"})}),r.jsx("button",{onClick:t=>y(e.id,e.name,t),disabled:x===e.id,className:"absolute top-2 left-2 p-1.5 bg-red-600/80 hover:bg-red-500 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-200 z-20 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete program","aria-label":`Delete program ${e.name}`,children:x===e.id?r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):r.jsx(A,{className:"w-4 h-4"})}),r.jsx("div",{className:"font-semibold text-lg text-white mb-1 z-10",children:e.name}),r.jsxs("div",{className:"flex items-center gap-2 z-10",children:[r.jsx("span",{className:`px-2 py-0.5 rounded text-xs text-white ${L[e.level.charAt(0).toUpperCase()+e.level.slice(1)]||"bg-gray-700"}`,children:e.level.charAt(0).toUpperCase()+e.level.slice(1)}),e.sessions&&e.sessions.length>0&&r.jsxs("span",{className:"text-gray-400 text-xs",children:[e.sessions.length," session",e.sessions.length!==1?"s":""]})]}),e.description&&r.jsx("div",{className:"text-gray-400 text-xs mt-2 z-10 line-clamp-2",children:e.description})]},e.id))}),r.jsx("button",{className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-500 text-white rounded-full w-14 h-14 flex items-center justify-center text-3xl shadow-lg z-50",onClick:()=>g(!0),"aria-label":"Add Program",children:"+"}),r.jsx(C,{isOpen:w,onClose:()=>{g(!1),o(null)},onSave:v})]})},U=l=>r.jsx(N,{fallback:r.jsx("div",{className:"text-white p-4",children:"Error loading programs. Please try again."}),children:r.jsx(S,{...l})});export{U as default};
//# sourceMappingURL=ProgramList-DpfF3G71.js.map
