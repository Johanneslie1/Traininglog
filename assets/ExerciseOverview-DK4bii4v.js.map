{"version":3,"file":"ExerciseOverview-DK4bii4v.js","sources":["../../src/hooks/useCollection.ts","../../src/pages/ExerciseOverview.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Query, onSnapshot } from 'firebase/firestore';\r\n\r\ninterface UseCollectionResult<T> {\r\n  documents: T[] | null;\r\n  error: Error | null;\r\n  loading: boolean;\r\n}\r\n\r\nexport function useCollection<T>(query: Query): UseCollectionResult<T> {\r\n  const [documents, setDocuments] = useState<T[] | null>(null);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = onSnapshot(\r\n      query,\r\n      (snapshot) => {\r\n        const results: T[] = [];\r\n        snapshot.forEach((doc) => {\r\n          results.push({ ...(doc.data() as T), id: doc.id });\r\n        });\r\n        setDocuments(results);\r\n        setLoading(false);\r\n      },\r\n      (err) => {\r\n        console.error('Error fetching collection:', err);\r\n        setError(err);\r\n        setLoading(false);\r\n      }\r\n    );\r\n\r\n    return () => unsubscribe();\r\n  }, [query]);\r\n\r\n  return { documents, error, loading };\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useCollection } from '@/hooks/useCollection';\r\nimport { db } from '@/services/firebase/config';\r\nimport { collection, query, where, orderBy, QueryConstraint } from 'firebase/firestore';\r\nimport type { Exercise } from '@/types/exercise';\r\nimport { CreateExerciseDialog } from '@/components/exercises/CreateExerciseDialog';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useLocation } from 'react-router-dom';\r\ninterface FilterState {\r\n  search: string;\r\n  category: string[];\r\n  type: 'all' | 'default' | 'custom';\r\n}\r\n\r\nconst ExerciseOverview: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const [filters, setFilters] = useState<FilterState>({\r\n    search: '',\r\n    category: [],\r\n    type: 'all'\r\n  });\r\n  const [showCreateDialog, setShowCreateDialog] = useState(false);\r\n\r\n  // Get URL search params to check if we should show create dialog\r\n  const location = useLocation();\r\n  const searchParams = new URLSearchParams(location.search);\r\n  \r\n  useEffect(() => {\r\n    if (searchParams.get('showCreate') === 'true') {\r\n      setShowCreateDialog(true);\r\n    }\r\n  }, [searchParams]);\r\n\r\n  // Fetch exercises\r\n  const queryConstraints: QueryConstraint[] = [];\r\n\r\n  if (filters.type === 'custom' && user) {\r\n    queryConstraints.push(where('userId', '==', user.id));\r\n  } else if (filters.type === 'default') {\r\n    queryConstraints.push(where('userId', '==', null));\r\n  }\r\n  queryConstraints.push(orderBy('name'));\r\n\r\n  const exercisesQuery = query(\r\n    collection(db, 'exercises'),\r\n    ...queryConstraints\r\n  );\r\n\r\n  const { documents: exercises, loading, error } = useCollection<Exercise>(exercisesQuery);\r\n\r\n  // Filter exercises based on search and category\r\n  // Filter exercises based on search and category\r\n  const filteredExercises = exercises?.filter((exercise: Exercise) => {\r\n    if (!exercise) return false;\r\n    \r\n    const matchesSearch = exercise.name.toLowerCase().includes(filters.search.toLowerCase()) ||\r\n      exercise.description?.toLowerCase().includes(filters.search.toLowerCase());\r\n    \r\n    const matchesCategory = filters.category.length === 0 || \r\n      (exercise.category && filters.category.includes(exercise.category));\r\n\r\n    return matchesSearch && matchesCategory;\r\n  });\r\n\r\n  // Get unique categories\r\n  const categories = exercises\r\n    ? [...new Set(exercises.filter((ex: Exercise) => ex && ex.category).map((ex: Exercise) => ex.category))]\r\n    : [];\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      {/* Header */}\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-2xl font-bold text-text-primary\">Exercise Library</h1>\r\n        <button\r\n          onClick={() => setShowCreateDialog(true)}\r\n          className=\"bg-accent-primary text-white px-4 py-2 rounded-lg hover:bg-accent-primary/90\"\r\n        >\r\n          Create Exercise\r\n        </button>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"space-y-4 mb-6\">\r\n        <div className=\"flex flex-col sm:flex-row gap-4\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search exercises...\"\r\n            className=\"flex-1 px-4 py-2 rounded-lg bg-bg-secondary text-text-primary border border-border\"\r\n            value={filters.search}\r\n            onChange={(e) => setFilters(prev => ({ ...prev, search: e.target.value }))}\r\n          />\r\n          <select\r\n            className=\"px-4 py-2 rounded-lg bg-bg-secondary text-text-primary border border-border\"\r\n            value={filters.type}\r\n            onChange={(e) => setFilters(prev => ({ ...prev, type: e.target.value as FilterState['type'] }))}\r\n          >\r\n            <option value=\"all\">All Exercises</option>\r\n            <option value=\"default\">Default Exercises</option>\r\n            <option value=\"custom\">Custom Exercises</option>\r\n          </select>\r\n        </div>\r\n        \r\n        <div className=\"flex flex-wrap gap-2\">\r\n          {categories.map(category => (\r\n            <button\r\n              key={category as string}\r\n              onClick={() => setFilters(prev => ({\r\n                ...prev,\r\n                category: prev.category.includes(category as string)\r\n                  ? prev.category.filter(c => c !== category)\r\n                  : [...prev.category, category as string]\r\n              }))}\r\n              className={`px-3 py-1 rounded-full text-sm ${\r\n                filters.category.includes(category as string)\r\n                  ? 'bg-accent-primary text-white'\r\n                  : 'bg-bg-secondary text-text-secondary border border-border'\r\n              }`}\r\n            >\r\n              {category as string}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Exercise List */}\r\n      {loading && (\r\n        <div className=\"text-center py-8\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-accent-primary mx-auto\"></div>\r\n        </div>\r\n      )}\r\n\r\n      {error && (\r\n        <div className=\"text-red-500 text-center py-8\">\r\n          Error loading exercises: {error.message}\r\n        </div>\r\n      )}\r\n\r\n      {!loading && !error && (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {filteredExercises?.map((exercise: Exercise) => (\r\n            <div\r\n              key={exercise.id || ''}\r\n              className=\"p-4 rounded-lg bg-bg-secondary border border-border hover:border-accent-primary transition-colors\"\r\n            >\r\n              <h3 className=\"text-lg font-semibold text-text-primary mb-2\">\r\n                {exercise.name}\r\n              </h3>\r\n              <div className=\"flex items-center gap-2 text-sm text-text-secondary mb-2\">\r\n                <span className=\"px-2 py-0.5 rounded-full bg-bg-primary\">\r\n                  {exercise.category}\r\n                </span>\r\n                {exercise.userId ? (\r\n                  <span className=\"px-2 py-0.5 rounded-full bg-accent-primary/10 text-accent-primary\">\r\n                    Custom\r\n                  </span>\r\n                ) : (\r\n                  <span className=\"px-2 py-0.5 rounded-full bg-green-500/10 text-green-500\">\r\n                    Default\r\n                  </span>\r\n                )}\r\n              </div>\r\n              {exercise.description && (\r\n                <p className=\"text-sm text-text-secondary line-clamp-2\">\r\n                  {exercise.description}\r\n                </p>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Create Exercise Dialog */}\r\n      {showCreateDialog && (\r\n        <CreateExerciseDialog\r\n          onClose={() => setShowCreateDialog(false)}\r\n          onSuccess={() => {\r\n            setShowCreateDialog(false);\r\n            // Exercises will automatically refresh due to useCollection hook\r\n          }}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ExerciseOverview;\r\n"],"names":["useCollection","query","documents","setDocuments","useState","error","setError","loading","setLoading","useEffect","unsubscribe","onSnapshot","snapshot","results","doc","err","ExerciseOverview","user","useAuth","filters","setFilters","showCreateDialog","setShowCreateDialog","location","useLocation","searchParams","queryConstraints","where","orderBy","exercisesQuery","collection","db","exercises","filteredExercises","exercise","matchesSearch","_a","matchesCategory","categories","ex","jsxs","jsx","prev","category","c","CreateExerciseDialog"],"mappings":"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"}