import{b as M,j as e}from"./index-hOws252K.js";import{d as S,b as n}from"./react-vendor-DQubVtpq.js";import{b as D,e as B,E as W,d as O}from"./ExerciseCard-B7UjJGlB.js";import"./firebase-vendor-D8cnFtZG.js";const V=()=>{const h=S(),s=M(t=>t.auth.user),[p,m]=n.useState([]),[a,v]=n.useState(new Date),[y,x]=n.useState(!0),[j,l]=n.useState(null),i=n.useCallback(t=>{const r=new Date(t);return r.setHours(0,0,0,0),r},[]),b=n.useCallback(t=>{const r=i(t),o=new Date(r);return o.setHours(23,59,59,999),{startOfDay:r,endOfDay:o}},[i]),u=n.useCallback(async t=>{if(x(!0),l(null),!(s!=null&&s.id)){m([]),x(!1);return}const r=i(t);try{const o=D(r),{startOfDay:f,endOfDay:L}=b(r),w=await B(s.id,f,L),C=o.filter(c=>!c.id||!w.some(d=>d.id===c.id)),k=[...w,...C];k.sort((c,d)=>{const T=c.timestamp instanceof Date?c.timestamp.getTime():new Date(c.timestamp).getTime(),I=d.timestamp instanceof Date?d.timestamp.getTime():new Date(d.timestamp).getTime();return T-I}),m(k)}catch(o){console.error("Error fetching exercises:",o);const f=D(r);m(f),l(o instanceof Error?o.message:"An error occurred")}finally{x(!1)}},[s==null?void 0:s.id,i,b]);n.useEffect(()=>{s!=null&&s.id?u(a):(m([]),x(!1))},[s==null?void 0:s.id,a]);const g=n.useCallback(t=>{const r=i(t);v(r)},[i]),N=t=>t.toLocaleDateString("no-NO",{day:"numeric",month:"long"}),E=async t=>{if(!t.id||!(s!=null&&s.id)){const r="Cannot delete exercise: missing user ID or exercise ID";console.error(r,{userId:s==null?void 0:s.id,exerciseId:t.id}),l(r);return}if(window.confirm(`Are you sure you want to delete "${t.exerciseName}"?`))try{console.log("ðŸ—‘ï¸ Attempting to delete exercise:",{exerciseId:t.id,userId:s.id}),await O(t.id,s.id),console.log("âœ… Exercise deleted from Firestore successfully"),await u(a)}catch(r){console.error("âŒ Error deleting exercise:",r);const o=r instanceof Error?r.message:"An unknown error occurred";l(`Failed to delete exercise: ${o}`),await u(a)}};return y?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"p-4 bg-black min-h-screen text-white",children:[j&&e.jsxs("div",{className:"bg-red-500 text-white p-4 rounded-lg mb-4 flex justify-between items-center",children:[e.jsx("span",{children:j}),e.jsx("button",{onClick:()=>l(null),className:"text-white",children:"âœ•"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h("/"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Back to Exercise Log",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Dashboard - ",N(a)]}),e.jsx("small",{className:"text-gray-400",children:"Exercise Summary"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",onClick:()=>g(new Date(a.getTime()-864e5)),"aria-label":"Previous day",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",onClick:()=>g(new Date),"aria-label":"Today",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",onClick:()=>g(new Date(a.getTime()+864e5)),"aria-label":"Next day",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),e.jsx("div",{className:"space-y-4",children:p.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx("p",{children:"No exercises logged for this date"}),e.jsx("button",{onClick:()=>h("/"),className:"mt-4 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors",children:"Go to Exercise Log"})]}):p.map(t=>{const r={...t,timestamp:t.timestamp instanceof Date?t.timestamp:new Date(t.timestamp),userId:t.userId??(s?s.id:"")};return e.jsx(W,{exercise:r,onDelete:()=>E(r)},t.id||`${t.exerciseName}-${new Date(t.timestamp).getTime()}`)})}),e.jsx("button",{className:"fixed right-6 bottom-6 w-16 h-16 bg-green-600 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-green-700 transition-colors",onClick:()=>h("/"),"aria-label":"Go to Exercise Log",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})};export{V as default};
//# sourceMappingURL=Dashboard-q-AWd12b.js.map
