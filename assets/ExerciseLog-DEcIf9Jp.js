import{j as s,c as mt,d as ve,b as Ie,_ as On,a as Mn,h as Fr,e as Wr,f as ei,g as ti,i as ri,E as ni,S as ai}from"./index-BW4wnaLN.js";import{b as S,h as $,c as ii,i as oi,u as si}from"./react-vendor-DOxSmbpi.js";import{P as li}from"./ProgramModal-gqqF9Ltc.js";import{A as j,D as se,g as Ln,U as Et,a as ci,c as ui,e as di,l as pi,b as mi,s as gi,E as fi,P as vi,C as hi,d as xi,f as Ht,h as bi,i as Ke,v as Hr,j as yi,k as Ur}from"./ExerciseHistoryPicker-mDNrnu8A.js";import{T as tr,l as Ze,m as rr,B as nr,n as jt,z as wi,q as dr,o as gt,D as Bn,t as pr}from"./firebase-vendor-CDzPPbaT.js";import{d as Si}from"./speedAgility-DxCoHWLB.js";import{e as Ni,c as Ci,a as Di}from"./speedAgilityFilters-C5QwlS5y.js";import"./useAuth-Bl_XYtwH.js";function L(){return L=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},L.apply(null,arguments)}function ft(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}const Fn=S.createContext(void 0),nt=()=>{const t=S.useContext(Fn);if(!t)throw new Error("useSupersets must be used within a SupersetProvider");return t},Ei="superset_data",ji="exercise_order",Wn=t=>`${Ei}_${t}`,Hn=t=>`${ji}_${t}`,Ii=t=>{try{const e=localStorage.getItem(Wn(t));return e?JSON.parse(e):[]}catch(e){return console.error("Error loading supersets from storage:",e),[]}},Gr=(t,e)=>{try{localStorage.setItem(Wn(t),JSON.stringify(e))}catch(r){console.error("Error saving supersets to storage:",r)}},Ut=(t,e)=>{try{localStorage.setItem(Hn(t),JSON.stringify(e))}catch(r){console.error("Error saving exercise order to storage:",r)}},ki=t=>{try{const e=localStorage.getItem(Hn(t));return e?JSON.parse(e):[]}catch(e){return console.error("Error loading exercise order from storage:",e),[]}},Ti=({children:t})=>{const[e,r]=S.useState({isCreating:!1,selectedExercises:[],activeSuperset:null,supersets:[]}),[n,i]=S.useState(""),[a,o]=S.useState([]),l=S.useCallback(I=>{const N=Ii(I),D=ki(I);r(O=>({...O,supersets:N})),o(D),i(I)},[]),c=S.useCallback(I=>{Gr(I,e.supersets),Ut(I,a)},[e.supersets,a]);S.useEffect(()=>{n&&Gr(n,e.supersets)},[e.supersets,n]),S.useEffect(()=>{n&&a.length>0&&Ut(n,a)},[a,n]);const p=S.useCallback(I=>{o(I),n&&Ut(n,I)},[n]),m=S.useCallback(()=>{r(I=>({...I,isCreating:!0,selectedExercises:[]}))},[]),u=S.useCallback(()=>{r(I=>({...I,isCreating:!1,selectedExercises:[]}))},[]),d=S.useCallback(I=>{r(N=>({...N,selectedExercises:N.selectedExercises.includes(I)?N.selectedExercises.filter(D=>D!==I):[...N.selectedExercises,I]}))},[]),g=S.useCallback(I=>{if(e.selectedExercises.length<2)return null;const N={id:crypto.randomUUID(),name:I||`Superset ${e.supersets.length+1}`,exerciseIds:e.selectedExercises,order:e.supersets.length};return r(D=>({...D,supersets:[...D.supersets,N],isCreating:!1,selectedExercises:[]})),N},[e.selectedExercises,e.supersets.length]),f=S.useCallback(I=>{r(N=>({...N,supersets:N.supersets.filter(D=>D.id!==I)}))},[]),y=S.useCallback(I=>{r(N=>({...N,supersets:[...N.supersets,I]}))},[]),x=S.useCallback(I=>{r(N=>({...N,supersets:N.supersets.filter(D=>D.id!==I)}))},[]),b=S.useCallback(I=>e.supersets.find(N=>N.exerciseIds.includes(I))||null,[e.supersets]),v=S.useCallback(I=>e.supersets.some(N=>N.exerciseIds.includes(I)),[e.supersets]),h=S.useCallback(I=>{r(N=>({...N,supersets:N.supersets.map(D=>({...D,exerciseIds:D.exerciseIds.filter(O=>O!==I)})).filter(D=>D.exerciseIds.length>1)}))},[]),w=S.useCallback((I,N)=>{r(D=>({...D,supersets:D.supersets.map(O=>O.id===I?{...O,name:N}:O)}))},[]),E=S.useCallback(()=>{r({isCreating:!1,selectedExercises:[],activeSuperset:null,supersets:[]}),o([])},[]),T={state:e,startCreating:m,cancelCreating:u,toggleExerciseSelection:d,createSuperset:g,breakSuperset:f,addSuperset:y,removeSuperset:x,getSupersetByExercise:b,isExerciseInSuperset:v,removeExerciseFromSuperset:h,clearAll:E,loadSupersetsForDate:l,saveSupersetsForDate:c,updateExerciseOrder:p,renameSuperset:w};return s.jsx(Fn.Provider,{value:T,children:t})},qr={1:{label:"Very Easy",description:"No exertion at all"},2:{label:"Easy",description:"Extremely light exertion"},3:{label:"Light",description:"Very light exertion"},4:{label:"Moderate-",description:"Light exertion"},5:{label:"Moderate",description:"Moderate exertion"},6:{label:"Moderate+",description:"Somewhat hard exertion"},7:{label:"Hard",description:"Hard exertion"},8:{label:"Very Hard",description:"Very hard exertion"},9:{label:"Extremely Hard",description:"Extremely hard exertion"},10:{label:"Maximum",description:"Maximum exertion"}},Pi=t=>{var n,i;if(t.activityType)switch(t.activityType){case j.RESISTANCE:return"strength";case j.ENDURANCE:return"endurance";case j.STRETCHING:return"flexibility";case j.SPORT:return"sport";case j.SPEED_AGILITY:return"speed_agility";case j.OTHER:return"other"}if(t.type)switch(t.type){case"strength":case"bodyweight":return"strength";case"cardio":case"endurance":return"endurance";case"flexibility":return"flexibility";case"teamSports":return"sport";case"plyometrics":case"speedAgility":case"speed_agility":return"speed_agility";default:return t.type}const e=((n=t.name)==null?void 0:n.toLowerCase())||"";if(e.includes("treadmill")||e.includes("running")||e.includes("jogging")||e.includes("cycling")||e.includes("swimming")||e.includes("rowing")||e.includes("elliptical")||e.includes("cardio"))return"endurance";if(e.includes("soccer")||e.includes("football")||e.includes("basketball")||e.includes("tennis")||e.includes("volleyball")||e.includes("hockey")||e.includes("baseball")||e.includes("badminton"))return"sport";if(e.includes("high knees")||e.includes("butt kicks")||e.includes("ladder")||e.includes("cone")||e.includes("sprint")||e.includes("agility")||e.includes("plyometric")||e.includes("jump")||e.includes("hop")||e.includes("bounds"))return"speed_agility";if(e.includes("stretch")||e.includes("yoga")||e.includes("mobility")||e.includes("foam roll")||e.includes("massage"))return"flexibility";const r=((i=t.category)==null?void 0:i.toLowerCase())||"";return r.includes("cardio")||r.includes("running")||r.includes("cycling")?"endurance":r.includes("stretch")||r.includes("yoga")||r.includes("mobility")?"flexibility":r.includes("sport")||r.includes("team")?"sport":r.includes("plyometric")||r.includes("agility")||r.includes("speed")?"speed_agility":"strength"},$r=t=>{const e={weight:0,reps:0,difficulty:se.EASY};switch(t){case"strength":case"bodyweight":return{...e,weight:20,reps:10,rpe:5};case"endurance":return{...e,weight:0,reps:1,duration:30,distance:5,rpe:6,hrZone1:0,hrZone2:5,hrZone3:20,hrZone4:5,hrZone5:0};case"flexibility":return{...e,weight:0,reps:10,holdTime:30,intensity:5,stretchType:"static"};case"sport":return{...e,weight:0,reps:1,duration:60,rpe:7,calories:300,performance:"7"};case"speed_agility":return{...e,weight:0,reps:10,duration:60,time:3,distance:50,height:30,restTime:120,intensity:7,rpe:6};case"other":default:return{...e,weight:0,reps:1,duration:30,rpe:5}}},ye=({exercise:t,onSave:e,onCancel:r,initialSets:n=[],isEditing:i=!1})=>{const a=Pi(t),[o,l]=S.useState([]),[c,p]=S.useState(!1);S.useEffect(()=>{n.length>0?l(n):l([$r(a)])},[n,a]);const m=()=>{const b=o[o.length-1],v=b?{...b}:$r(a);l(h=>[...h,v])},u=b=>{o.length>1&&l(v=>v.filter((h,w)=>w!==b))},d=(b,v,h)=>{l(w=>{const E=[...w];return E[b]={...E[b],[v]:h},E})},g=b=>{if(b>0){const v=o[b-1];l(h=>{const w=[...h];return w[b]={...v},w}),mt.success("Copied previous set values")}},f=()=>{const b=o.filter(v=>{switch(a){case"strength":case"bodyweight":return v.weight>0&&v.reps>0;case"endurance":case"sport":case"other":return v.duration&&v.duration>0||v.distance&&v.distance>0;case"flexibility":return v.reps&&v.reps>0||v.holdTime&&v.holdTime>0;case"speed_agility":return v.reps>0&&(v.duration&&v.duration>0||v.time&&v.time>0||v.distance&&v.distance>0||v.height&&v.height>0);default:return!0}});if(b.length===0){mt.error("Please fill in at least one complete set");return}e(b)},y=b=>{const v=o[b],h=[],w=(E,T,I="number",N,D,O)=>s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:T}),s.jsx("input",{type:I,value:v[E]||"",onChange:C=>{const M=C.target.value;if(I==="number")if(M===""||M==="-"||M===".")d(b,E,M);else{const k=Number(M);isNaN(k)||d(b,E,k)}else d(b,E,M)},className:"w-full px-3 py-2 bg-[#2a2a2a] border border-white/10 rounded-lg text-white focus:outline-none focus:border-purple-500",min:N,step:D,placeholder:O})]},E);switch(a){case"strength":case"bodyweight":h.push(s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w("reps","Reps *","number",1),w("weight","Weight (kg)","number",0,.5)]},"sets-reps")),h.push(w("rir","RIR (Reps in Reserve)","number",0,1)),h.push(w("restTime","Rest Time (seconds)","number",0));break;case"endurance":h.push(s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w("duration","Duration (minutes) *","number",.1,.1),w("distance","Distance (km)","number",0,.1)]},"duration-distance")),h.push(w("calories","Calories","number",0)),h.push(s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w("averageHeartRate","Average HR (bpm)","number",40,1),w("maxHeartRate","Max HR (bpm)","number",60,1)]},"hr-avg-max")),h.push(w("elevation","Elevation Gain (m)","number",0)),h.push(s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{type:"button",onClick:()=>{const E=document.getElementById(`hr-zones-${b}`);E&&(E.style.display=E.style.display==="none"?"block":"none")},className:"flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-gray-300 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",children:[s.jsx("span",{children:"Heart Rate Zones (minutes)"}),s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s.jsxs("div",{id:`hr-zones-${b}`,style:{display:"none"},className:"space-y-3 pl-3",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Zone 1: Recovery (50-60%) • Zone 2: Base (60-70%) • Zone 3: Tempo (70-80%) • Zone 4: Threshold (80-90%) • Zone 5: Max (90-100%)"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w("hrZone1","Zone 1 (min)","number",0,.1),w("hrZone2","Zone 2 (min)","number",0,.1)]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w("hrZone3","Zone 3 (min)","number",0,.1),w("hrZone4","Zone 4 (min)","number",0,.1)]}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:w("hrZone5","Zone 5 (min)","number",0,.1)})]}),"          "]},"hr-zones"));break;case"flexibility":h.push(w("reps","Repetitions","number",1)),h.push(w("holdTime","Hold Time (seconds)","number",1)),h.push(s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Intensity"}),s.jsxs("select",{value:v.intensity||"",onChange:E=>d(b,"intensity",parseInt(E.target.value)),className:"w-full px-3 py-2 bg-[#2a2a2a] border border-white/10 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[s.jsx("option",{value:"",children:"Select Intensity"}),s.jsx("option",{value:"1",children:"1 - Very Light"}),s.jsx("option",{value:"2",children:"2 - Light"}),s.jsx("option",{value:"3",children:"3 - Moderate-Light"}),s.jsx("option",{value:"4",children:"4 - Moderate"}),s.jsx("option",{value:"5",children:"5 - Moderate-Hard"}),s.jsx("option",{value:"6",children:"6 - Hard"}),s.jsx("option",{value:"7",children:"7 - Very Hard"}),s.jsx("option",{value:"8",children:"8 - Extremely Hard"}),s.jsx("option",{value:"9",children:"9 - Near Maximum"}),s.jsx("option",{value:"10",children:"10 - Maximum"})]})]},"intensity")),h.push(s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Stretch Type"}),s.jsxs("select",{value:v.stretchType||"static",onChange:E=>d(b,"stretchType",E.target.value),className:"w-full px-3 py-2 bg-[#2a2a2a] border border-white/10 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[s.jsx("option",{value:"static",children:"Static Stretching"}),s.jsx("option",{value:"dynamic",children:"Dynamic Stretching"}),s.jsx("option",{value:"pnf",children:"PNF (Proprioceptive Neuromuscular Facilitation)"}),s.jsx("option",{value:"yoga",children:"Yoga"}),s.jsx("option",{value:"mobility",children:"Mobility Flow"})]})]},"stretch-type"));break;case"sport":h.push(w("duration","Duration (minutes) *","number",1)),h.push(w("distance","Distance (km)","number",0,.1)),h.push(w("calories","Calories","number",0)),h.push(s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Performance Rating (1-10)"}),s.jsx("input",{type:"number",min:"1",max:"10",value:v.performance||"",onChange:E=>d(b,"performance",E.target.value),className:"w-full px-3 py-2 bg-[#2a2a2a] border border-white/10 rounded-lg text-white focus:outline-none focus:border-purple-500",placeholder:"Rate your performance"})]},"performance"));break;case"speed_agility":h.push(w("reps","Reps per Set","number",1)),h.push(s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w("distance","Distance (meters)","number",0,.1),w("height","Height (cm)","number",0,1)]},"distance-height")),h.push(w("restTime","Rest Between Sets (seconds)","number",0));break;case"other":default:h.push(w("duration","Duration (minutes) *","number",.1,.1)),h.push(w("distance","Distance (km)","number",0,.1)),h.push(w("calories","Calories","number",0));break}return["flexibility"].includes(a)||h.push(s.jsxs("div",{className:"space-y-1",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-300",children:["RPE (Rate of Perceived Exertion)",s.jsx("button",{type:"button",onClick:()=>p(!c),className:"ml-1 text-blue-400 hover:text-blue-300",children:"?"})]}),s.jsxs("select",{value:v.rpe||"",onChange:E=>d(b,"rpe",parseInt(E.target.value)),className:"w-full px-3 py-2 bg-[#2a2a2a] border border-white/10 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[s.jsx("option",{value:"",children:"Select RPE"}),Object.entries(qr).map(([E,{label:T}])=>s.jsxs("option",{value:E,children:[E," - ",T]},E))]})]},"rpe")),h.push(s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Notes"}),s.jsx("textarea",{value:v.notes||"",onChange:E=>d(b,"notes",E.target.value),className:"w-full px-3 py-2 bg-[#2a2a2a] border border-white/10 rounded-lg text-white focus:outline-none focus:border-purple-500",rows:2,placeholder:"Optional notes about this set..."})]},"notes")),h},x=()=>{switch(a){case"sport":case"flexibility":return"Set";default:return"Set"}};return s.jsxs("div",{className:"fixed inset-0 bg-black/95 flex flex-col z-50",children:[s.jsxs("div",{className:"p-4 border-b border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-xl font-bold text-white",children:[i?"Edit":"Log"," ",t.name]}),s.jsxs("div",{className:"text-sm text-gray-400",children:[o.length," ",x(),o.length!==1?"s":""]})]}),s.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:[a.charAt(0).toUpperCase()+a.slice(1)," Exercise"]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.map((b,v)=>s.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-white",children:[x()," ",v+1]}),s.jsxs("div",{className:"flex items-center gap-2",children:[v>0&&s.jsx("button",{onClick:()=>g(v),className:"px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:"Copy Previous"}),o.length>1&&s.jsx("button",{onClick:()=>u(v),className:"px-3 py-1 text-sm bg-red-600 hover:bg-red-700 text-white rounded transition-colors",children:"Remove"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y(v)})]},v)),s.jsxs("button",{onClick:m,className:"w-full py-4 rounded-lg bg-white/5 hover:bg-white/10 text-white font-medium transition-colors border-2 border-dashed border-white/20",children:["+ Add ",x()]})]}),c&&s.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-60",children:s.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-6 max-w-md w-full mx-4 border border-white/10",children:[s.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"RPE Scale Reference"}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:Object.entries(qr).map(([b,{label:v,description:h}])=>s.jsxs("div",{className:"flex justify-between items-center py-1",children:[s.jsxs("span",{className:"text-white font-medium",children:[b," - ",v]}),s.jsx("span",{className:"text-gray-400 text-sm",children:h})]},b))}),s.jsx("button",{onClick:()=>p(!1),className:"mt-4 w-full py-2 bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors",children:"Close"})]})}),s.jsx("div",{className:"p-4 border-t border-white/10",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:f,className:"flex-1 py-3 rounded-lg bg-purple-600 text-white font-medium hover:bg-purple-700 transition-colors",children:[i?"Update":"Save"," ",x(),o.length!==1?"s":""]}),s.jsx("button",{onClick:r,className:"flex-1 py-3 rounded-lg bg-white/5 text-white font-medium hover:bg-white/10 transition-colors",children:"Cancel"})]})})]})},pe=async(t,e,r)=>{try{if(console.log("📝 addExerciseLog called with:",{logData:t,selectedDate:e,existingId:r}),!t.userId)throw new Error("userId is required to save exercise log");const n={...t,timestamp:tr.fromDate(e||new Date),deviceId:window.navigator.userAgent,userId:t.userId,sets:Array.isArray(t.sets)?t.sets:[],...t.activityType&&{activityType:t.activityType}};console.log("📝 Prepared exercise data:",n);let i,a;if(r){i=Ze(ve,"users",t.userId,"exercises",r),a=r,console.log("📝 Updating existing document:",a);try{const o=Ze(ve,"exerciseLogs",r);(await rr(o)).exists()&&(await nr(o),console.log("✅ Cleaned up old location document:",r))}catch(o){console.warn("⚠️ Could not clean up old location:",o)}}else i=Ze(jt(ve,"users",t.userId,"exercises")),a=i.id,console.log("📝 Creating new document with ID:",a);return await wi(i,n),console.log("✅ Exercise saved successfully with ID:",a),a}catch(n){const i=n;throw console.error("❌ Error adding exercise log:",{error:n,code:i.code,message:i.message,userId:t.userId}),i.code==="permission-denied"?new Error("Permission denied. Please check your authentication."):new Error("Failed to add exercise log: "+(i.message||"Unknown error"))}},Ri=async(t,e)=>{var r,n;try{if(console.log("🗑️ deleteExerciseLog called with:",{logId:t,userId:e}),!e)throw new Error("userId is required to delete exercise log");if(!t)throw new Error("logId is required to delete exercise log");const i=Ze(ve,"users",e,"exercises",t),a=Ze(ve,"exerciseLogs",t);let o=null,l=null;try{o=await rr(i),console.log("📄 New path document check:",{exists:o.exists(),userId:o.exists()?(r=o.data())==null?void 0:r.userId:null})}catch(m){console.warn("⚠️ Error checking new path:",m)}try{l=await rr(a),console.log("📄 Old path document check:",{exists:l.exists(),userId:l.exists()?(n=l.data())==null?void 0:n.userId:null})}catch(m){console.warn("⚠️ Error checking old path:",m)}let c=!1,p=[];if(o!=null&&o.exists()){const m=o.data();if((m==null?void 0:m.userId)===e)try{await nr(i),console.log("✅ Exercise deleted from new location successfully"),c=!0}catch(u){console.error("❌ Failed to delete from new location:",u);const d=u instanceof Error?u.message:"Unknown error";p.push(`New location error: ${d}`)}else m!=null&&m.userId&&console.warn("⚠️ Document exists but belongs to different user:",{docUserId:m.userId,requestUserId:e})}if(!c&&(l!=null&&l.exists())){const m=l.data();if((m==null?void 0:m.userId)===e)try{await nr(a),console.log("✅ Exercise deleted from old location successfully"),c=!0}catch(u){console.error("❌ Failed to delete from old location:",u);const d=u instanceof Error?u.message:"Unknown error";p.push(`Old location error: ${d}`)}else m!=null&&m.userId&&console.warn("⚠️ Document exists but belongs to different user:",{docUserId:m.userId,requestUserId:e})}if(!c){const m=!o&&!l?"Could not access exercise document. Please check your permissions.":p.length>0?`Failed to delete exercise: ${p.join("; ")}`:"Exercise log not found or you do not have permission to delete it";throw new Error(m)}}catch(i){throw console.error("❌ Error deleting exercise log:",i),i instanceof Error?i:new Error("Failed to delete exercise log")}},Vr=async(t,e,r)=>{try{if(console.log("📖 getExerciseLogs called with:",{userId:t,startDate:e,endDate:r}),!t)throw new Error("userId is required to fetch exercise logs");const n=jt(ve,"users",t,"exercises"),i=dr(n,gt("timestamp",">=",tr.fromDate(e)),gt("timestamp","<=",tr.fromDate(r)),Bn("timestamp","desc")),o=(await pr(i)).docs.map(l=>{const c=l.data();return{id:l.id,exerciseName:c.exerciseName,sets:c.sets,timestamp:c.timestamp.toDate(),deviceId:c.deviceId||"legacy",userId:c.userId,activityType:c.activityType}});return console.log("📖 Retrieved exercises:",o.length),o}catch(n){throw console.error("❌ Error fetching exercise logs:",n),new Error("Failed to fetch exercises")}},Ai=({onClose:t,onBack:e,onActivityLogged:r,selectedDate:n=new Date,editingExercise:i=null})=>{const[a,o]=S.useState([]),[l,c]=S.useState(null),[p,m]=S.useState("list"),u=Ie(g=>g.auth.user);S.useEffect(()=>{const g=Ln(j.SPORT);if(o(g.map((f,y)=>{const x=f.metrics||{};return{id:f.id||`sport-${y}`,name:f.name,description:f.description,activityType:j.SPORT,category:f.category||"general",isDefault:f.isDefault??!0,sportType:f.sportType||"general",skillLevel:"intermediate",teamBased:!!f.teamBased,equipment:f.equipment||[],primarySkills:f.skills||[],metrics:{trackDuration:!!x.trackDuration||!!x.trackTime,trackScore:!!x.trackScore,trackIntensity:!!x.trackIntensity||!!x.trackRPE,trackPerformance:!!x.trackPerformance}}})),i){const f={id:i.id||"editing-sport",name:i.exerciseName,category:"general",description:"",isDefault:!1,activityType:j.SPORT,sportType:"general",skillLevel:"intermediate",teamBased:!1,equipment:[],primarySkills:[],metrics:{trackDuration:!0,trackScore:!1,trackIntensity:!0,trackPerformance:!1}};c(f),m("logging")}},[i]);function d(g){c(g),m("logging")}if(p==="logging"&&l){const g={id:l.id,name:l.name,description:l.description||"",activityType:j.SPORT,type:"teamSports",category:l.category||"sport",equipment:l.equipment||[],instructions:[l.description||""],difficulty:"beginner",defaultUnit:"time",metrics:{trackTime:!0,trackDuration:!0,trackRPE:!0}};return s.jsx(ye,{exercise:g,onCancel:()=>m("list"),onSave:async f=>{try{if(console.log("💾 SportActivityPicker: Starting to save exercise sets:",{exercise:g,sets:f,user:u==null?void 0:u.id,selectedDate:n}),!(u!=null&&u.id))throw new Error("User not authenticated");const y={exerciseName:l.name,userId:u.id,sets:f,activityType:j.SPORT};console.log("💾 SportActivityPicker: Calling addExerciseLog with:",y);const x=await pe(y,n||new Date);console.log("✅ SportActivityPicker: Exercise saved successfully with ID:",x),r(),m("list")}catch(y){console.error("❌ SportActivityPicker: Error saving exercise:",y)}},initialSets:(i==null?void 0:i.sets)||[],isEditing:!!i})}return s.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"absolute top-4 left-4",children:s.jsx("button",{onClick:e,className:"px-3 py-1 rounded-md bg-gray-800 text-gray-300 hover:text-white hover:bg-gray-700 text-sm",children:"← Back"})}),s.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:"✕"}),s.jsx(Et,{data:a,enrich:di,collectFacets:ui,applyFilters:ci,onSelect:d,title:"Sports Activities",subtitle:"Browse and filter sports and skill drills"})]})})},Oi=({onClose:t,onBack:e,onActivityLogged:r,selectedDate:n=new Date,editingExercise:i=null})=>{const[a,o]=S.useState(null),[l,c]=S.useState("list"),[p,m]=S.useState(""),[u,d]=S.useState(new Set),[g,f]=S.useState(new Set),[y,x]=S.useState(new Set),[b,v]=S.useState(new Set),[h,w]=S.useState(!1),E=S.useMemo(()=>Ni(Si),[]),T=S.useMemo(()=>Ci(E),[E]),I=S.useMemo(()=>Di(E,{search:p,type:u,lateralization:g,equipment:y,includeTags:b}),[p,u,g,y,b,E]),N=Ie(C=>C.auth.user);function D(C,M){C(k=>{const W=new Set(k);return W.has(M)?W.delete(M):W.add(M),W})}S.useEffect(()=>{if(i){const C={id:i.id||"editing-speedAgility",name:i.exerciseName,category:"general",description:"",isDefault:!1,activityType:j.SPEED_AGILITY,drillType:"agility",equipment:[],difficulty:"beginner",setup:[],instructions:[],metrics:{trackTime:!1,trackDistance:!0,trackReps:!0,trackRPE:!0,trackHeight:!0}};o(C),c("logging")}},[i]);function O(C){const M={id:C.id,name:C.name,category:C.category||"general",description:C.description||"",isDefault:!0,activityType:j.SPEED_AGILITY,drillType:C.drillType||C.type||"agility",equipment:Array.isArray(C.equipment)?C.equipment:C.equipment?[C.equipment]:[],difficulty:C.difficulty||"beginner",setup:Array.isArray(C.setup)?C.setup:[],instructions:Array.isArray(C.instructions)?C.instructions:C.instructions?[C.instructions]:[],metrics:{trackTime:!1,trackDistance:!0,trackReps:!0,trackRPE:!0,trackHeight:!0}};o(M),c("logging")}if(l==="logging"&&a){const C={id:a.id,name:a.name,description:a.description||"",activityType:j.SPEED_AGILITY,type:"speedAgility",category:a.category,equipment:a.equipment,instructions:Array.isArray(a.instructions)?a.instructions:[a.instructions||""],difficulty:a.difficulty,defaultUnit:"time",metrics:{trackTime:!1,trackReps:!0,trackSets:!0,trackDistance:!0,trackRPE:!0,trackHeight:!0}};return s.jsx(ye,{exercise:C,onCancel:()=>c("list"),onSave:async M=>{try{if(console.log("💾 SpeedAgilityActivityPicker: Starting to save exercise sets:",{exercise:C,sets:M,user:N==null?void 0:N.id,selectedDate:n}),!(N!=null&&N.id))throw new Error("User not authenticated");const k={exerciseName:a.name,userId:N.id,sets:M,activityType:j.SPEED_AGILITY};console.log("💾 SpeedAgilityActivityPicker: Calling addExerciseLog with:",k);const W=await pe(k,n||new Date);console.log("✅ SpeedAgilityActivityPicker: Exercise saved successfully with ID:",W),r(),c("list")}catch(k){console.error("❌ SpeedAgilityActivityPicker: Error saving exercise:",k)}},initialSets:(i==null?void 0:i.sets)||[],isEditing:!!i})}return s.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Speed, Agility & Plyometrics"})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"p-4 border-b border-gray-700 space-y-3 bg-[#1a1a1a]/95 backdrop-blur sticky top-0 z-10",children:[s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"text",placeholder:"Search drills (name or instructions)",value:p,onChange:C=>m(C.target.value),className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:border-yellow-500","aria-label":"Search speed agility plyometric drills"}),s.jsx("button",{onClick:()=>{m(""),d(new Set),f(new Set),x(new Set),v(new Set)},className:"px-3 py-2 text-xs font-medium bg-gray-800 border border-gray-600 rounded-md text-gray-300 hover:text-white hover:border-yellow-500","aria-label":"Reset filters",children:"Reset"}),s.jsx("button",{onClick:()=>w(C=>!C),className:"px-3 py-2 text-xs font-medium bg-gray-800 border border-gray-600 rounded-md text-gray-300 hover:text-white hover:border-yellow-500","aria-expanded":h,"aria-controls":"advanced-filters",children:h?"Hide":"Filters"})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[["sprint","agility","plyometric","jump","reaction","acceleration","ladder","hurdle"].map(C=>{const M=u.has(C)||b.has(C),k=()=>{["sprint","agility","plyometric"].includes(C)?D(d,C):D(v,C)};return s.jsx("button",{onClick:k,className:`px-3 py-1 rounded-full text-xs font-medium border transition ${M?"bg-yellow-500 border-yellow-400 text-black":"bg-gray-800 border-gray-600 text-gray-300 hover:border-yellow-500 hover:text-white"}`,children:C},C)}),["unilateral","bilateral"].map(C=>{const M=g.has(C);return s.jsx("button",{onClick:()=>D(f,C),className:`px-3 py-1 rounded-full text-xs font-medium border transition ${M?"bg-blue-500 border-blue-400 text-white":"bg-gray-800 border-gray-600 text-gray-300 hover:border-blue-400 hover:text-white"}`,children:C},C)})]}),h&&s.jsx("div",{id:"advanced-filters",className:"space-y-3",children:s.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4 text-[11px]",children:[s.jsx(st,{title:"Type",values:Array.from(T.type),selected:u,onToggle:C=>D(d,C)}),s.jsx(st,{title:"Lateral",values:Array.from(T.lateralization),selected:g,onToggle:C=>D(f,C)}),s.jsx(st,{title:"Equipment",values:Array.from(T.equipment),selected:y,onToggle:C=>D(x,C)}),s.jsx(st,{title:"Tags",values:Array.from(T.tags).filter(C=>["jump","sprint","skip","bound","shuffle","resisted","assisted","reaction","explosive","ladder","hurdle","acceleration","depth","pogo","tuck"].includes(C)),selected:b,onToggle:C=>D(v,C)})]})}),s.jsxs("p",{className:"text-[11px] text-gray-400",children:["Showing ",s.jsx("span",{className:"text-yellow-400 font-semibold",children:I.length})," of ",E.length," drills"]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:I.map(C=>s.jsxs("div",{onClick:()=>O(C),className:"bg-gray-800 rounded-lg p-4 cursor-pointer hover:bg-gray-700 transition-colors border border-gray-600",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:C.name}),C.description&&s.jsx("p",{className:"text-gray-400 text-xs mb-2 line-clamp-3",children:C.description}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[C.category&&s.jsx("span",{className:"px-2 py-0.5 bg-yellow-600 text-white text-[10px] rounded",children:C.category}),C.drillType&&s.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-[10px] rounded",children:C.drillType}),C.difficulty&&s.jsx("span",{className:"px-2 py-0.5 bg-orange-600 text-white text-[10px] rounded",children:C.difficulty}),Array.from(C.tags||[]).slice(0,3).map(M=>s.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-200 text-[10px] rounded",children:M},M))]})]},C.id))}),I.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-gray-400 text-lg",children:"No drills found"}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Try adjusting your search or filter"})]})]})]})})},st=({title:t,values:e,selected:r,onToggle:n})=>e.length?s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] uppercase tracking-wide text-gray-400 mb-1 font-semibold",children:t}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.sort().map(i=>{const a=r.has(i);return s.jsx("button",{onClick:()=>n(i),className:`px-2 py-0.5 rounded border text-[10px] ${a?"bg-yellow-600 border-yellow-500 text-white":"bg-gray-800 border-gray-600 text-gray-300 hover:border-yellow-500 hover:text-white"}`,children:i},i)})})]}):null;function Mi(t){return t.map(e=>{const r=e.targetMuscles||e.primaryMuscles||[],n=e.bodyRegion||e.secondaryMuscles||[],i=e.equipment||[],a=e.category,o=[...Array.isArray(r)?r:[],...Array.isArray(n)?n:[],...Array.isArray(i)?i:[],a,"flexibility"].filter(Boolean);return{...e,tags:o,_targets:r,_regions:n}})}function Li(t){const e={type:new Set,equipment:new Set,tags:new Set};return t.forEach(r=>{var n;e.type.add("stretching"),(n=r.equipment)==null||n.forEach(i=>e.equipment.add(i)),(r.tags||[]).forEach(i=>e.tags.add(i))}),e}function Bi(t,e){return t.filter(r=>{var n;if(e.search){const i=e.search.toLowerCase();if(![r.name,r.description,(n=r.instructions)==null?void 0:n.join(" ")].filter(Boolean).join(" ").toLowerCase().includes(i))return!1}if(e.equipment&&e.equipment.size){const i=r.equipment||[];if(!Array.from(e.equipment).every(o=>i.includes(o)))return!1}return!(e.includeTags&&e.includeTags.size&&!(r.tags||[]).some(i=>e.includeTags.has(i)))})}const Fi=({onClose:t,onBack:e,onActivityLogged:r,selectedDate:n=new Date,editingExercise:i=null})=>{const[a,o]=S.useState(null),[l,c]=S.useState("list"),p=Ie(u=>u.auth.user);function m(u){o(u),c("logging")}if(l==="logging"&&a){const u={id:a.id,name:a.name,description:a.description||"",activityType:j.STRETCHING,type:"flexibility",category:a.category||"flexibility",equipment:["bodyweight"],instructions:[a.description||""],difficulty:"beginner",defaultUnit:"time",metrics:{trackReps:!0,trackIntensity:!0}};return s.jsx(ye,{exercise:u,onCancel:()=>c("list"),onSave:async d=>{try{if(console.log("💾 StretchingActivityPicker: Starting to save exercise sets:",{exercise:u,sets:d,user:p==null?void 0:p.id,selectedDate:n}),!(p!=null&&p.id))throw new Error("User not authenticated");const g={exerciseName:a.name,userId:p.id,sets:d,activityType:j.STRETCHING};console.log("💾 StretchingActivityPicker: Calling addExerciseLog with:",g);const f=await pe(g,n||new Date);console.log("✅ StretchingActivityPicker: Exercise saved successfully with ID:",f),r(),c("list")}catch(g){console.error("❌ StretchingActivityPicker: Error saving exercise:",g)}},initialSets:(i==null?void 0:i.sets)||[],isEditing:!!i})}return s.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"absolute top-4 left-4",children:s.jsx("button",{onClick:e,className:"px-3 py-1 rounded-md bg-gray-800 text-gray-300 hover:text-white hover:bg-gray-700 text-sm",children:"← Back"})}),s.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:"✕"}),s.jsx(Et,{data:pi,enrich:Mi,collectFacets:Li,applyFilters:Bi,onSelect:m,title:"Stretching & Flexibility",subtitle:"Browse and filter mobility and flexibility exercises"})]})})};function Wi(t){return t.map(e=>({...e,tags:[e.enduranceType||"",...e.equipment||[],e.category,"endurance"].filter(Boolean)}))}function Hi(t){const e={type:new Set,equipment:new Set,category:new Set,tags:new Set};return t.forEach(r=>{e.type.add("endurance"),(r.equipment||[]).forEach(n=>e.equipment.add(n)),e.category.add(r.category),(r.tags||[]).forEach(n=>e.tags.add(n))}),e}function Ui(t,e){return t.filter(r=>{if(e.search){const n=e.search.toLowerCase();if(!(r.name.toLowerCase().includes(n)||(r.environment||"").toLowerCase().includes(n)))return!1}return!(e.equipment&&e.equipment.size&&!(r.equipment||[]).some(n=>e.equipment.has(n))||e.includeTags&&e.includeTags.size&&!(r.tags||[]).some(n=>e.includeTags.has(n)))})}const Gi=({onClose:t,onBack:e,onActivityLogged:r,selectedDate:n=new Date,editingExercise:i=null})=>{const[a,o]=S.useState(null),[l,c]=S.useState("list"),p=Ie(u=>u.auth.user);function m(u){o(u),c("logging")}if(l==="logging"&&a){const u={id:a.id,name:a.name,description:a.description||"",activityType:j.ENDURANCE,type:"endurance",category:a.category||"cardio",equipment:Array.isArray(a.equipment)?a.equipment:[a.equipment||"bodyweight"],instructions:[a.description||""],difficulty:"beginner",defaultUnit:"time",metrics:{trackTime:!0,trackDistance:!0,trackRPE:!0,trackDuration:!0}};return s.jsx(ye,{exercise:u,onCancel:()=>c("list"),onSave:async d=>{try{if(console.log("💾 EnduranceActivityPicker: Starting to save exercise sets:",{exercise:u,sets:d,user:p==null?void 0:p.id,selectedDate:n}),!(p!=null&&p.id))throw new Error("User not authenticated");const g={exerciseName:a.name,userId:p.id,sets:d,activityType:j.ENDURANCE};console.log("💾 EnduranceActivityPicker: Calling addExerciseLog with:",g);const f=await pe(g,n||new Date);console.log("✅ EnduranceActivityPicker: Exercise saved successfully with ID:",f),r(),c("list")}catch(g){console.error("❌ EnduranceActivityPicker: Error saving exercise:",g)}},initialSets:(i==null?void 0:i.sets)||[],isEditing:!!i})}return s.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"absolute top-4 left-4",children:s.jsx("button",{onClick:e,className:"px-3 py-1 rounded-md bg-gray-800 text-gray-300 hover:text-white hover:bg-gray-700 text-sm",children:"← Back"})}),s.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:"✕"}),s.jsx(Et,{data:mi,enrich:Wi,collectFacets:Hi,applyFilters:Ui,onSelect:m,title:"Endurance Training",subtitle:"Browse and filter endurance exercises"})]})})};function qi(t){return t.map(e=>({...e,tags:[e.customCategory,...Object.keys(e.customFields||{}),e.category,"other"].filter(Boolean)}))}function $i(t){const e={type:new Set,categories:new Set,tags:new Set};return t.forEach(r=>{e.type.add("other"),e.categories.add(r.customCategory||r.category),(r.tags||[]).forEach(n=>e.tags.add(n))}),e}function Vi(t,e){return t.filter(r=>{if(e.search){const n=e.search.toLowerCase();if(!(r.name.toLowerCase().includes(n)||(r.instructions||[]).join(" ").toLowerCase().includes(n)))return!1}return!(e.includeTags&&e.includeTags.size&&!(r.tags||[]).some(n=>e.includeTags.has(n)))})}const Yi=({onClose:t,onBack:e,onActivityLogged:r,selectedDate:n=new Date})=>{const[i,a]=S.useState([]),[o,l]=S.useState(null),[c,p]=S.useState("list"),m=Ie(d=>d.auth.user);S.useEffect(()=>{const d=Ln(j.OTHER);a(d.map((g,f)=>({id:g.id||`other-${f}`,name:g.name,description:g.description,activityType:j.OTHER,category:g.category||"general",isDefault:g.isDefault??!0,customCategory:g.category||"general",customFields:[],metrics:Object.keys(g.metrics||{}).reduce((y,x)=>(y[x]=!0,y),{})})))},[]);function u(d){l(d),p("logging")}if(c==="logging"&&o){const d={id:o.id,name:o.name,description:o.description||"",activityType:j.OTHER,type:"other",category:o.category||"general",equipment:["bodyweight"],instructions:[o.description||""],difficulty:"beginner",defaultUnit:"time",metrics:{trackTime:!0,trackDuration:!0,trackRPE:!0}};return s.jsx(ye,{exercise:d,onCancel:()=>p("list"),onSave:async g=>{try{if(console.log("💾 OtherActivityPicker: Starting to save exercise sets:",{exercise:d,sets:g,user:m==null?void 0:m.id,selectedDate:n}),!(m!=null&&m.id))throw new Error("User not authenticated");const f={exerciseName:o.name,userId:m.id,sets:g,activityType:j.OTHER};console.log("💾 OtherActivityPicker: Calling addExerciseLog with:",f);const y=await pe(f,n||new Date);console.log("✅ OtherActivityPicker: Exercise saved successfully with ID:",y),r(),p("list")}catch(f){console.error("❌ OtherActivityPicker: Error saving exercise:",f)}}})}return s.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"absolute top-4 left-4",children:s.jsx("button",{onClick:e,className:"px-3 py-1 rounded-md bg-gray-800 text-gray-300 hover:text-white hover:bg-gray-700 text-sm",children:"← Back"})}),s.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:"✕"}),s.jsx(Et,{data:i,enrich:qi,collectFacets:$i,applyFilters:Vi,onSelect:u,title:"Other Activities",subtitle:"Browse and filter miscellaneous activities"})]})})},zi=[{id:"programs",name:"Add from Program",icon:"📋",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-purple-600",textColor:"text-white"},{id:"copyPrevious",name:"Copy from Previous",icon:"📝",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-blue-600",textColor:"text-white"}],Zi=[{id:"chest",name:"Chest",icon:"💪",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-green-600",textColor:"text-white"},{id:"back",name:"Back",icon:"🔙",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-blue-600",textColor:"text-white"},{id:"legs",name:"Legs",icon:"🦵",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-yellow-600",textColor:"text-white"},{id:"shoulders",name:"Shoulders",icon:"🎯",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-cyan-600",textColor:"text-white"},{id:"arms",name:"Arms",icon:"💪",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-red-600",textColor:"text-white"},{id:"core",name:"Core",icon:"⭕",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-primary-600",textColor:"text-white"},{id:"fullBody",name:"Full-Body",icon:"👤",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-orange-600",textColor:"text-white"}],Yr=[{id:"resistance",name:"Resistance Training",description:"Weight lifting, strength training",icon:"🏋️‍♂️",bgColor:"bg-gradient-to-r from-blue-500 to-blue-700",textColor:"text-white",examples:"Squats, Deadlifts, Bench Press"},{id:"sport",name:"Sports",description:"Team sports, individual competitions",icon:"⚽",bgColor:"bg-gradient-to-r from-green-500 to-green-700",textColor:"text-white",examples:"Football, Basketball, Tennis"},{id:"stretching",name:"Stretching & Flexibility",description:"Static stretches, yoga, mobility",icon:"🧘‍♀️",bgColor:"bg-gradient-to-r from-purple-500 to-purple-700",textColor:"text-white",examples:"Yoga, Static Stretches, PNF"},{id:"endurance",name:"Endurance Training",description:"Cardio, running, cycling",icon:"🏃‍♂️",bgColor:"bg-gradient-to-r from-red-500 to-red-700",textColor:"text-white",examples:"Running, Cycling, Swimming"},{id:"speedAgility",name:"Speed, Agility & Plyometrics",description:"Sprints, jumps, plyometrics, change of direction",icon:"⚡",bgColor:"bg-gradient-to-r from-yellow-500 to-amber-600",textColor:"text-white",examples:"Plyometrics, Ladder, Sprints, Jumps"},{id:"other",name:"Other Activities",description:"Custom activities and tracking",icon:"🎯",bgColor:"bg-gradient-to-r from-gray-500 to-gray-700",textColor:"text-white",examples:"Meditation, Therapy, Custom"}],Ji=({onClose:t,onExerciseAdded:e,selectedDate:r,editingExercise:n})=>{const[i,a]=S.useState("main"),[o,l]=S.useState(null),[c,p]=S.useState(null),[m,u]=S.useState(""),[d,g]=S.useState(!1),[f,y]=S.useState(j.RESISTANCE),x=Ie(h=>h.auth.user);S.useEffect(()=>{n&&a("editExercise")},[n]);const b=async h=>{if(x!=null&&x.id)try{for(const{exercise:w,sets:E}of h)await pe({exerciseName:w.name,userId:x.id,sets:E},r||new Date);a("main"),e==null||e()}catch(w){console.error("Error saving program exercises:",w)}},v=async h=>{if(x!=null&&x.id)try{for(const w of h)w.name&&await pe({exerciseName:w.name,userId:x.id,sets:w.sets||[]},r||new Date);a("main"),e==null||e()}catch(w){console.error("Error saving copied exercises:",w)}};if(i==="universalSearch"){const h=gi(m);return s.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex flex-col z-50",children:[s.jsxs("header",{className:"sticky top-0 flex items-center justify-between p-4 bg-[#1a1a1a] border-b border-white/10",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>a("main"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 hover:text-white","aria-label":"Back",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("h2",{className:"text-xl font-bold text-white",children:"🔍 Universal Search"})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 hover:text-white","aria-label":"Close",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("main",{className:"flex-1 overflow-y-auto overscroll-contain pb-safe min-h-0",children:s.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[s.jsx("section",{className:"space-y-3",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search all exercise databases...",value:m,onChange:w=>u(w.target.value),className:"w-full px-4 py-3 pl-10 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0}),s.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),m&&m.length>=2&&s.jsxs("section",{className:"space-y-2",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white/90",children:["Search Results (",h.length,")"]}),s.jsx("div",{className:"space-y-2",children:h.length>0?h.slice(0,20).map(w=>s.jsx("button",{onClick:()=>{p(w),a("setEditor")},className:"w-full text-left p-4 bg-[#1a1a1a] rounded-xl hover:bg-[#222] transition-colors border border-white/10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-white font-medium",children:w.name}),s.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:[w.activityType&&`${w.activityType} • `,(w.primaryMuscles||[]).join(", ")||"No muscles specified"]}),w.description&&s.jsx("p",{className:"text-gray-500 text-xs mt-1 line-clamp-2",children:w.description})]}),s.jsx("div",{className:"text-white/40",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},w.id)):m.length>1?s.jsxs("div",{className:"text-center py-8",children:[s.jsxs("p",{className:"text-white/60",children:['No exercises found for "',m,'"']}),s.jsx("p",{className:"text-white/40 text-sm mt-2",children:"Try a different search term or create a new exercise"}),s.jsxs("button",{onClick:()=>{y(j.RESISTANCE),g(!0)},className:"mt-4 flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-purple-600 text-white font-medium hover:bg-purple-700 transition-colors mx-auto",children:[s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 00-1 1v5H4a1 1 0 100 2h5v5a1 1 0 102 0v-5h5a1 1 0 100-2h-5V4a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Create New Exercise"]})]}):s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-white/60",children:"Type at least 2 characters to search"})})})]})]})})]})}if(i==="recentExercises")return s.jsx(fi,{onClose:()=>a("resistance"),onSelectExercises:b});if(i==="sport")return s.jsx(Ai,{onClose:t,onBack:()=>a("main"),onActivityLogged:()=>{e==null||e(),a("main")},selectedDate:r,editingExercise:n});if(i==="stretching")return s.jsx(Fi,{onClose:t,onBack:()=>a("main"),onActivityLogged:()=>{e==null||e(),a("main")},selectedDate:r,editingExercise:n});if(i==="endurance")return s.jsx(Gi,{onClose:t,onBack:()=>a("main"),onActivityLogged:()=>{e==null||e(),a("main")},selectedDate:r,editingExercise:n});if(i==="other")return s.jsx(Yi,{onClose:t,onBack:()=>a("main"),onActivityLogged:()=>{e==null||e(),a("main")},selectedDate:r});if(i==="speedAgility")return s.jsx(Oi,{onClose:t,onBack:()=>a("main"),onActivityLogged:()=>{e==null||e(),a("main")},selectedDate:r,editingExercise:n});if(i==="programPicker")return s.jsx(vi,{onClose:()=>a("main"),onSelectExercises:b});if(i==="copyPrevious")return s.jsx(hi,{isOpen:!0,onClose:()=>a("main"),onExercisesSelected:v,currentDate:r||new Date,userId:(x==null?void 0:x.id)||""});if(i==="search")return s.jsx(xi,{onClose:()=>a("resistance"),category:o,onSelectExercise:h=>{p({...h,id:`temp-${h.name.toLowerCase().replace(/\s+/g,"-")}`,description:h.description||"",primaryMuscles:[],secondaryMuscles:[],instructions:[],metrics:{trackWeight:!0,trackReps:!0},defaultUnit:"kg"}),a("setEditor")}});if(i==="resistance")return s.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex flex-col z-50",children:[s.jsxs("header",{className:"sticky top-0 flex items-center justify-between p-4 bg-[#1a1a1a] border-b border-white/10",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>a("main"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 hover:text-white","aria-label":"Back",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("h2",{className:"text-xl font-bold text-white",children:"🏋️‍♂️ Resistance Training"})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 hover:text-white","aria-label":"Close",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("main",{className:"flex-1 overflow-y-auto overscroll-contain pb-safe min-h-0",children:s.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6 md:space-y-8",children:[s.jsx("section",{className:"space-y-3",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search exercises...",className:"w-full px-4 py-3 pl-10 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onFocus:()=>{l(null),a("search")}}),s.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),s.jsxs("section",{className:"space-y-3 md:space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white/90",children:"Quick Options"}),s.jsx("div",{className:"grid grid-cols-1 gap-3 md:gap-4",children:s.jsx(Ht,{category:{id:"recent",name:"Recent Exercises",icon:"🕒",bgColor:"bg-gymkeeper-light",iconBgColor:"bg-blue-600",textColor:"text-white"},onClick:()=>a("recentExercises")})})]}),s.jsxs("section",{className:"space-y-3 md:space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white/90",children:"Muscle Groups"}),s.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:gap-4",children:Zi.map(h=>s.jsx(Ht,{category:h,onClick:()=>{l(h),a("search")}},h.id))})]})]})})]});if(i==="setEditor"&&c)return s.jsx(ye,{exercise:c,onCancel:()=>{p(null),a("main")},onSave:async h=>{try{if(console.log("💾 LogOptions: Starting to save exercise sets:",{exercise:c,sets:h,user:x==null?void 0:x.id,selectedDate:r}),!(x!=null&&x.id))throw new Error("User not authenticated");const w={exerciseName:c.name,userId:x.id,sets:h};console.log("💾 LogOptions: Calling addExerciseLog with:",w);const E=await pe(w,r||new Date);console.log("✅ LogOptions: Exercise saved successfully with ID:",E),e==null||e(),p(null),a("main")}catch(w){console.error("❌ LogOptions: Error saving exercise:",w)}},initialSets:n==null?void 0:n.sets,isEditing:!!n});if(i==="editExercise"&&n){const h={id:n.id||`edit-${Date.now()}`,name:n.exerciseName,description:n.exerciseName,activityType:n.activityType,type:n.activityType===j.RESISTANCE?"strength":n.activityType===j.ENDURANCE?"endurance":n.activityType===j.STRETCHING?"flexibility":n.activityType===j.SPORT?"teamSports":n.activityType===j.SPEED_AGILITY?"speed_agility":"other",category:"general",equipment:[],instructions:[],difficulty:"intermediate",primaryMuscles:[],secondaryMuscles:[],targetAreas:[],metrics:{trackWeight:n.activityType===j.RESISTANCE,trackReps:!0,trackTime:n.activityType!==j.RESISTANCE,trackDistance:n.activityType===j.ENDURANCE,trackRPE:!0},defaultUnit:n.activityType===j.RESISTANCE?"kg":"time"};return s.jsx(ye,{exercise:h,onCancel:()=>{a("main")},onSave:async w=>{try{if(console.log("💾 LogOptions: Updating exercise:",{exercise:n,sets:w,user:x==null?void 0:x.id,selectedDate:r}),!(x!=null&&x.id))throw new Error("User not authenticated");const E={exerciseName:n.exerciseName,userId:x.id,sets:w,activityType:n.activityType};console.log("💾 LogOptions: Calling addExerciseLog with existing ID:",n.id);const T=await pe(E,n.timestamp||new Date,n.id);console.log("✅ LogOptions: Exercise updated successfully with ID:",T),e==null||e(),a("main")}catch(E){console.error("❌ LogOptions: Error updating exercise:",E)}},initialSets:n.sets,isEditing:!0})}return s.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex flex-col z-50",children:[s.jsxs("header",{className:"sticky top-0 flex items-center justify-between p-4 bg-[#1a1a1a] border-b border-white/10",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:n?"Edit Exercise":"Add Exercise"}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-gray-400 hover:text-white","aria-label":"Close",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("main",{className:"flex-1 overflow-y-auto overscroll-contain pb-safe min-h-0",children:s.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6 md:space-y-8",children:[s.jsx("section",{className:"space-y-3",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Search all exercises...",className:"w-full px-4 py-3 pl-10 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onFocus:()=>a("universalSearch")}),s.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),s.jsxs("section",{className:"space-y-3 md:space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white/90",children:"Quick Add"}),s.jsx("div",{className:"grid grid-cols-2 gap-3 md:gap-4",children:zi.map(h=>s.jsx(Ht,{category:h,onClick:()=>{h.id==="programs"?a("programPicker"):h.id==="copyPrevious"&&a("copyPrevious")}},h.id))})]}),s.jsxs("section",{className:"space-y-3 md:space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white/90",children:"Choose Activity Type"}),s.jsx("div",{className:"grid grid-cols-1 gap-3 md:gap-4",children:Yr.map(h=>s.jsx("div",{onClick:()=>{h.id==="resistance"?a("resistance"):h.id==="sport"?a("sport"):h.id==="stretching"?a("stretching"):h.id==="endurance"?a("endurance"):h.id==="other"?a("other"):h.id==="speedAgility"&&a("speedAgility")},className:`
                    ${h.bgColor}
                    rounded-xl p-4 cursor-pointer
                    transition-all duration-200 ease-in-out
                    hover:scale-105 hover:shadow-lg
                    active:scale-95
                    border border-white/10
                  `,children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"text-3xl",children:h.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:`font-semibold text-lg ${h.textColor}`,children:h.name}),s.jsx("p",{className:`text-sm opacity-90 ${h.textColor}`,children:h.description}),s.jsx("p",{className:`text-xs opacity-75 mt-1 ${h.textColor}`,children:h.examples})]}),s.jsx("div",{className:"text-white/60",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},h.id))})]}),s.jsxs("section",{className:"space-y-3 md:space-y-4 border-t border-white/10 pt-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white/90",children:"Create Custom Exercise"}),s.jsx("div",{className:"grid grid-cols-2 gap-3 md:gap-4",children:Yr.map(h=>s.jsxs("button",{onClick:()=>{let w=j.RESISTANCE;switch(h.id){case"resistance":w=j.RESISTANCE;break;case"sport":w=j.SPORT;break;case"stretching":w=j.STRETCHING;break;case"endurance":w=j.ENDURANCE;break;case"speedAgility":w=j.SPEED_AGILITY;break;case"other":w=j.OTHER;break}y(w),g(!0)},className:"flex items-center p-3 bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition-colors text-left",children:[s.jsx("div",{className:"text-lg mr-3",children:h.icon}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-white text-sm font-medium truncate",children:["Create ",h.name]}),s.jsx("p",{className:"text-gray-400 text-xs truncate",children:"Custom exercise"})]}),s.jsx("div",{className:"text-white/40",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]},`create-${h.id}`))})]})]})}),d&&s.jsx(bi,{onClose:()=>g(!1),onSuccess:h=>{g(!1)},activityType:f,searchQuery:m})]})},Ge=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},Xi=({onClose:t,onDateSelect:e,selectedDate:r})=>{const[n,i]=S.useState(()=>Ge(r)),[a,o]=S.useState(!1),l=S.useCallback(async h=>{if(!h)return;const w=Ge(h);e&&(o(!0),e(w),setTimeout(()=>o(!1),300))},[e]);S.useEffect(()=>{i(Ge(r))},[r]);const c=new Date(n.getFullYear(),n.getMonth(),1),m=new Date(n.getFullYear(),n.getMonth()+1,0).getDate(),u=c.getDay(),d=()=>{i(new Date(n.getFullYear(),n.getMonth()-1))},g=()=>{i(new Date(n.getFullYear(),n.getMonth()+1))},f=()=>{i(new Date(n.getFullYear()-1,n.getMonth()))},y=()=>{i(new Date(n.getFullYear()+1,n.getMonth()))},x=Array.from({length:42},(h,w)=>{const E=w-u+1;return E<=0||E>m?null:new Date(n.getFullYear(),n.getMonth(),E)}),b=["January","February","March","April","May","June","July","August","September","October","November","December"],v=(h,w)=>Ge(h).getTime()===Ge(w).getTime();return s.jsxs("div",{className:"bg-[#1a1a1a] w-full h-screen p-4",children:[s.jsx("div",{className:"flex justify-between items-center mb-6",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-xl text-white",children:"Select Date"})]})}),s.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:f,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":`Go to year ${n.getFullYear()-1}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M4 12h16"})})}),s.jsx("span",{className:"text-white font-medium min-w-[4ch] text-center","aria-label":"Current year",children:n.getFullYear()}),s.jsx("button",{onClick:y,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":`Go to year ${n.getFullYear()+1}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M4 12h16"})})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:d,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":`Go to ${b[(n.getMonth()+11)%12]}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("span",{className:"text-white font-medium min-w-[100px] text-center","aria-label":"Current month",children:b[n.getMonth()]}),s.jsx("button",{onClick:g,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":`Go to ${b[(n.getMonth()+1)%12]}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(h=>s.jsx("div",{className:"text-center text-gray-400 text-sm py-2",children:h},h))}),s.jsx("div",{className:"grid grid-cols-7 gap-1",role:"grid","aria-label":"Calendar",children:x.map((h,w)=>{if(!h)return s.jsx("div",{className:"h-10"},w);const E=v(h,r),T=h.getMonth()===n.getMonth();return s.jsxs("button",{onClick:()=>l(h),onKeyDown:I=>{if(I.key==="ArrowLeft"){I.preventDefault();const N=new Date(h);N.setDate(h.getDate()-1),l(N)}else if(I.key==="ArrowRight"){I.preventDefault();const N=new Date(h);N.setDate(h.getDate()+1),l(N)}},disabled:a,className:`
                h-10 rounded-lg text-sm font-medium relative
                ${E?"bg-[#8B5CF6] text-white":"text-gray-400"}
                ${T?"hover:bg-white/10":"opacity-50"}
                ${a?"cursor-wait":"cursor-pointer"}
                disabled:cursor-wait disabled:opacity-50
                transition-colors
              `,"aria-label":`${h.toLocaleDateString()} ${E?"(Selected)":""}`,"aria-current":E?"date":void 0,"aria-disabled":a,children:[h.getDate(),a&&E&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"})})]},w)})})]})};function Ee(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function K(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function me(t){K(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||On(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Ki(t,e){K(2,arguments);var r=me(t).getTime(),n=Ee(e);return new Date(r+n)}var Qi={};function It(){return Qi}function _i(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function eo(t){return K(1,arguments),t instanceof Date||On(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function to(t){if(K(1,arguments),!eo(t)&&typeof t!="number")return!1;var e=me(t);return!isNaN(Number(e))}function ro(t,e){K(2,arguments);var r=Ee(e);return Ki(t,-r)}var no=864e5;function ao(t){K(1,arguments);var e=me(t),r=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var n=e.getTime(),i=r-n;return Math.floor(i/no)+1}function vt(t){K(1,arguments);var e=1,r=me(t),n=r.getUTCDay(),i=(n<e?7:0)+n-e;return r.setUTCDate(r.getUTCDate()-i),r.setUTCHours(0,0,0,0),r}function Un(t){K(1,arguments);var e=me(t),r=e.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var i=vt(n),a=new Date(0);a.setUTCFullYear(r,0,4),a.setUTCHours(0,0,0,0);var o=vt(a);return e.getTime()>=i.getTime()?r+1:e.getTime()>=o.getTime()?r:r-1}function io(t){K(1,arguments);var e=Un(t),r=new Date(0);r.setUTCFullYear(e,0,4),r.setUTCHours(0,0,0,0);var n=vt(r);return n}var oo=6048e5;function so(t){K(1,arguments);var e=me(t),r=vt(e).getTime()-io(e).getTime();return Math.round(r/oo)+1}function ht(t,e){var r,n,i,a,o,l,c,p;K(1,arguments);var m=It(),u=Ee((r=(n=(i=(a=e==null?void 0:e.weekStartsOn)!==null&&a!==void 0?a:e==null||(o=e.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&i!==void 0?i:m.weekStartsOn)!==null&&n!==void 0?n:(c=m.locale)===null||c===void 0||(p=c.options)===null||p===void 0?void 0:p.weekStartsOn)!==null&&r!==void 0?r:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=me(t),g=d.getUTCDay(),f=(g<u?7:0)+g-u;return d.setUTCDate(d.getUTCDate()-f),d.setUTCHours(0,0,0,0),d}function Gn(t,e){var r,n,i,a,o,l,c,p;K(1,arguments);var m=me(t),u=m.getUTCFullYear(),d=It(),g=Ee((r=(n=(i=(a=e==null?void 0:e.firstWeekContainsDate)!==null&&a!==void 0?a:e==null||(o=e.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&i!==void 0?i:d.firstWeekContainsDate)!==null&&n!==void 0?n:(c=d.locale)===null||c===void 0||(p=c.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(g>=1&&g<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=new Date(0);f.setUTCFullYear(u+1,0,g),f.setUTCHours(0,0,0,0);var y=ht(f,e),x=new Date(0);x.setUTCFullYear(u,0,g),x.setUTCHours(0,0,0,0);var b=ht(x,e);return m.getTime()>=y.getTime()?u+1:m.getTime()>=b.getTime()?u:u-1}function lo(t,e){var r,n,i,a,o,l,c,p;K(1,arguments);var m=It(),u=Ee((r=(n=(i=(a=e==null?void 0:e.firstWeekContainsDate)!==null&&a!==void 0?a:e==null||(o=e.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&i!==void 0?i:m.firstWeekContainsDate)!==null&&n!==void 0?n:(c=m.locale)===null||c===void 0||(p=c.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&r!==void 0?r:1),d=Gn(t,e),g=new Date(0);g.setUTCFullYear(d,0,u),g.setUTCHours(0,0,0,0);var f=ht(g,e);return f}var co=6048e5;function uo(t,e){K(1,arguments);var r=me(t),n=ht(r,e).getTime()-lo(r,e).getTime();return Math.round(n/co)+1}function U(t,e){for(var r=t<0?"-":"",n=Math.abs(t).toString();n.length<e;)n="0"+n;return r+n}var fe={y:function(e,r){var n=e.getUTCFullYear(),i=n>0?n:1-n;return U(r==="yy"?i%100:i,r.length)},M:function(e,r){var n=e.getUTCMonth();return r==="M"?String(n+1):U(n+1,2)},d:function(e,r){return U(e.getUTCDate(),r.length)},a:function(e,r){var n=e.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(e,r){return U(e.getUTCHours()%12||12,r.length)},H:function(e,r){return U(e.getUTCHours(),r.length)},m:function(e,r){return U(e.getUTCMinutes(),r.length)},s:function(e,r){return U(e.getUTCSeconds(),r.length)},S:function(e,r){var n=r.length,i=e.getUTCMilliseconds(),a=Math.floor(i*Math.pow(10,n-3));return U(a,r.length)}},Pe={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},po={G:function(e,r,n){var i=e.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,r,n){if(r==="yo"){var i=e.getUTCFullYear(),a=i>0?i:1-i;return n.ordinalNumber(a,{unit:"year"})}return fe.y(e,r)},Y:function(e,r,n,i){var a=Gn(e,i),o=a>0?a:1-a;if(r==="YY"){var l=o%100;return U(l,2)}return r==="Yo"?n.ordinalNumber(o,{unit:"year"}):U(o,r.length)},R:function(e,r){var n=Un(e);return U(n,r.length)},u:function(e,r){var n=e.getUTCFullYear();return U(n,r.length)},Q:function(e,r,n){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(r){case"Q":return String(i);case"QQ":return U(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,r,n){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(r){case"q":return String(i);case"qq":return U(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,r,n){var i=e.getUTCMonth();switch(r){case"M":case"MM":return fe.M(e,r);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,r,n){var i=e.getUTCMonth();switch(r){case"L":return String(i+1);case"LL":return U(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,r,n,i){var a=uo(e,i);return r==="wo"?n.ordinalNumber(a,{unit:"week"}):U(a,r.length)},I:function(e,r,n){var i=so(e);return r==="Io"?n.ordinalNumber(i,{unit:"week"}):U(i,r.length)},d:function(e,r,n){return r==="do"?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):fe.d(e,r)},D:function(e,r,n){var i=ao(e);return r==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):U(i,r.length)},E:function(e,r,n){var i=e.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,r,n,i){var a=e.getUTCDay(),o=(a-i.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return U(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,n,i){var a=e.getUTCDay(),o=(a-i.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return U(o,r.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,n){var i=e.getUTCDay(),a=i===0?7:i;switch(r){case"i":return String(a);case"ii":return U(a,r.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,r,n){var i=e.getUTCHours(),a=i/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,n){var i=e.getUTCHours(),a;switch(i===12?a=Pe.noon:i===0?a=Pe.midnight:a=i/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,n){var i=e.getUTCHours(),a;switch(i>=17?a=Pe.evening:i>=12?a=Pe.afternoon:i>=4?a=Pe.morning:a=Pe.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,n){if(r==="ho"){var i=e.getUTCHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return fe.h(e,r)},H:function(e,r,n){return r==="Ho"?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):fe.H(e,r)},K:function(e,r,n){var i=e.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(i,{unit:"hour"}):U(i,r.length)},k:function(e,r,n){var i=e.getUTCHours();return i===0&&(i=24),r==="ko"?n.ordinalNumber(i,{unit:"hour"}):U(i,r.length)},m:function(e,r,n){return r==="mo"?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):fe.m(e,r)},s:function(e,r,n){return r==="so"?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):fe.s(e,r)},S:function(e,r){return fe.S(e,r)},X:function(e,r,n,i){var a=i._originalDate||e,o=a.getTimezoneOffset();if(o===0)return"Z";switch(r){case"X":return Zr(o);case"XXXX":case"XX":return Ce(o);case"XXXXX":case"XXX":default:return Ce(o,":")}},x:function(e,r,n,i){var a=i._originalDate||e,o=a.getTimezoneOffset();switch(r){case"x":return Zr(o);case"xxxx":case"xx":return Ce(o);case"xxxxx":case"xxx":default:return Ce(o,":")}},O:function(e,r,n,i){var a=i._originalDate||e,o=a.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+zr(o,":");case"OOOO":default:return"GMT"+Ce(o,":")}},z:function(e,r,n,i){var a=i._originalDate||e,o=a.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+zr(o,":");case"zzzz":default:return"GMT"+Ce(o,":")}},t:function(e,r,n,i){var a=i._originalDate||e,o=Math.floor(a.getTime()/1e3);return U(o,r.length)},T:function(e,r,n,i){var a=i._originalDate||e,o=a.getTime();return U(o,r.length)}};function zr(t,e){var r=t>0?"-":"+",n=Math.abs(t),i=Math.floor(n/60),a=n%60;if(a===0)return r+String(i);var o=e;return r+String(i)+o+U(a,2)}function Zr(t,e){if(t%60===0){var r=t>0?"-":"+";return r+U(Math.abs(t)/60,2)}return Ce(t,e)}function Ce(t,e){var r=e||"",n=t>0?"-":"+",i=Math.abs(t),a=U(Math.floor(i/60),2),o=U(i%60,2);return n+a+r+o}var Jr=function(e,r){switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},qn=function(e,r){switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},mo=function(e,r){var n=e.match(/(P+)(p+)?/)||[],i=n[1],a=n[2];if(!a)return Jr(e,r);var o;switch(i){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",Jr(i,r)).replace("{{time}}",qn(a,r))},go={p:qn,P:mo},fo=["D","DD"],vo=["YY","YYYY"];function ho(t){return fo.indexOf(t)!==-1}function xo(t){return vo.indexOf(t)!==-1}function Xr(t,e,r){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var bo={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},yo=function(e,r,n){var i,a=bo[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function Gt(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var wo={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},So={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},No={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Co={date:Gt({formats:wo,defaultWidth:"full"}),time:Gt({formats:So,defaultWidth:"full"}),dateTime:Gt({formats:No,defaultWidth:"full"})},Do={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Eo=function(e,r,n,i){return Do[e]};function qe(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,o=r!=null&&r.width?String(r.width):a;i=t.formattingValues[o]||t.formattingValues[a]}else{var l=t.defaultWidth,c=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[c]||t.values[l]}var p=t.argumentCallback?t.argumentCallback(e):e;return i[p]}}var jo={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Io={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ko={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},To={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Po={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ro={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Ao=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Oo={ordinalNumber:Ao,era:qe({values:jo,defaultWidth:"wide"}),quarter:qe({values:Io,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:qe({values:ko,defaultWidth:"wide"}),day:qe({values:To,defaultWidth:"wide"}),dayPeriod:qe({values:Po,defaultWidth:"wide",formattingValues:Ro,defaultFormattingWidth:"wide"})};function $e(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;var o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Lo(l,function(u){return u.test(o)}):Mo(l,function(u){return u.test(o)}),p;p=t.valueCallback?t.valueCallback(c):c,p=r.valueCallback?r.valueCallback(p):p;var m=e.slice(o.length);return{value:p,rest:m}}}function Mo(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function Lo(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function Bo(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],a=e.match(t.parsePattern);if(!a)return null;var o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;var l=e.slice(i.length);return{value:o,rest:l}}}var Fo=/^(\d+)(th|st|nd|rd)?/i,Wo=/\d+/i,Ho={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Uo={any:[/^b/i,/^(a|c)/i]},Go={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},qo={any:[/1/i,/2/i,/3/i,/4/i]},$o={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Vo={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Yo={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},zo={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Zo={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Jo={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Xo={ordinalNumber:Bo({matchPattern:Fo,parsePattern:Wo,valueCallback:function(e){return parseInt(e,10)}}),era:$e({matchPatterns:Ho,defaultMatchWidth:"wide",parsePatterns:Uo,defaultParseWidth:"any"}),quarter:$e({matchPatterns:Go,defaultMatchWidth:"wide",parsePatterns:qo,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:$e({matchPatterns:$o,defaultMatchWidth:"wide",parsePatterns:Vo,defaultParseWidth:"any"}),day:$e({matchPatterns:Yo,defaultMatchWidth:"wide",parsePatterns:zo,defaultParseWidth:"any"}),dayPeriod:$e({matchPatterns:Zo,defaultMatchWidth:"any",parsePatterns:Jo,defaultParseWidth:"any"})},Ko={code:"en-US",formatDistance:yo,formatLong:Co,formatRelative:Eo,localize:Oo,match:Xo,options:{weekStartsOn:0,firstWeekContainsDate:1}},Qo=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_o=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,es=/^'([^]*?)'?$/,ts=/''/g,rs=/[a-zA-Z]/;function ns(t,e,r){var n,i,a,o,l,c,p,m,u,d,g,f,y,x;K(2,arguments);var b=String(e),v=It(),h=(n=(i=void 0)!==null&&i!==void 0?i:v.locale)!==null&&n!==void 0?n:Ko,w=Ee((a=(o=(l=(c=void 0)!==null&&c!==void 0?c:void 0)!==null&&l!==void 0?l:v.firstWeekContainsDate)!==null&&o!==void 0?o:(p=v.locale)===null||p===void 0||(m=p.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!(w>=1&&w<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var E=Ee((u=(d=(g=(f=void 0)!==null&&f!==void 0?f:void 0)!==null&&g!==void 0?g:v.weekStartsOn)!==null&&d!==void 0?d:(y=v.locale)===null||y===void 0||(x=y.options)===null||x===void 0?void 0:x.weekStartsOn)!==null&&u!==void 0?u:0);if(!(E>=0&&E<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!h.localize)throw new RangeError("locale must contain localize property");if(!h.formatLong)throw new RangeError("locale must contain formatLong property");var T=me(t);if(!to(T))throw new RangeError("Invalid time value");var I=_i(T),N=ro(T,I),D={firstWeekContainsDate:w,weekStartsOn:E,locale:h,_originalDate:T},O=b.match(_o).map(function(C){var M=C[0];if(M==="p"||M==="P"){var k=go[M];return k(C,h.formatLong)}return C}).join("").match(Qo).map(function(C){if(C==="''")return"'";var M=C[0];if(M==="'")return as(C);var k=po[M];if(k)return xo(C)&&Xr(C,e,String(t)),ho(C)&&Xr(C,e,String(t)),k(N,C,h.localize,D);if(M.match(rs))throw new RangeError("Format string contains an unescaped latin alphabet character `"+M+"`");return C}).join("");return O}function as(t){var e=t.match(es);return e?e[1].replace(ts,"'"):t}function ar(t,e){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ar(t,e)}const is=({onSave:t,onClose:e,initialSet:r,previousSet:n,exerciseName:i,setNumber:a,totalSets:o,onDelete:l})=>{const[c,p]=S.useState({reps:(r==null?void 0:r.reps)||0,weight:(r==null?void 0:r.weight)||0,difficulty:(r==null?void 0:r.difficulty)||se.EASY,comment:(r==null?void 0:r.comment)||""}),m=f=>{p(y=>({...y,weight:Math.max(0,+(y.weight+f).toFixed(1))}))},u=f=>{p(y=>({...y,reps:Math.max(0,y.reps+f)}))},d=(f,y)=>{const x=f.target.value===""?0:parseFloat(f.target.value);isNaN(x)||p(b=>({...b,[y]:y==="weight"?Math.max(0,Math.min(999.9,x)):Math.max(0,Math.min(999,Math.floor(x)))}))},g=()=>{if(n)try{console.log("Copying set:",n),p({reps:n.reps,weight:n.weight,difficulty:n.difficulty,comment:n.comment||""}),mt.success(`Copied set: ${n.weight}kg × ${n.reps}`,{id:"copy-set-success"})}catch(f){console.error("Error copying set:",f),mt.error("Failed to copy set values")}};return S.useEffect(()=>{console.log("SetEditorDialog mounted with props:",{previousSet:n,setNumber:a,totalSets:o,initialSet:r})},[n,a,o,r]),s.jsxs("div",{className:"fixed inset-0 bg-black/95 flex flex-col z-50 max-w-[100vw] overflow-x-hidden",children:[s.jsxs("header",{className:"px-4 py-3 border-b border-white/10 shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h2",{className:"text-xl font-bold text-white truncate flex-1",children:i}),n&&s.jsxs("button",{onClick:g,className:"ml-2 w-[44px] h-[44px] rounded-lg bg-white/5 hover:bg-white/10 text-white flex items-center justify-center shrink-0 group relative","aria-label":`Copy values from previous set (${n.weight}kg × ${n.reps})`,title:`Copy previous set: ${n.weight}kg × ${n.reps}`,children:[s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:[s.jsx("path",{d:"M7 9a2 2 0 012-2h6a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9z"}),s.jsx("path",{d:"M5 3a2 2 0 00-2 2v6a2 2 0 002 2V5h8a2 2 0 00-2-2H5z"})]}),s.jsxs("span",{className:"absolute bottom-full right-0 mb-2 px-2 py-1 text-sm bg-black/90 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:["Copy: ",n.weight,"kg × ",n.reps]})]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"text-lg text-white/90",children:["Set №",a," of ",o]}),s.jsx("span",{className:"text-sm text-white/60 ml-2",children:ns(new Date,"dd. MMM, HH:mm")})]})]}),s.jsxs("main",{className:"flex-1 overflow-y-auto px-4 py-6 space-y-6 max-w-full",children:[s.jsxs("div",{className:"space-y-2 max-w-full",children:[s.jsx("label",{className:"text-lg text-white/90",children:"Weight (kg)"}),s.jsxs("div",{className:"flex items-center gap-2 w-full",children:[s.jsx("button",{onClick:()=>m(-2.5),className:"w-[44px] h-[44px] rounded-full bg-[#2a2a2a] text-white/90 text-2xl flex items-center justify-center active:bg-[#333] shrink-0","aria-label":"Decrease weight",children:"−"}),s.jsx("div",{className:"flex-1 min-w-0 px-2",children:s.jsx("input",{type:"number",value:c.weight||"",onChange:f=>d(f,"weight"),step:"2.5",className:"w-full bg-transparent text-center text-2xl sm:text-3xl font-semibold text-white border-b-2 border-white/20 focus:border-purple-500 focus:outline-none",inputMode:"decimal"})}),s.jsx("button",{onClick:()=>m(2.5),className:"w-[44px] h-[44px] rounded-full bg-[#2a2a2a] text-white/90 text-2xl flex items-center justify-center active:bg-[#333] shrink-0","aria-label":"Increase weight",children:"+"})]})]}),s.jsxs("div",{className:"space-y-2 max-w-full",children:[s.jsx("label",{className:"text-lg text-white/90",children:"Reps"}),s.jsxs("div",{className:"flex items-center gap-2 w-full",children:[s.jsx("button",{onClick:()=>u(-1),className:"w-[44px] h-[44px] rounded-full bg-[#2a2a2a] text-white/90 text-2xl flex items-center justify-center active:bg-[#333] shrink-0","aria-label":"Decrease reps",children:"−"}),s.jsx("div",{className:"flex-1 min-w-0 px-2",children:s.jsx("input",{type:"number",value:c.reps||"",onChange:f=>d(f,"reps"),className:"w-full bg-transparent text-center text-2xl sm:text-3xl font-semibold text-white border-b-2 border-white/20 focus:border-purple-500 focus:outline-none",inputMode:"numeric"})}),s.jsx("button",{onClick:()=>u(1),className:"w-[44px] h-[44px] rounded-full bg-[#2a2a2a] text-white/90 text-2xl flex items-center justify-center active:bg-[#333] shrink-0","aria-label":"Increase reps",children:"+"})]})]}),s.jsxs("div",{className:"space-y-2 max-w-full",children:[s.jsx("label",{className:"text-lg text-white/90",children:"How was the set?"}),s.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2",children:Object.values(se).map(f=>s.jsx("button",{onClick:()=>p(y=>({...y,difficulty:f})),className:`min-h-[44px] rounded-lg ${c.difficulty===f?"bg-purple-600 text-white":"bg-[#2a2a2a] text-white/70"} text-sm font-medium transition-colors`,children:f},f))})]}),s.jsxs("div",{className:"space-y-2 max-w-full",children:[s.jsx("label",{className:"text-lg text-white/90",children:"Notes (optional)"}),s.jsx("textarea",{value:c.comment||"",onChange:f=>p(y=>({...y,comment:f.target.value})),placeholder:"Add a note...",className:"w-full h-24 px-4 py-3 rounded-lg bg-[#2a2a2a] text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsx("footer",{className:"px-4 py-3 border-t border-white/10 shrink-0",children:s.jsxs("div",{className:"flex flex-col-reverse sm:flex-row items-stretch sm:items-center gap-3",children:[l&&s.jsx("button",{onClick:l,className:"w-full sm:w-auto px-6 py-3 rounded-lg bg-red-500/10 text-red-500 font-medium min-h-[44px]",children:"Delete Set"}),s.jsxs("div",{className:"flex items-stretch sm:items-center gap-3 flex-1 w-full sm:w-auto justify-end",children:[s.jsx("button",{onClick:e,className:"flex-1 sm:flex-initial px-6 py-3 rounded-lg bg-white/10 text-white font-medium min-h-[44px]",children:"Cancel"}),s.jsx("button",{onClick:()=>t(c),className:"flex-1 sm:flex-initial px-8 py-3 rounded-lg bg-purple-600 text-white font-medium min-h-[44px]",children:"Save"})]})]})})]})},os=t=>{var r;if(t.activityType&&t.activityType!==j.RESISTANCE||t.type&&["cardio","endurance","flexibility","teamSports","speedAgility","speed_agility","other"].includes(t.type))return!0;const e=((r=t.category)==null?void 0:r.toLowerCase())||"";return!!(e.includes("cardio")||e.includes("endurance")||e.includes("stretch")||e.includes("sport")||e.includes("agility")||e.includes("plyometric"))},ss=({exercise:t,onSave:e,onCancel:r,isEditing:n=!1,previousSet:i,showPreviousSets:a=!0,useExerciseId:o=!1})=>{if(os(t)){const v=h=>{o?e(h,t.id):e(h)};return s.jsx(ye,{exercise:t,onSave:v,onCancel:r,initialSets:t.sets||[],isEditing:n})}const[l,c]=S.useState(()=>n&&t.sets&&t.sets.length>0?t.sets:[]),[p,m]=S.useState(!n),[u,d]=S.useState(null),g=v=>{if(typeof v=="number"&&v>0)return l[v-1];if(a)return l.length>0?l[l.length-1]:i};S.useEffect(()=>{},[l,n,u,i,a]);const f=(v,h)=>{typeof h=="number"?(c(l.map((w,E)=>E===h?v:w)),d(null)):c([...l,v]),m(!1)},y=v=>{c(l.filter((h,w)=>w!==v))},x=()=>{if(l.length===0){r();return}o?e(l,t.id):e(l)},b=(v,h)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#2a2a2a] rounded-lg mb-2 cursor-pointer hover:bg-[#3a3a3a]",onClick:()=>d(h),children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{className:"text-gray-400",children:["Set ",h+1]}),s.jsxs("span",{className:"text-white font-medium",children:[v.weight,"kg × ",v.reps]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx("span",{className:`px-3 py-1 rounded text-sm ${v.difficulty===se.WARMUP?"bg-gray-600":v.difficulty===se.EASY?"bg-green-600":v.difficulty===se.NORMAL?"bg-blue-600":v.difficulty===se.HARD?"bg-red-600":v.difficulty===se.DROP?"bg-purple-600":"bg-gray-600"}`,children:v.difficulty})})]},h);return s.jsxs("div",{className:"flex flex-col h-full bg-[#1a1a1a]",children:[s.jsxs("div",{className:"flex-1 p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-white",children:[n?"Edit":"Log"," ",t.name]}),s.jsxs("span",{className:"text-gray-400",children:[l.length," sets"]})]}),l.map((v,h)=>b(v,h)),(p||u!==null)&&s.jsx(is,{onSave:v=>f(v,u??void 0),onClose:()=>{m(!1),d(null)},initialSet:u!==null?l[u]:void 0,previousSet:g(u??void 0),exerciseName:t.name,setNumber:(u!==null?u:l.length)+1,totalSets:u!==null?l.length:l.length+1,onDelete:u!==null?()=>y(u):void 0}),!p&&u===null&&s.jsx("button",{onClick:()=>m(!0),className:"w-full py-4 mt-4 rounded-lg bg-white/5 hover:bg-white/10 text-white font-medium transition-colors",children:"Add Set"})]}),s.jsx("div",{className:"p-4 border-t border-white/10",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:x,className:"flex-1 py-3 rounded-lg bg-[#8B5CF6] text-white font-medium hover:bg-[#7C3AED] transition-colors",children:n?"Update":"Save"}),s.jsx("button",{onClick:r,className:"flex-1 py-3 rounded-lg bg-white/5 text-white font-medium hover:bg-white/10 transition-colors",children:"Cancel"})]})})]})},ls=t=>{const e=t.toLowerCase();return e.includes("squat")||e.includes("leg press")?"🏋️":e.includes("bench")||e.includes("press")&&e.includes("chest")?"💪":e.includes("deadlift")||e.includes("row")?"🔥":e.includes("curl")||e.includes("bicep")?"💪":e.includes("pull")||e.includes("chin")?"🔙":e.includes("shoulder")||e.includes("overhead")?"🏋️":e.includes("core")||e.includes("plank")||e.includes("crunch")||e.includes("cardio")||e.includes("run")||e.includes("bike")?"🏃":"💪"},cs=({exercises:t,onClose:e})=>{var a;const r=o=>o.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),n=()=>t.reduce((o,l)=>o+l.sets.length,0),i=()=>t.reduce((o,l)=>o+l.sets.reduce((c,p)=>c+(p.weight||0)*(p.reps||0),0),0);return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",children:s.jsxs("div",{className:"w-full max-w-md mx-4 bg-[#1a1a1a] rounded-lg max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"bg-green-600 p-4 text-center",children:[s.jsx("div",{className:"text-white text-lg font-bold mb-1",children:"Workout Complete!"}),s.jsx("div",{className:"text-green-100 text-sm",children:r(new Date(((a=t[0])==null?void 0:a.timestamp)||Date.now()))})]}),s.jsx("div",{className:"p-4 border-b border-gray-700",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-white text-xl font-bold",children:t.length}),s.jsx("div",{className:"text-gray-400 text-sm",children:"Exercises"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white text-xl font-bold",children:n()}),s.jsx("div",{className:"text-gray-400 text-sm",children:"Sets"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-white text-xl font-bold",children:i().toLocaleString()}),s.jsx("div",{className:"text-gray-400 text-sm",children:"Total kg"})]})]})}),s.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:t.map(o=>s.jsxs("div",{className:"flex items-center p-4 border-b border-gray-800",children:[s.jsx("div",{className:"w-12 h-12 bg-[#333] rounded-lg flex items-center justify-center mr-4",children:s.jsx("span",{className:"text-2xl",children:ls(o.exerciseName)})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-white font-medium text-base mb-1",children:o.exerciseName}),s.jsx("div",{className:"flex flex-wrap gap-1",children:o.sets.map((l,c)=>{let p="bg-gray-700";if(l.difficulty)switch(l.difficulty){case se.WARMUP:p="bg-blue-600";break;case se.EASY:p="bg-green-600";break;case se.NORMAL:p="bg-yellow-600";break;case se.HARD:p="bg-red-600";break;default:p="bg-gray-700"}return s.jsxs("div",{className:`${p} text-white text-xs px-2 py-1 rounded`,children:[l.weight?`${l.weight}kg × `:"",l.reps," ",l.weight?"":"reps"]},c)})}),s.jsxs("div",{className:"text-gray-400 text-sm mt-1",children:[o.sets.reduce((l,c)=>l+(c.weight||0)*(c.reps||0),0).toLocaleString()," kg total"]})]}),s.jsxs("div",{className:"text-gray-400 text-sm",children:[o.sets.length," set",o.sets.length!==1?"s":""]})]},o.id))}),s.jsx("div",{className:"p-4",children:s.jsx("button",{onClick:e,className:"w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Done"})})]})})},us=async()=>{const t=Mn.currentUser;if(!t)return console.warn("No authenticated user, falling back to localStorage"),Ke();try{console.log("🔍 Fetching all exercises from Firestore for export...");const e=jt(ve,"users",t.uid,"exercises"),r=dr(e,Bn("timestamp","desc")),n=await pr(r),i=[];return n.forEach(a=>{const o=a.data();let l;o.timestamp&&typeof o.timestamp.toDate=="function"?l=o.timestamp.toDate():o.timestamp instanceof Date?l=o.timestamp:typeof o.timestamp=="string"?l=new Date(o.timestamp):(console.warn("Invalid timestamp format, using current date:",o.timestamp),l=new Date),i.push({id:a.id,exerciseName:o.exerciseName,sets:o.sets,timestamp:l,deviceId:o.deviceId||"",userId:o.userId})}),console.log(`✅ Retrieved ${i.length} resistance exercises from Firestore for export`),i}catch(e){return console.error("❌ Error fetching exercises from Firestore, falling back to localStorage:",e),Ke()}},ds=()=>{try{return JSON.parse(localStorage.getItem("activity-logs")||"[]").map(e=>({...e,timestamp:new Date(e.timestamp)}))}catch(t){return console.error("Error fetching activity logs from localStorage:",t),[]}},ps=async()=>{if(!Mn.currentUser)return console.warn("No authenticated user, using localStorage data"),Ke();try{const e=await us(),n=ds().map(a=>{var l,c;let o=[];if(a.activityType==="sport")o=((l=a.sessions)==null?void 0:l.map((m,u)=>({setNumber:u+1,activityType:"sport",duration:m.duration,distance:m.distance,calories:m.calories,intensity:m.intensity,performance:m.performance,skills:m.skills,notes:m.notes})))||[];else if(a.activityType==="endurance")o=((c=a.sessions)==null?void 0:c.map((m,u)=>({setNumber:u+1,activityType:"endurance",duration:m.duration,distance:m.distance,pace:m.pace,averageHeartRate:m.averageHeartRate||m.averageHR,maxHeartRate:m.maxHeartRate||m.maxHR,calories:m.calories,elevation:m.elevation,rpe:m.rpe,hrZone1:m.hrZone1,hrZone2:m.hrZone2,hrZone3:m.hrZone3,notes:m.notes})))||[];else if(a.activityType==="stretching"){const p=a;o=(p.stretches||p.sessions||[]).map((u,d)=>({setNumber:d+1,activityType:"stretching",holdTime:u.holdTime,intensity:u.intensity,flexibility:u.flexibility,bodyPart:u.bodyPart,stretchType:u.stretchType,notes:u.notes}))||[]}else if(a.activityType==="other"){const p=a;o=(p.customData||p.sessions||[]).map((u,d)=>({setNumber:d+1,activityType:"other",duration:u.duration,calories:u.calories,heartRate:u.heartRate,intensity:u.intensity,notes:u.notes,...u.customValues&&u.customValues,...Object.keys(u).reduce((g,f)=>(["sessionNumber","duration","calories","heartRate","intensity","notes","customValues"].includes(f)||(g[f]=u[f]),g),{})}))||[]}return{id:a.id,exerciseName:a.activityName,sets:o,timestamp:a.timestamp,deviceId:"activity-logger",userId:a.userId,activityType:a.activityType}}),i=[...e,...n];return console.log(`📊 Total exercises for export: ${i.length} (${e.length} resistance + ${n.length} activities)`),i}catch(e){return console.error("Error getting all exercises for export:",e),Ke()}},ms={warmUp:3,easy:5,moderate:7,hard:8,failure:9,dropSet:10,WARMUP:3,EASY:5,NORMAL:7,HARD:9,DROP:8},$n=t=>t&&ms[t]||7,Vn=t=>t&&{warmUp:"Warm Up",easy:"Easy",moderate:"Moderate",hard:"Hard",failure:"Failure",dropSet:"Drop Set",WARMUP:"Warm Up",EASY:"Easy",NORMAL:"Moderate",HARD:"Hard",DROP:"Drop Set"}[t]||"Moderate",Yn=(t,e,r)=>{if(!e||!r)return console.log("🔍 No date filter applied, returning all exercises"),t;const n=new Date(e);n.setHours(0,0,0,0);const i=new Date(r);i.setHours(23,59,59,999),console.log(`🔍 Filtering exercises by date range: ${n.toLocaleDateString()} to ${i.toLocaleDateString()}`);const a=t.filter(o=>{const l=new Date(o.timestamp);return l>=n&&l<=i});return console.log(`📊 Filtered ${a.length} exercises from ${t.length} total`),a},gs=(t,e,r)=>{const n=Yn(t,e,r);if(n.length===0)return"";const i=n.some(u=>u.activityType==="resistance"||!u.activityType),a=n.some(u=>u.activityType==="sport"),o=n.some(u=>u.activityType==="endurance"),l=n.some(u=>u.activityType==="stretching"),c=n.some(u=>u.activityType==="other");let p=["Date","Exercise","Activity Type","Set"];i&&p.push("Weight (kg)","Reps"),a&&p.push("Duration (min)","Distance (m)","Calories","Score","Opponent","Performance"),o&&p.push("Duration (min)","Distance (m)","Pace","Avg HR","Max HR","Calories","Elevation","RPE","Zone 1","Zone 2","Zone 3","Zone 4","Zone 5"),l&&p.push("Duration (min)","Hold Time (s)","Body Part","Stretch Type","Flexibility"),c&&p.push("Duration (min)","Calories","Heart Rate"),p.push("Intensity","Difficulty","RPE Score","Notes");const m=[p.join(",")];return console.log(`📝 Processing ${n.length} exercises for CSV export with activity types:`,{hasResistance:i,hasSport:a,hasEndurance:o,hasStretching:l,hasOther:c}),n.forEach(u=>{const d=new Date(u.timestamp),g=u.activityType||"resistance";u.sets.forEach((f,y)=>{const x=Vn(f.difficulty),b=$n(f.difficulty);let v=[`"${d.toLocaleDateString()}"`,`"${u.exerciseName}"`,g,y+1];i&&(g==="resistance"?v.push(String(f.weight||0),String(f.reps||0)):v.push("","")),a&&(g==="sport"?v.push(String(f.duration||""),String(f.distance||""),String(f.calories||""),String(f.score||""),`"${f.opponent||""}"`,String(f.performance||"")):v.push("","","","","","")),o&&(g==="endurance"?v.push(String(f.duration||""),String(f.distance||""),String(f.pace||""),String(f.averageHeartRate||""),String(f.maxHeartRate||""),String(f.calories||""),String(f.elevation||""),String(f.rpe||""),String(f.hrZone1||""),String(f.hrZone2||""),String(f.hrZone3||""),String(f.hrZone4||""),String(f.hrZone5||"")):v.push("","","","","","","","","","","","","")),l&&(g==="stretching"?v.push(String(f.duration||""),String(f.holdTime||""),`"${f.bodyPart||""}"`,`"${f.stretchType||""}"`,String(f.flexibility||"")):v.push("","","","","")),c&&(g==="other"?v.push(String(f.duration||""),String(f.calories||""),String(f.heartRate||"")):v.push("","","")),v.push(String(f.intensity||""),`"${x}"`,String(b),`"${f.notes||""}"`),m.push(v.join(","))})}),m.join(`
`)},fs=(t,e)=>{const r=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(r),n.setAttribute("download",e),document.body.appendChild(n),n.click(),document.body.removeChild(n)},vs=async(t,e,r,n="both")=>{let i;console.log("🔍 Getting all exercises (including activities) for export..."),i=await ps(),console.log(`📊 Retrieved ${i.length} total exercises for potential export`);const a=Yn(i,e,r);if(console.log(`📅 After date filtering: ${a.length} exercises in range`),a.length===0){const l=e&&r?`No exercises found in the selected date range (${e.toLocaleDateString()} - ${r.toLocaleDateString()})!`:"No exercises to export!";alert(l);return}const o=e&&r?`_${e.toISOString().split("T")[0]}_to_${r.toISOString().split("T")[0]}`:`_${new Date().toISOString().split("T")[0]}`;if(n==="csv"||n==="both"){const l=gs(a.map(c=>({...c,id:c.id??""})),e,r);l&&fs(l,`exercise-log${o}.csv`)}if(n==="json"||n==="both"){const l=a.map(u=>({...u,timestamp:u.timestamp instanceof Date?u.timestamp.toISOString():u.timestamp,sets:u.sets.map(d=>({...d,difficultyText:Vn(d.difficulty),rpeScore:$n(d.difficulty)}))})),c={exportInfo:{exportDate:new Date().toISOString(),dateRange:e&&r?{startDate:e.toISOString().split("T")[0],endDate:r.toISOString().split("T")[0]}:"All dates",totalExercises:l.length,totalSets:l.reduce((u,d)=>u+d.sets.length,0),format:"json"},rpeReference:{"Warm Up":3,Easy:5,Moderate:7,Hard:8,Failure:9,"Drop Set":10},exercises:l},p=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),m=document.createElement("a");m.href=URL.createObjectURL(p),m.setAttribute("download",`exercise-log-backup${o}.json`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}},hs=async t=>new Promise((e,r)=>{const n=new FileReader;n.onload=i=>{var a;try{const o=(a=i.target)==null?void 0:a.result,c=JSON.parse(o).map(p=>({id:p.id||`imported-${Date.now()}`,exerciseName:p.exerciseName,sets:p.sets,timestamp:new Date(p.timestamp),deviceId:p.deviceId||localStorage.getItem("device_id")||""}));e(c)}catch{r(new Error("Failed to parse import file"))}},n.onerror=()=>r(new Error("Failed to read file")),n.readAsText(t)}),xs=({isOpen:t,onClose:e,onExport:r})=>{const[n,i]=S.useState(""),[a,o]=S.useState(""),[l,c]=S.useState(!0),[p,m]=S.useState("both");if(!t)return null;const u=()=>{if(l)r(void 0,void 0,p);else{const g=n?new Date(n):void 0,f=a?new Date(a):void 0;if(g&&f&&g>f){alert("Start date must be before end date");return}r(g,f,p)}e()},d=new Date().toISOString().split("T")[0];return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[60] transition-opacity",onClick:e}),s.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-bg-primary rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-4 border-b border-border-secondary",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Export Exercise Data"}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-bg-secondary rounded-full transition-colors","aria-label":"Close Modal",children:s.jsx("svg",{className:"w-5 h-5 text-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),s.jsxs("div",{className:"p-4 space-y-5",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-medium text-text-primary",children:"File Format"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"radio",name:"formatOption",value:"csv",checked:p==="csv",onChange:g=>m(g.target.value),className:"w-4 h-4 text-primary-400 border-border-secondary bg-bg-primary focus:ring-primary-400 focus:ring-2"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-text-primary font-medium",children:"CSV only"}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Spreadsheet format for analysis"})]})]}),s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"radio",name:"formatOption",value:"json",checked:p==="json",onChange:g=>m(g.target.value),className:"w-4 h-4 text-primary-400 border-border-secondary bg-bg-primary focus:ring-primary-400 focus:ring-2"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-text-primary font-medium",children:"JSON only"}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Structured format for backup"})]})]}),s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"radio",name:"formatOption",value:"both",checked:p==="both",onChange:g=>m(g.target.value),className:"w-4 h-4 text-primary-400 border-border-secondary bg-bg-primary focus:ring-primary-400 focus:ring-2"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-text-primary font-medium",children:"Both CSV and JSON"}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Export in both formats"})]})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-sm font-medium text-text-primary",children:"Date Range"}),s.jsxs("label",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-bg-secondary/50 transition-colors cursor-pointer",children:[s.jsx("input",{type:"radio",name:"dateOption",checked:l,onChange:()=>c(!0),className:"w-4 h-4 text-primary-400 border-border-secondary bg-bg-primary focus:ring-primary-400 focus:ring-2"}),s.jsx("span",{className:"text-text-primary font-medium",children:"Export all exercise logs"})]}),s.jsxs("label",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-bg-secondary/50 transition-colors cursor-pointer",children:[s.jsx("input",{type:"radio",name:"dateOption",checked:!l,onChange:()=>c(!1),className:"w-4 h-4 text-primary-400 border-border-secondary bg-bg-primary focus:ring-primary-400 focus:ring-2"}),s.jsx("span",{className:"text-text-primary font-medium",children:"Select custom date range"})]}),!l&&s.jsxs("div",{className:"ml-7 p-3 bg-bg-secondary/30 rounded-lg space-y-3 border border-border-secondary/50",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Start Date"}),s.jsx("input",{type:"date",value:n,onChange:g=>i(g.target.value),max:d,className:`date-picker-dark w-full px-3 py-2 bg-bg-primary border border-border-secondary rounded-lg \r
                                focus:ring-2 focus:ring-primary-400 focus:border-primary-400 \r
                                text-text-primary text-sm transition-colors duration-200\r
                                hover:border-primary-300`})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"End Date"}),s.jsx("input",{type:"date",value:a,onChange:g=>o(g.target.value),max:d,min:n||void 0,className:`date-picker-dark w-full px-3 py-2 bg-bg-primary border border-border-secondary rounded-lg \r
                                focus:ring-2 focus:ring-primary-400 focus:border-primary-400 \r
                                text-text-primary text-sm transition-colors duration-200\r
                                hover:border-primary-300`})]}),n&&a&&s.jsxs("div",{className:"text-xs text-text-secondary",children:["📅 ",new Date(n).toLocaleDateString()," to ",new Date(a).toLocaleDateString()]})]})]})]}),s.jsxs("div",{className:"p-4 border-t border-border-secondary flex justify-end space-x-3",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:u,className:"px-6 py-2 bg-primary-400 hover:bg-primary-500 text-white rounded-lg transition-colors font-medium",children:["Export ",p==="csv"?"CSV":p==="json"?"JSON":"Data"]})]})]})})]})};function zn(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,ar(t,e)}var Zn=$.createContext(null);function bs(t){t()}var Jn=bs,ys=function(e){return Jn=e},ws=function(){return Jn};function Ss(){var t=ws(),e=null,r=null;return{clear:function(){e=null,r=null},notify:function(){t(function(){for(var i=e;i;)i.callback(),i=i.next})},get:function(){for(var i=[],a=e;a;)i.push(a),a=a.next;return i},subscribe:function(i){var a=!0,o=r={callback:i,next:null,prev:r};return o.prev?o.prev.next=o:e=o,function(){!a||e===null||(a=!1,o.next?o.next.prev=o.prev:r=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}var Kr={notify:function(){},get:function(){return[]}};function Xn(t,e){var r,n=Kr;function i(u){return c(),n.subscribe(u)}function a(){n.notify()}function o(){m.onStateChange&&m.onStateChange()}function l(){return!!r}function c(){r||(r=e?e.addNestedSub(o):t.subscribe(o),n=Ss())}function p(){r&&(r(),r=void 0,n.clear(),n=Kr)}var m={addNestedSub:i,notifyNestedSubs:a,handleChangeWrapper:o,isSubscribed:l,trySubscribe:c,tryUnsubscribe:p,getListeners:function(){return n}};return m}var Kn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?S.useLayoutEffect:S.useEffect;function Ns(t){var e=t.store,r=t.context,n=t.children,i=S.useMemo(function(){var l=Xn(e);return{store:e,subscription:l}},[e]),a=S.useMemo(function(){return e.getState()},[e]);Kn(function(){var l=i.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),a!==e.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[i,a]);var o=r||Zn;return $.createElement(o.Provider,{value:i},n)}var qt={exports:{}},G={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qr;function Cs(){if(Qr)return G;Qr=1;var t=60103,e=60106,r=60107,n=60108,i=60114,a=60109,o=60110,l=60112,c=60113,p=60120,m=60115,u=60116,d=60121,g=60122,f=60117,y=60129,x=60131;if(typeof Symbol=="function"&&Symbol.for){var b=Symbol.for;t=b("react.element"),e=b("react.portal"),r=b("react.fragment"),n=b("react.strict_mode"),i=b("react.profiler"),a=b("react.provider"),o=b("react.context"),l=b("react.forward_ref"),c=b("react.suspense"),p=b("react.suspense_list"),m=b("react.memo"),u=b("react.lazy"),d=b("react.block"),g=b("react.server.block"),f=b("react.fundamental"),y=b("react.debug_trace_mode"),x=b("react.legacy_hidden")}function v(k){if(typeof k=="object"&&k!==null){var W=k.$$typeof;switch(W){case t:switch(k=k.type,k){case r:case i:case n:case c:case p:return k;default:switch(k=k&&k.$$typeof,k){case o:case l:case u:case m:case a:return k;default:return W}}case e:return W}}}var h=a,w=t,E=l,T=r,I=u,N=m,D=e,O=i,C=n,M=c;return G.ContextConsumer=o,G.ContextProvider=h,G.Element=w,G.ForwardRef=E,G.Fragment=T,G.Lazy=I,G.Memo=N,G.Portal=D,G.Profiler=O,G.StrictMode=C,G.Suspense=M,G.isAsyncMode=function(){return!1},G.isConcurrentMode=function(){return!1},G.isContextConsumer=function(k){return v(k)===o},G.isContextProvider=function(k){return v(k)===a},G.isElement=function(k){return typeof k=="object"&&k!==null&&k.$$typeof===t},G.isForwardRef=function(k){return v(k)===l},G.isFragment=function(k){return v(k)===r},G.isLazy=function(k){return v(k)===u},G.isMemo=function(k){return v(k)===m},G.isPortal=function(k){return v(k)===e},G.isProfiler=function(k){return v(k)===i},G.isStrictMode=function(k){return v(k)===n},G.isSuspense=function(k){return v(k)===c},G.isValidElementType=function(k){return typeof k=="string"||typeof k=="function"||k===r||k===i||k===y||k===n||k===c||k===p||k===x||typeof k=="object"&&k!==null&&(k.$$typeof===u||k.$$typeof===m||k.$$typeof===a||k.$$typeof===o||k.$$typeof===l||k.$$typeof===f||k.$$typeof===d||k[0]===g)},G.typeOf=v,G}var _r;function Ds(){return _r||(_r=1,qt.exports=Cs()),qt.exports}var Es=Ds(),js=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],Is=["reactReduxForwardedRef"],ks=[],Ts=[null,null];function Ps(t,e){var r=t[1];return[e.payload,r+1]}function en(t,e,r){Kn(function(){return t.apply(void 0,e)},r)}function Rs(t,e,r,n,i,a,o){t.current=n,e.current=i,r.current=!1,a.current&&(a.current=null,o())}function As(t,e,r,n,i,a,o,l,c,p){if(t){var m=!1,u=null,d=function(){if(!m){var y=e.getState(),x,b;try{x=n(y,i.current)}catch(v){b=v,u=v}b||(u=null),x===a.current?o.current||c():(a.current=x,l.current=x,o.current=!0,p({type:"STORE_UPDATED",payload:{error:b}}))}};r.onStateChange=d,r.trySubscribe(),d();var g=function(){if(m=!0,r.tryUnsubscribe(),r.onStateChange=null,u)throw u};return g}}var Os=function(){return[null,0]};function Ms(t,e){e===void 0&&(e={});var r=e,n=r.getDisplayName,i=n===void 0?function(h){return"ConnectAdvanced("+h+")"}:n,a=r.methodName,o=a===void 0?"connectAdvanced":a,l=r.renderCountProp,c=l===void 0?void 0:l,p=r.shouldHandleStateChanges,m=p===void 0?!0:p,u=r.storeKey,d=u===void 0?"store":u;r.withRef;var g=r.forwardRef,f=g===void 0?!1:g,y=r.context,x=y===void 0?Zn:y,b=ft(r,js),v=x;return function(w){var E=w.displayName||w.name||"Component",T=i(E),I=L({},b,{getDisplayName:i,methodName:o,renderCountProp:c,shouldHandleStateChanges:m,storeKey:d,displayName:T,wrappedComponentName:E,WrappedComponent:w}),N=b.pure;function D(W){return t(W.dispatch,I)}var O=N?S.useMemo:function(W){return W()};function C(W){var Q=S.useMemo(function(){var Ue=W.reactReduxForwardedRef,Wt=ft(W,Is);return[W.context,Ue,Wt]},[W]),_=Q[0],ge=Q[1],R=Q[2],B=S.useMemo(function(){return _&&_.Consumer&&Es.isContextConsumer($.createElement(_.Consumer,null))?_:v},[_,v]),F=S.useContext(B),q=!!W.store&&!!W.store.getState&&!!W.store.dispatch;F&&F.store;var V=q?W.store:F.store,J=S.useMemo(function(){return D(V)},[V]),de=S.useMemo(function(){if(!m)return Ts;var Ue=Xn(V,q?null:F.subscription),Wt=Ue.notifyNestedSubs.bind(Ue);return[Ue,Wt]},[V,q,F]),ie=de[0],We=de[1],He=S.useMemo(function(){return q?F:L({},F,{subscription:ie})},[q,F,ie]),ke=S.useReducer(Ps,ks,Os),Te=ke[0],ee=Te[0],te=ke[1];if(ee&&ee.error)throw ee.error;var Lr=S.useRef(),Lt=S.useRef(R),ot=S.useRef(),Br=S.useRef(!1),Bt=O(function(){return ot.current&&R===Lt.current?ot.current:J(V.getState(),R)},[V,ee,R]);en(Rs,[Lt,Lr,Br,R,Bt,ot,We]),en(As,[m,V,ie,J,Lt,Lr,Br,ot,We,te],[V,ie,J]);var Ft=S.useMemo(function(){return $.createElement(w,L({},Bt,{ref:ge}))},[ge,w,Bt]),_a=S.useMemo(function(){return m?$.createElement(B.Provider,{value:He},Ft):Ft},[B,Ft,He]);return _a}var M=N?$.memo(C):C;if(M.WrappedComponent=w,M.displayName=C.displayName=T,f){var k=$.forwardRef(function(Q,_){return $.createElement(M,L({},Q,{reactReduxForwardedRef:_}))});return k.displayName=T,k.WrappedComponent=w,Fr(k,w)}return Fr(M,w)}}function tn(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function $t(t,e){if(tn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(var i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(e,r[i])||!tn(t[r[i]],e[r[i]]))return!1;return!0}function Ls(t,e){var r={},n=function(o){var l=t[o];typeof l=="function"&&(r[o]=function(){return e(l.apply(void 0,arguments))})};for(var i in t)n(i);return r}function mr(t){return function(r,n){var i=t(r,n);function a(){return i}return a.dependsOnOwnProps=!1,a}}function rn(t){return t.dependsOnOwnProps!==null&&t.dependsOnOwnProps!==void 0?!!t.dependsOnOwnProps:t.length!==1}function Qn(t,e){return function(n,i){i.displayName;var a=function(l,c){return a.dependsOnOwnProps?a.mapToProps(l,c):a.mapToProps(l)};return a.dependsOnOwnProps=!0,a.mapToProps=function(l,c){a.mapToProps=t,a.dependsOnOwnProps=rn(t);var p=a(l,c);return typeof p=="function"&&(a.mapToProps=p,a.dependsOnOwnProps=rn(p),p=a(l,c)),p},a}}function Bs(t){return typeof t=="function"?Qn(t):void 0}function Fs(t){return t?void 0:mr(function(e){return{dispatch:e}})}function Ws(t){return t&&typeof t=="object"?mr(function(e){return Ls(t,e)}):void 0}const Hs=[Bs,Fs,Ws];function Us(t){return typeof t=="function"?Qn(t):void 0}function Gs(t){return t?void 0:mr(function(){return{}})}const qs=[Us,Gs];function $s(t,e,r){return L({},r,t,e)}function Vs(t){return function(r,n){n.displayName;var i=n.pure,a=n.areMergedPropsEqual,o=!1,l;return function(p,m,u){var d=t(p,m,u);return o?(!i||!a(d,l))&&(l=d):(o=!0,l=d),l}}}function Ys(t){return typeof t=="function"?Vs(t):void 0}function zs(t){return t?void 0:function(){return $s}}const Zs=[Ys,zs];var Js=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function Xs(t,e,r,n){return function(a,o){return r(t(a,o),e(n,o),o)}}function Ks(t,e,r,n,i){var a=i.areStatesEqual,o=i.areOwnPropsEqual,l=i.areStatePropsEqual,c=!1,p,m,u,d,g;function f(h,w){return p=h,m=w,u=t(p,m),d=e(n,m),g=r(u,d,m),c=!0,g}function y(){return u=t(p,m),e.dependsOnOwnProps&&(d=e(n,m)),g=r(u,d,m),g}function x(){return t.dependsOnOwnProps&&(u=t(p,m)),e.dependsOnOwnProps&&(d=e(n,m)),g=r(u,d,m),g}function b(){var h=t(p,m),w=!l(h,u);return u=h,w&&(g=r(u,d,m)),g}function v(h,w){var E=!o(w,m),T=!a(h,p,w,m);return p=h,m=w,E&&T?y():E?x():T?b():g}return function(w,E){return c?v(w,E):f(w,E)}}function Qs(t,e){var r=e.initMapStateToProps,n=e.initMapDispatchToProps,i=e.initMergeProps,a=ft(e,Js),o=r(t,a),l=n(t,a),c=i(t,a),p=a.pure?Ks:Xs;return p(o,l,c,t,a)}var _s=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function Vt(t,e,r){for(var n=e.length-1;n>=0;n--){var i=e[n](t);if(i)return i}return function(a,o){throw new Error("Invalid value of type "+typeof t+" for "+r+" argument when connecting component "+o.wrappedComponentName+".")}}function el(t,e){return t===e}function tl(t){var e=t===void 0?{}:t,r=e.connectHOC,n=r===void 0?Ms:r,i=e.mapStateToPropsFactories,a=i===void 0?qs:i,o=e.mapDispatchToPropsFactories,l=o===void 0?Hs:o,c=e.mergePropsFactories,p=c===void 0?Zs:c,m=e.selectorFactory,u=m===void 0?Qs:m;return function(g,f,y,x){x===void 0&&(x={});var b=x,v=b.pure,h=v===void 0?!0:v,w=b.areStatesEqual,E=w===void 0?el:w,T=b.areOwnPropsEqual,I=T===void 0?$t:T,N=b.areStatePropsEqual,D=N===void 0?$t:N,O=b.areMergedPropsEqual,C=O===void 0?$t:O,M=ft(b,_s),k=Vt(g,a,"mapStateToProps"),W=Vt(f,l,"mapDispatchToProps"),Q=Vt(y,p,"mergeProps");return n(u,L({methodName:"connect",getDisplayName:function(ge){return"Connect("+ge+")"},shouldHandleStateChanges:!!g,initMapStateToProps:k,initMapDispatchToProps:W,initMergeProps:Q,pure:h,areStatesEqual:E,areOwnPropsEqual:I,areStatePropsEqual:D,areMergedPropsEqual:C},M))}}const _n=tl();ys(ii.unstable_batchedUpdates);function rl(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function ea(t,e){var r=S.useState(function(){return{inputs:e,result:t()}})[0],n=S.useRef(!0),i=S.useRef(r),a=n.current||!!(e&&i.current.inputs&&rl(e,i.current.inputs)),o=a?i.current:{inputs:e,result:t()};return S.useEffect(function(){n.current=!1,i.current=o},[o]),o.result}function nl(t,e){return ea(function(){return t},e)}var H=ea,A=nl,al="Invariant failed";function il(t,e){throw new Error(al)}var ue=function(e){var r=e.top,n=e.right,i=e.bottom,a=e.left,o=n-a,l=i-r,c={top:r,right:n,bottom:i,left:a,width:o,height:l,x:a,y:r,center:{x:(n+a)/2,y:(i+r)/2}};return c},gr=function(e,r){return{top:e.top-r.top,left:e.left-r.left,bottom:e.bottom+r.bottom,right:e.right+r.right}},nn=function(e,r){return{top:e.top+r.top,left:e.left+r.left,bottom:e.bottom-r.bottom,right:e.right-r.right}},ol=function(e,r){return{top:e.top+r.y,left:e.left+r.x,bottom:e.bottom+r.y,right:e.right+r.x}},Yt={top:0,right:0,bottom:0,left:0},fr=function(e){var r=e.borderBox,n=e.margin,i=n===void 0?Yt:n,a=e.border,o=a===void 0?Yt:a,l=e.padding,c=l===void 0?Yt:l,p=ue(gr(r,i)),m=ue(nn(r,o)),u=ue(nn(m,c));return{marginBox:p,borderBox:ue(r),paddingBox:m,contentBox:u,margin:i,border:o,padding:c}},oe=function(e){var r=e.slice(0,-2),n=e.slice(-2);if(n!=="px")return 0;var i=Number(r);return isNaN(i)&&il(),i},sl=function(){return{x:window.pageXOffset,y:window.pageYOffset}},xt=function(e,r){var n=e.borderBox,i=e.border,a=e.margin,o=e.padding,l=ol(n,r);return fr({borderBox:l,border:i,margin:a,padding:o})},bt=function(e,r){return r===void 0&&(r=sl()),xt(e,r)},ta=function(e,r){var n={top:oe(r.marginTop),right:oe(r.marginRight),bottom:oe(r.marginBottom),left:oe(r.marginLeft)},i={top:oe(r.paddingTop),right:oe(r.paddingRight),bottom:oe(r.paddingBottom),left:oe(r.paddingLeft)},a={top:oe(r.borderTopWidth),right:oe(r.borderRightWidth),bottom:oe(r.borderBottomWidth),left:oe(r.borderLeftWidth)};return fr({borderBox:e,margin:n,padding:i,border:a})},ra=function(e){var r=e.getBoundingClientRect(),n=window.getComputedStyle(e);return ta(r,n)},an=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function ll(t,e){return!!(t===e||an(t)&&an(e))}function cl(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!ll(t[r],e[r]))return!1;return!0}function Y(t,e){e===void 0&&(e=cl);var r,n=[],i,a=!1;function o(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return a&&r===this&&e(l,n)||(i=t.apply(this,l),a=!0,r=this,n=l),i}return o}var Qe=function(e){var r=[],n=null,i=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,e.apply(void 0,r)}))};return i.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},i};function na(t,e){}na.bind(null,"warn");na.bind(null,"error");function he(){}function ul(t,e){return L({},t,{},e)}function le(t,e,r){var n=e.map(function(i){var a=ul(r,i.options);return t.addEventListener(i.eventName,i.fn,a),function(){t.removeEventListener(i.eventName,i.fn,a)}});return function(){n.forEach(function(a){a()})}}var dl="Invariant failed";function yt(t){this.message=t}yt.prototype.toString=function(){return this.message};function P(t,e){throw new yt(dl)}var pl=function(t){zn(e,t);function e(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a))||this,n.callbacks=null,n.unbind=he,n.onWindowError=function(l){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var p=l.error;p instanceof yt&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=e.prototype;return r.componentDidMount=function(){this.unbind=le(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(i){if(i instanceof yt){this.setState({});return}throw i},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},e}($.Component),ml=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,wt=function(e){return e+1},gl=function(e){return`
  You have lifted an item in position `+wt(e.source.index)+`
`},aa=function(e,r){var n=e.droppableId===r.droppableId,i=wt(e.index),a=wt(r.index);return n?`
      You have moved the item from position `+i+`
      to position `+a+`
    `:`
    You have moved the item from position `+i+`
    in list `+e.droppableId+`
    to list `+r.droppableId+`
    in position `+a+`
  `},ia=function(e,r,n){var i=r.droppableId===n.droppableId;return i?`
      The item `+e+`
      has been combined with `+n.draggableId:`
      The item `+e+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},fl=function(e){var r=e.destination;if(r)return aa(e.source,r);var n=e.combine;return n?ia(e.draggableId,e.source,n):"You are over an area that cannot be dropped on"},on=function(e){return`
  The item has returned to its starting position
  of `+wt(e.index)+`
`},vl=function(e){if(e.reason==="CANCEL")return`
      Movement cancelled.
      `+on(e.source)+`
    `;var r=e.destination,n=e.combine;return r?`
      You have dropped the item.
      `+aa(e.source,r)+`
    `:n?`
      You have dropped the item.
      `+ia(e.draggableId,e.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+on(e.source)+`
  `},pt={dragHandleUsageInstructions:ml,onDragStart:gl,onDragUpdate:fl,onDragEnd:vl},z={x:0,y:0},Z=function(e,r){return{x:e.x+r.x,y:e.y+r.y}},re=function(e,r){return{x:e.x-r.x,y:e.y-r.y}},xe=function(e,r){return e.x===r.x&&e.y===r.y},Le=function(e){return{x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}},je=function(e,r,n){var i;return n===void 0&&(n=0),i={},i[e]=r,i[e==="x"?"y":"x"]=n,i},_e=function(e,r){return Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2))},sn=function(e,r){return Math.min.apply(Math,r.map(function(n){return _e(e,n)}))},oa=function(e){return function(r){return{x:e(r.x),y:e(r.y)}}},hl=function(t,e){var r=ue({top:Math.max(e.top,t.top),right:Math.min(e.right,t.right),bottom:Math.min(e.bottom,t.bottom),left:Math.max(e.left,t.left)});return r.width<=0||r.height<=0?null:r},at=function(e,r){return{top:e.top+r.y,left:e.left+r.x,bottom:e.bottom+r.y,right:e.right+r.x}},ln=function(e){return[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}]},xl={top:0,right:0,bottom:0,left:0},bl=function(e,r){return r?at(e,r.scroll.diff.displacement):e},yl=function(e,r,n){if(n&&n.increasedBy){var i;return L({},e,(i={},i[r.end]=e[r.end]+n.increasedBy[r.line],i))}return e},wl=function(e,r){return r&&r.shouldClipSubject?hl(r.pageMarginBox,e):ue(e)},Ae=function(t){var e=t.page,r=t.withPlaceholder,n=t.axis,i=t.frame,a=bl(e.marginBox,i),o=yl(a,n,r),l=wl(o,i);return{page:e,withPlaceholder:r,active:l}},vr=function(t,e){t.frame||P();var r=t.frame,n=re(e,r.scroll.initial),i=Le(n),a=L({},r,{scroll:{initial:r.scroll.initial,current:e,diff:{value:n,displacement:i},max:r.scroll.max}}),o=Ae({page:t.subject.page,withPlaceholder:t.subject.withPlaceholder,axis:t.axis,frame:a}),l=L({},t,{frame:a,subject:o});return l};function St(t){return Object.values?Object.values(t):Object.keys(t).map(function(e){return t[e]})}function hr(t,e){if(t.findIndex)return t.findIndex(e);for(var r=0;r<t.length;r++)if(e(t[r]))return r;return-1}function Se(t,e){if(t.find)return t.find(e);var r=hr(t,e);if(r!==-1)return t[r]}function sa(t){return Array.prototype.slice.call(t)}var la=Y(function(t){return t.reduce(function(e,r){return e[r.descriptor.id]=r,e},{})}),ca=Y(function(t){return t.reduce(function(e,r){return e[r.descriptor.id]=r,e},{})}),kt=Y(function(t){return St(t)}),Sl=Y(function(t){return St(t)}),Be=Y(function(t,e){var r=Sl(e).filter(function(n){return t===n.descriptor.droppableId}).sort(function(n,i){return n.descriptor.index-i.descriptor.index});return r});function xr(t){return t.at&&t.at.type==="REORDER"?t.at.destination:null}function Tt(t){return t.at&&t.at.type==="COMBINE"?t.at.combine:null}var Pt=Y(function(t,e){return e.filter(function(r){return r.descriptor.id!==t.descriptor.id})}),Nl=function(t){var e=t.isMovingForward,r=t.draggable,n=t.destination,i=t.insideDestination,a=t.previousImpact;if(!n.isCombineEnabled)return null;var o=xr(a);if(!o)return null;function l(y){var x={type:"COMBINE",combine:{draggableId:y,droppableId:n.descriptor.id}};return L({},a,{at:x})}var c=a.displaced.all,p=c.length?c[0]:null;if(e)return p?l(p):null;var m=Pt(r,i);if(!p){if(!m.length)return null;var u=m[m.length-1];return l(u.descriptor.id)}var d=hr(m,function(y){return y.descriptor.id===p});d===-1&&P();var g=d-1;if(g<0)return null;var f=m[g];return l(f.descriptor.id)},Fe=function(t,e){return t.descriptor.droppableId===e.descriptor.id},ua={point:z,value:0},et={invisible:{},visible:{},all:[]},Cl={displaced:et,displacedBy:ua,at:null},ce=function(t,e){return function(r){return t<=r&&r<=e}},da=function(t){var e=ce(t.top,t.bottom),r=ce(t.left,t.right);return function(n){var i=e(n.top)&&e(n.bottom)&&r(n.left)&&r(n.right);if(i)return!0;var a=e(n.top)||e(n.bottom),o=r(n.left)||r(n.right),l=a&&o;if(l)return!0;var c=n.top<t.top&&n.bottom>t.bottom,p=n.left<t.left&&n.right>t.right,m=c&&p;if(m)return!0;var u=c&&o||p&&a;return u}},Dl=function(t){var e=ce(t.top,t.bottom),r=ce(t.left,t.right);return function(n){var i=e(n.top)&&e(n.bottom)&&r(n.left)&&r(n.right);return i}},br={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},pa={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},El=function(t){return function(e){var r=ce(e.top,e.bottom),n=ce(e.left,e.right);return function(i){return t===br?r(i.top)&&r(i.bottom):n(i.left)&&n(i.right)}}},jl=function(e,r){var n=r.frame?r.frame.scroll.diff.displacement:z;return at(e,n)},Il=function(e,r,n){return r.subject.active?n(r.subject.active)(e):!1},kl=function(e,r,n){return n(r)(e)},yr=function(e){var r=e.target,n=e.destination,i=e.viewport,a=e.withDroppableDisplacement,o=e.isVisibleThroughFrameFn,l=a?jl(r,n):r;return Il(l,n,o)&&kl(l,i,o)},Tl=function(e){return yr(L({},e,{isVisibleThroughFrameFn:da}))},ma=function(e){return yr(L({},e,{isVisibleThroughFrameFn:Dl}))},Pl=function(e){return yr(L({},e,{isVisibleThroughFrameFn:El(e.destination.axis)}))},Rl=function(e,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var i=r.invisible,a=r.visible;if(i[e])return!1;var o=a[e];return o?o.shouldAnimate:!0};function Al(t,e){var r=t.page.marginBox,n={top:e.point.y,right:0,bottom:0,left:e.point.x};return ue(gr(r,n))}function tt(t){var e=t.afterDragging,r=t.destination,n=t.displacedBy,i=t.viewport,a=t.forceShouldAnimate,o=t.last;return e.reduce(function(c,p){var m=Al(p,n),u=p.descriptor.id;c.all.push(u);var d=Tl({target:m,destination:r,viewport:i,withDroppableDisplacement:!0});if(!d)return c.invisible[p.descriptor.id]=!0,c;var g=Rl(u,o,a),f={draggableId:u,shouldAnimate:g};return c.visible[u]=f,c},{all:[],visible:{},invisible:{}})}function Ol(t,e){if(!t.length)return 0;var r=t[t.length-1].descriptor.index;return e.inHomeList?r:r+1}function cn(t){var e=t.insideDestination,r=t.inHomeList,n=t.displacedBy,i=t.destination,a=Ol(e,{inHomeList:r});return{displaced:et,displacedBy:n,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:a}}}}function Nt(t){var e=t.draggable,r=t.insideDestination,n=t.destination,i=t.viewport,a=t.displacedBy,o=t.last,l=t.index,c=t.forceShouldAnimate,p=Fe(e,n);if(l==null)return cn({insideDestination:r,inHomeList:p,displacedBy:a,destination:n});var m=Se(r,function(y){return y.descriptor.index===l});if(!m)return cn({insideDestination:r,inHomeList:p,displacedBy:a,destination:n});var u=Pt(e,r),d=r.indexOf(m),g=u.slice(d),f=tt({afterDragging:g,destination:n,displacedBy:a,last:o,viewport:i.frame,forceShouldAnimate:c});return{displaced:f,displacedBy:a,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function we(t,e){return!!e.effected[t]}var Ml=function(t){var e=t.isMovingForward,r=t.destination,n=t.draggables,i=t.combine,a=t.afterCritical;if(!r.isCombineEnabled)return null;var o=i.draggableId,l=n[o],c=l.descriptor.index,p=we(o,a);return p?e?c:c-1:e?c+1:c},Ll=function(t){var e=t.isMovingForward,r=t.isInHomeList,n=t.insideDestination,i=t.location;if(!n.length)return null;var a=i.index,o=e?a+1:a-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,p=r?c:c+1;return o<l||o>p?null:o},Bl=function(t){var e=t.isMovingForward,r=t.isInHomeList,n=t.draggable,i=t.draggables,a=t.destination,o=t.insideDestination,l=t.previousImpact,c=t.viewport,p=t.afterCritical,m=l.at;if(m||P(),m.type==="REORDER"){var u=Ll({isMovingForward:e,isInHomeList:r,location:m.destination,insideDestination:o});return u==null?null:Nt({draggable:n,insideDestination:o,destination:a,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:u})}var d=Ml({isMovingForward:e,destination:a,displaced:l.displaced,draggables:i,combine:m.combine,afterCritical:p});return d==null?null:Nt({draggable:n,insideDestination:o,destination:a,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:d})},Fl=function(t){var e=t.displaced,r=t.afterCritical,n=t.combineWith,i=t.displacedBy,a=!!(e.visible[n]||e.invisible[n]);return we(n,r)?a?z:Le(i.point):a?i.point:z},Wl=function(t){var e=t.afterCritical,r=t.impact,n=t.draggables,i=Tt(r);i||P();var a=i.draggableId,o=n[a].page.borderBox.center,l=Fl({displaced:r.displaced,afterCritical:e,combineWith:a,displacedBy:r.displacedBy});return Z(o,l)},ga=function(e,r){return r.margin[e.start]+r.borderBox[e.size]/2},Hl=function(e,r){return r.margin[e.end]+r.borderBox[e.size]/2},wr=function(e,r,n){return r[e.crossAxisStart]+n.margin[e.crossAxisStart]+n.borderBox[e.crossAxisSize]/2},un=function(e){var r=e.axis,n=e.moveRelativeTo,i=e.isMoving;return je(r.line,n.marginBox[r.end]+ga(r,i),wr(r,n.marginBox,i))},dn=function(e){var r=e.axis,n=e.moveRelativeTo,i=e.isMoving;return je(r.line,n.marginBox[r.start]-Hl(r,i),wr(r,n.marginBox,i))},Ul=function(e){var r=e.axis,n=e.moveInto,i=e.isMoving;return je(r.line,n.contentBox[r.start]+ga(r,i),wr(r,n.contentBox,i))},Gl=function(t){var e=t.impact,r=t.draggable,n=t.draggables,i=t.droppable,a=t.afterCritical,o=Be(i.descriptor.id,n),l=r.page,c=i.axis;if(!o.length)return Ul({axis:c,moveInto:i.page,isMoving:l});var p=e.displaced,m=e.displacedBy,u=p.all[0];if(u){var d=n[u];if(we(u,a))return dn({axis:c,moveRelativeTo:d.page,isMoving:l});var g=xt(d.page,m.point);return dn({axis:c,moveRelativeTo:g,isMoving:l})}var f=o[o.length-1];if(f.descriptor.id===r.descriptor.id)return l.borderBox.center;if(we(f.descriptor.id,a)){var y=xt(f.page,Le(a.displacedBy.point));return un({axis:c,moveRelativeTo:y,isMoving:l})}return un({axis:c,moveRelativeTo:f.page,isMoving:l})},ir=function(t,e){var r=t.frame;return r?Z(e,r.scroll.diff.displacement):e},ql=function(e){var r=e.impact,n=e.draggable,i=e.droppable,a=e.draggables,o=e.afterCritical,l=n.page.borderBox.center,c=r.at;return!i||!c?l:c.type==="REORDER"?Gl({impact:r,draggable:n,draggables:a,droppable:i,afterCritical:o}):Wl({impact:r,draggables:a,afterCritical:o})},Rt=function(t){var e=ql(t),r=t.droppable,n=r?ir(r,e):e;return n},fa=function(t,e){var r=re(e,t.scroll.initial),n=Le(r),i=ue({top:e.y,bottom:e.y+t.frame.height,left:e.x,right:e.x+t.frame.width}),a={frame:i,scroll:{initial:t.scroll.initial,max:t.scroll.max,current:e,diff:{value:r,displacement:n}}};return a};function pn(t,e){return t.map(function(r){return e[r]})}function $l(t,e){for(var r=0;r<e.length;r++){var n=e[r].visible[t];if(n)return n}return null}var Vl=function(t){var e=t.impact,r=t.viewport,n=t.destination,i=t.draggables,a=t.maxScrollChange,o=fa(r,Z(r.scroll.current,a)),l=n.frame?vr(n,Z(n.frame.scroll.current,a)):n,c=e.displaced,p=tt({afterDragging:pn(c.all,i),destination:n,displacedBy:e.displacedBy,viewport:o.frame,last:c,forceShouldAnimate:!1}),m=tt({afterDragging:pn(c.all,i),destination:l,displacedBy:e.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),u={},d={},g=[c,p,m];c.all.forEach(function(y){var x=$l(y,g);if(x){d[y]=x;return}u[y]=!0});var f=L({},e,{displaced:{all:c.all,invisible:u,visible:d}});return f},Yl=function(t,e){return Z(t.scroll.diff.displacement,e)},Sr=function(t){var e=t.pageBorderBoxCenter,r=t.draggable,n=t.viewport,i=Yl(n,e),a=re(i,r.page.borderBox.center);return Z(r.client.borderBox.center,a)},va=function(t){var e=t.draggable,r=t.destination,n=t.newPageBorderBoxCenter,i=t.viewport,a=t.withDroppableDisplacement,o=t.onlyOnMainAxis,l=o===void 0?!1:o,c=re(n,e.page.borderBox.center),p=at(e.page.borderBox,c),m={target:p,destination:r,withDroppableDisplacement:a,viewport:i};return l?Pl(m):ma(m)},zl=function(t){var e=t.isMovingForward,r=t.draggable,n=t.destination,i=t.draggables,a=t.previousImpact,o=t.viewport,l=t.previousPageBorderBoxCenter,c=t.previousClientSelection,p=t.afterCritical;if(!n.isEnabled)return null;var m=Be(n.descriptor.id,i),u=Fe(r,n),d=Nl({isMovingForward:e,draggable:r,destination:n,insideDestination:m,previousImpact:a})||Bl({isMovingForward:e,isInHomeList:u,draggable:r,draggables:i,destination:n,insideDestination:m,previousImpact:a,viewport:o,afterCritical:p});if(!d)return null;var g=Rt({impact:d,draggable:r,droppable:n,draggables:i,afterCritical:p}),f=va({draggable:r,destination:n,newPageBorderBoxCenter:g,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(f){var y=Sr({pageBorderBoxCenter:g,draggable:r,viewport:o});return{clientSelection:y,impact:d,scrollJumpRequest:null}}var x=re(g,l),b=Vl({impact:d,viewport:o,destination:n,draggables:i,maxScrollChange:x});return{clientSelection:c,impact:b,scrollJumpRequest:x}},X=function(e){var r=e.subject.active;return r||P(),r},Zl=function(t){var e=t.isMovingForward,r=t.pageBorderBoxCenter,n=t.source,i=t.droppables,a=t.viewport,o=n.subject.active;if(!o)return null;var l=n.axis,c=ce(o[l.start],o[l.end]),p=kt(i).filter(function(u){return u!==n}).filter(function(u){return u.isEnabled}).filter(function(u){return!!u.subject.active}).filter(function(u){return da(a.frame)(X(u))}).filter(function(u){var d=X(u);return e?o[l.crossAxisEnd]<d[l.crossAxisEnd]:d[l.crossAxisStart]<o[l.crossAxisStart]}).filter(function(u){var d=X(u),g=ce(d[l.start],d[l.end]);return c(d[l.start])||c(d[l.end])||g(o[l.start])||g(o[l.end])}).sort(function(u,d){var g=X(u)[l.crossAxisStart],f=X(d)[l.crossAxisStart];return e?g-f:f-g}).filter(function(u,d,g){return X(u)[l.crossAxisStart]===X(g[0])[l.crossAxisStart]});if(!p.length)return null;if(p.length===1)return p[0];var m=p.filter(function(u){var d=ce(X(u)[l.start],X(u)[l.end]);return d(r[l.line])});return m.length===1?m[0]:m.length>1?m.sort(function(u,d){return X(u)[l.start]-X(d)[l.start]})[0]:p.sort(function(u,d){var g=sn(r,ln(X(u))),f=sn(r,ln(X(d)));return g!==f?g-f:X(u)[l.start]-X(d)[l.start]})[0]},mn=function(e,r){var n=e.page.borderBox.center;return we(e.descriptor.id,r)?re(n,r.displacedBy.point):n},Jl=function(e,r){var n=e.page.borderBox;return we(e.descriptor.id,r)?at(n,Le(r.displacedBy.point)):n},Xl=function(t){var e=t.pageBorderBoxCenter,r=t.viewport,n=t.destination,i=t.insideDestination,a=t.afterCritical,o=i.filter(function(l){return ma({target:Jl(l,a),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,c){var p=_e(e,ir(n,mn(l,a))),m=_e(e,ir(n,mn(c,a)));return p<m?-1:m<p?1:l.descriptor.index-c.descriptor.index});return o[0]||null},it=Y(function(e,r){var n=r[e.line];return{value:n,point:je(e.line,n)}}),Kl=function(e,r,n){var i=e.axis;if(e.descriptor.mode==="virtual")return je(i.line,r[i.line]);var a=e.subject.page.contentBox[i.size],o=Be(e.descriptor.id,n),l=o.reduce(function(m,u){return m+u.client.marginBox[i.size]},0),c=l+r[i.line],p=c-a;return p<=0?null:je(i.line,p)},ha=function(e,r){return L({},e,{scroll:L({},e.scroll,{max:r})})},xa=function(e,r,n){var i=e.frame;Fe(r,e)&&P(),e.subject.withPlaceholder&&P();var a=it(e.axis,r.displaceBy).point,o=Kl(e,a,n),l={placeholderSize:a,increasedBy:o,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!i){var c=Ae({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:e.frame});return L({},e,{subject:c})}var p=o?Z(i.scroll.max,o):i.scroll.max,m=ha(i,p),u=Ae({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:m});return L({},e,{subject:u,frame:m})},Ql=function(e){var r=e.subject.withPlaceholder;r||P();var n=e.frame;if(!n){var i=Ae({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return L({},e,{subject:i})}var a=r.oldFrameMaxScroll;a||P();var o=ha(n,a),l=Ae({page:e.subject.page,axis:e.axis,frame:o,withPlaceholder:null});return L({},e,{subject:l,frame:o})},_l=function(t){var e=t.previousPageBorderBoxCenter,r=t.moveRelativeTo,n=t.insideDestination,i=t.draggable,a=t.draggables,o=t.destination,l=t.viewport,c=t.afterCritical;if(!r){if(n.length)return null;var p={displaced:et,displacedBy:ua,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},m=Rt({impact:p,draggable:i,droppable:o,draggables:a,afterCritical:c}),u=Fe(i,o)?o:xa(o,i,a),d=va({draggable:i,destination:u,newPageBorderBoxCenter:m,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return d?p:null}var g=e[o.axis.line]<=r.page.borderBox.center[o.axis.line],f=function(){var x=r.descriptor.index;return r.descriptor.id===i.descriptor.id||g?x:x+1}(),y=it(o.axis,i.displaceBy);return Nt({draggable:i,insideDestination:n,destination:o,viewport:l,displacedBy:y,last:et,index:f})},ec=function(t){var e=t.isMovingForward,r=t.previousPageBorderBoxCenter,n=t.draggable,i=t.isOver,a=t.draggables,o=t.droppables,l=t.viewport,c=t.afterCritical,p=Zl({isMovingForward:e,pageBorderBoxCenter:r,source:i,droppables:o,viewport:l});if(!p)return null;var m=Be(p.descriptor.id,a),u=Xl({pageBorderBoxCenter:r,viewport:l,destination:p,insideDestination:m,afterCritical:c}),d=_l({previousPageBorderBoxCenter:r,destination:p,draggable:n,draggables:a,moveRelativeTo:u,insideDestination:m,viewport:l,afterCritical:c});if(!d)return null;var g=Rt({impact:d,draggable:n,droppable:p,draggables:a,afterCritical:c}),f=Sr({pageBorderBoxCenter:g,draggable:n,viewport:l});return{clientSelection:f,impact:d,scrollJumpRequest:null}},ne=function(t){var e=t.at;return e?e.type==="REORDER"?e.destination.droppableId:e.combine.droppableId:null},tc=function(e,r){var n=ne(e);return n?r[n]:null},rc=function(t){var e=t.state,r=t.type,n=tc(e.impact,e.dimensions.droppables),i=!!n,a=e.dimensions.droppables[e.critical.droppable.id],o=n||a,l=o.axis.direction,c=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!i)return null;var p=r==="MOVE_DOWN"||r==="MOVE_RIGHT",m=e.dimensions.draggables[e.critical.draggable.id],u=e.current.page.borderBoxCenter,d=e.dimensions,g=d.draggables,f=d.droppables;return c?zl({isMovingForward:p,previousPageBorderBoxCenter:u,draggable:m,destination:o,draggables:g,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):ec({isMovingForward:p,previousPageBorderBoxCenter:u,draggable:m,isOver:o,draggables:g,droppables:f,viewport:e.viewport,afterCritical:e.afterCritical})};function De(t){return t.phase==="DRAGGING"||t.phase==="COLLECTING"}function ba(t){var e=ce(t.top,t.bottom),r=ce(t.left,t.right);return function(i){return e(i.y)&&r(i.x)}}function nc(t,e){return t.left<e.right&&t.right>e.left&&t.top<e.bottom&&t.bottom>e.top}function ac(t){var e=t.pageBorderBox,r=t.draggable,n=t.candidates,i=r.page.borderBox.center,a=n.map(function(o){var l=o.axis,c=je(o.axis.line,e.center[l.line],o.page.borderBox.center[l.crossAxisLine]);return{id:o.descriptor.id,distance:_e(i,c)}}).sort(function(o,l){return l.distance-o.distance});return a[0]?a[0].id:null}function ic(t){var e=t.pageBorderBox,r=t.draggable,n=t.droppables,i=kt(n).filter(function(a){if(!a.isEnabled)return!1;var o=a.subject.active;if(!o||!nc(e,o))return!1;if(ba(o)(e.center))return!0;var l=a.axis,c=o.center[l.crossAxisLine],p=e[l.crossAxisStart],m=e[l.crossAxisEnd],u=ce(o[l.crossAxisStart],o[l.crossAxisEnd]),d=u(p),g=u(m);return!d&&!g?!0:d?p<c:m>c});return i.length?i.length===1?i[0].descriptor.id:ac({pageBorderBox:e,draggable:r,candidates:i}):null}var ya=function(e,r){return ue(at(e,r))},oc=function(t,e){var r=t.frame;return r?ya(e,r.scroll.diff.value):e};function wa(t){var e=t.displaced,r=t.id;return!!(e.visible[r]||e.invisible[r])}function sc(t){var e=t.draggable,r=t.closest,n=t.inHomeList;return r?n&&r.descriptor.index>e.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var lc=function(t){var e=t.pageBorderBoxWithDroppableScroll,r=t.draggable,n=t.destination,i=t.insideDestination,a=t.last,o=t.viewport,l=t.afterCritical,c=n.axis,p=it(n.axis,r.displaceBy),m=p.value,u=e[c.start],d=e[c.end],g=Pt(r,i),f=Se(g,function(x){var b=x.descriptor.id,v=x.page.borderBox.center[c.line],h=we(b,l),w=wa({displaced:a,id:b});return h?w?d<=v:u<v-m:w?d<=v+m:u<v}),y=sc({draggable:r,closest:f,inHomeList:Fe(r,n)});return Nt({draggable:r,insideDestination:i,destination:n,viewport:o,last:a,displacedBy:p,index:y})},cc=4,uc=function(t){var e=t.draggable,r=t.pageBorderBoxWithDroppableScroll,n=t.previousImpact,i=t.destination,a=t.insideDestination,o=t.afterCritical;if(!i.isCombineEnabled)return null;var l=i.axis,c=it(i.axis,e.displaceBy),p=c.value,m=r[l.start],u=r[l.end],d=Pt(e,a),g=Se(d,function(y){var x=y.descriptor.id,b=y.page.borderBox,v=b[l.size],h=v/cc,w=we(x,o),E=wa({displaced:n.displaced,id:x});return w?E?u>b[l.start]+h&&u<b[l.end]-h:m>b[l.start]-p+h&&m<b[l.end]-p-h:E?u>b[l.start]+p+h&&u<b[l.end]+p-h:m>b[l.start]+h&&m<b[l.end]-h});if(!g)return null;var f={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:g.descriptor.id,droppableId:i.descriptor.id}}};return f},Sa=function(t){var e=t.pageOffset,r=t.draggable,n=t.draggables,i=t.droppables,a=t.previousImpact,o=t.viewport,l=t.afterCritical,c=ya(r.page.borderBox,e),p=ic({pageBorderBox:c,draggable:r,droppables:i});if(!p)return Cl;var m=i[p],u=Be(m.descriptor.id,n),d=oc(m,c);return uc({pageBorderBoxWithDroppableScroll:d,draggable:r,previousImpact:a,destination:m,insideDestination:u,afterCritical:l})||lc({pageBorderBoxWithDroppableScroll:d,draggable:r,destination:m,insideDestination:u,last:a.displaced,viewport:o,afterCritical:l})},Nr=function(t,e){var r;return L({},t,(r={},r[e.descriptor.id]=e,r))},dc=function(e){var r=e.previousImpact,n=e.impact,i=e.droppables,a=ne(r),o=ne(n);if(!a||a===o)return i;var l=i[a];if(!l.subject.withPlaceholder)return i;var c=Ql(l);return Nr(i,c)},pc=function(t){var e=t.draggable,r=t.draggables,n=t.droppables,i=t.previousImpact,a=t.impact,o=dc({previousImpact:i,impact:a,droppables:n}),l=ne(a);if(!l)return o;var c=n[l];if(Fe(e,c)||c.subject.withPlaceholder)return o;var p=xa(c,e,r);return Nr(o,p)},Je=function(t){var e=t.state,r=t.clientSelection,n=t.dimensions,i=t.viewport,a=t.impact,o=t.scrollJumpRequest,l=i||e.viewport,c=n||e.dimensions,p=r||e.current.client.selection,m=re(p,e.initial.client.selection),u={offset:m,selection:p,borderBoxCenter:Z(e.initial.client.borderBoxCenter,m)},d={selection:Z(u.selection,l.scroll.current),borderBoxCenter:Z(u.borderBoxCenter,l.scroll.current),offset:Z(u.offset,l.scroll.diff.value)},g={client:u,page:d};if(e.phase==="COLLECTING")return L({phase:"COLLECTING"},e,{dimensions:c,viewport:l,current:g});var f=c.draggables[e.critical.draggable.id],y=a||Sa({pageOffset:d.offset,draggable:f,draggables:c.draggables,droppables:c.droppables,previousImpact:e.impact,viewport:l,afterCritical:e.afterCritical}),x=pc({draggable:f,impact:y,previousImpact:e.impact,draggables:c.draggables,droppables:c.droppables}),b=L({},e,{current:g,dimensions:{draggables:c.draggables,droppables:x},impact:y,viewport:l,scrollJumpRequest:o||null,forceShouldAnimate:o?!1:null});return b};function mc(t,e){return t.map(function(r){return e[r]})}var Na=function(t){var e=t.impact,r=t.viewport,n=t.draggables,i=t.destination,a=t.forceShouldAnimate,o=e.displaced,l=mc(o.all,n),c=tt({afterDragging:l,destination:i,displacedBy:e.displacedBy,viewport:r.frame,forceShouldAnimate:a,last:o});return L({},e,{displaced:c})},Ca=function(t){var e=t.impact,r=t.draggable,n=t.droppable,i=t.draggables,a=t.viewport,o=t.afterCritical,l=Rt({impact:e,draggable:r,draggables:i,droppable:n,afterCritical:o});return Sr({pageBorderBoxCenter:l,draggable:r,viewport:a})},Da=function(t){var e=t.state,r=t.dimensions,n=t.viewport;e.movementMode!=="SNAP"&&P();var i=e.impact,a=n||e.viewport,o=r||e.dimensions,l=o.draggables,c=o.droppables,p=l[e.critical.draggable.id],m=ne(i);m||P();var u=c[m],d=Na({impact:i,viewport:a,destination:u,draggables:l}),g=Ca({impact:d,draggable:p,droppable:u,draggables:l,viewport:a,afterCritical:e.afterCritical});return Je({impact:d,clientSelection:g,state:e,dimensions:o,viewport:a})},gc=function(t){return{index:t.index,droppableId:t.droppableId}},Ea=function(t){var e=t.draggable,r=t.home,n=t.draggables,i=t.viewport,a=it(r.axis,e.displaceBy),o=Be(r.descriptor.id,n),l=o.indexOf(e);l===-1&&P();var c=o.slice(l+1),p=c.reduce(function(g,f){return g[f.descriptor.id]=!0,g},{}),m={inVirtualList:r.descriptor.mode==="virtual",displacedBy:a,effected:p},u=tt({afterDragging:c,destination:r,displacedBy:a,last:null,viewport:i.frame,forceShouldAnimate:!1}),d={displaced:u,displacedBy:a,at:{type:"REORDER",destination:gc(e.descriptor)}};return{impact:d,afterCritical:m}},fc=function(t,e){return{draggables:t.draggables,droppables:Nr(t.droppables,e)}},vc=function(t){var e=t.draggable,r=t.offset,n=t.initialWindowScroll,i=xt(e.client,r),a=bt(i,n),o=L({},e,{placeholder:L({},e.placeholder,{client:i}),client:i,page:a});return o},hc=function(t){var e=t.frame;return e||P(),e},xc=function(t){var e=t.additions,r=t.updatedDroppables,n=t.viewport,i=n.scroll.diff.value;return e.map(function(a){var o=a.descriptor.droppableId,l=r[o],c=hc(l),p=c.scroll.diff.value,m=Z(i,p),u=vc({draggable:a,offset:m,initialWindowScroll:n.scroll.initial});return u})},bc=function(t){var e=t.state,r=t.published,n=r.modified.map(function(h){var w=e.dimensions.droppables[h.droppableId],E=vr(w,h.scroll);return E}),i=L({},e.dimensions.droppables,{},la(n)),a=ca(xc({additions:r.additions,updatedDroppables:i,viewport:e.viewport})),o=L({},e.dimensions.draggables,{},a);r.removals.forEach(function(h){delete o[h]});var l={droppables:i,draggables:o},c=ne(e.impact),p=c?l.droppables[c]:null,m=l.draggables[e.critical.draggable.id],u=l.droppables[e.critical.droppable.id],d=Ea({draggable:m,home:u,draggables:o,viewport:e.viewport}),g=d.impact,f=d.afterCritical,y=p&&p.isCombineEnabled?e.impact:g,x=Sa({pageOffset:e.current.page.offset,draggable:l.draggables[e.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:y,viewport:e.viewport,afterCritical:f}),b=L({phase:"DRAGGING"},e,{phase:"DRAGGING",impact:x,onLiftImpact:g,dimensions:l,afterCritical:f,forceShouldAnimate:!1});if(e.phase==="COLLECTING")return b;var v=L({phase:"DROP_PENDING"},b,{phase:"DROP_PENDING",reason:e.reason,isWaiting:!1});return v},or=function(e){return e.movementMode==="SNAP"},zt=function(e,r,n){var i=fc(e.dimensions,r);return!or(e)||n?Je({state:e,dimensions:i}):Da({state:e,dimensions:i})};function Zt(t){return t.isDragging&&t.movementMode==="SNAP"?L({phase:"DRAGGING"},t,{scrollJumpRequest:null}):t}var gn={phase:"IDLE",completed:null,shouldFlush:!1},yc=function(t,e){if(t===void 0&&(t=gn),e.type==="FLUSH")return L({},gn,{shouldFlush:!0});if(e.type==="INITIAL_PUBLISH"){t.phase!=="IDLE"&&P();var r=e.payload,n=r.critical,i=r.clientSelection,a=r.viewport,o=r.dimensions,l=r.movementMode,c=o.draggables[n.draggable.id],p=o.droppables[n.droppable.id],m={selection:i,borderBoxCenter:c.client.borderBox.center,offset:z},u={client:m,page:{selection:Z(m.selection,a.scroll.initial),borderBoxCenter:Z(m.selection,a.scroll.initial),offset:Z(m.selection,a.scroll.diff.value)}},d=kt(o.droppables).every(function(te){return!te.isFixedOnPage}),g=Ea({draggable:c,home:p,draggables:o.draggables,viewport:a}),f=g.impact,y=g.afterCritical,x={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:o,initial:u,current:u,isWindowScrollAllowed:d,impact:f,afterCritical:y,onLiftImpact:f,viewport:a,scrollJumpRequest:null,forceShouldAnimate:null};return x}if(e.type==="COLLECTION_STARTING"){if(t.phase==="COLLECTING"||t.phase==="DROP_PENDING")return t;t.phase!=="DRAGGING"&&P();var b=L({phase:"COLLECTING"},t,{phase:"COLLECTING"});return b}if(e.type==="PUBLISH_WHILE_DRAGGING")return t.phase==="COLLECTING"||t.phase==="DROP_PENDING"||P(),bc({state:t,published:e.payload});if(e.type==="MOVE"){if(t.phase==="DROP_PENDING")return t;De(t)||P();var v=e.payload.client;return xe(v,t.current.client.selection)?t:Je({state:t,clientSelection:v,impact:or(t)?t.impact:null})}if(e.type==="UPDATE_DROPPABLE_SCROLL"){if(t.phase==="DROP_PENDING"||t.phase==="COLLECTING")return Zt(t);De(t)||P();var h=e.payload,w=h.id,E=h.newScroll,T=t.dimensions.droppables[w];if(!T)return t;var I=vr(T,E);return zt(t,I,!1)}if(e.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(t.phase==="DROP_PENDING")return t;De(t)||P();var N=e.payload,D=N.id,O=N.isEnabled,C=t.dimensions.droppables[D];C||P(),C.isEnabled===O&&P();var M=L({},C,{isEnabled:O});return zt(t,M,!0)}if(e.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(t.phase==="DROP_PENDING")return t;De(t)||P();var k=e.payload,W=k.id,Q=k.isCombineEnabled,_=t.dimensions.droppables[W];_||P(),_.isCombineEnabled===Q&&P();var ge=L({},_,{isCombineEnabled:Q});return zt(t,ge,!0)}if(e.type==="MOVE_BY_WINDOW_SCROLL"){if(t.phase==="DROP_PENDING"||t.phase==="DROP_ANIMATING")return t;De(t)||P(),t.isWindowScrollAllowed||P();var R=e.payload.newScroll;if(xe(t.viewport.scroll.current,R))return Zt(t);var B=fa(t.viewport,R);return or(t)?Da({state:t,viewport:B}):Je({state:t,viewport:B})}if(e.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!De(t))return t;var F=e.payload.maxScroll;if(xe(F,t.viewport.scroll.max))return t;var q=L({},t.viewport,{scroll:L({},t.viewport.scroll,{max:F})});return L({phase:"DRAGGING"},t,{viewport:q})}if(e.type==="MOVE_UP"||e.type==="MOVE_DOWN"||e.type==="MOVE_LEFT"||e.type==="MOVE_RIGHT"){if(t.phase==="COLLECTING"||t.phase==="DROP_PENDING")return t;t.phase!=="DRAGGING"&&P();var V=rc({state:t,type:e.type});return V?Je({state:t,impact:V.impact,clientSelection:V.clientSelection,scrollJumpRequest:V.scrollJumpRequest}):t}if(e.type==="DROP_PENDING"){var J=e.payload.reason;t.phase!=="COLLECTING"&&P();var de=L({phase:"DROP_PENDING"},t,{phase:"DROP_PENDING",isWaiting:!0,reason:J});return de}if(e.type==="DROP_ANIMATE"){var ie=e.payload,We=ie.completed,He=ie.dropDuration,ke=ie.newHomeClientOffset;t.phase==="DRAGGING"||t.phase==="DROP_PENDING"||P();var Te={phase:"DROP_ANIMATING",completed:We,dropDuration:He,newHomeClientOffset:ke,dimensions:t.dimensions};return Te}if(e.type==="DROP_COMPLETE"){var ee=e.payload.completed;return{phase:"IDLE",completed:ee,shouldFlush:!1}}return t},wc=function(e){return{type:"BEFORE_INITIAL_CAPTURE",payload:e}},Sc=function(e){return{type:"LIFT",payload:e}},Nc=function(e){return{type:"INITIAL_PUBLISH",payload:e}},Cc=function(e){return{type:"PUBLISH_WHILE_DRAGGING",payload:e}},Dc=function(){return{type:"COLLECTION_STARTING",payload:null}},Ec=function(e){return{type:"UPDATE_DROPPABLE_SCROLL",payload:e}},jc=function(e){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}},Ic=function(e){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}},ja=function(e){return{type:"MOVE",payload:e}},kc=function(e){return{type:"MOVE_BY_WINDOW_SCROLL",payload:e}},Tc=function(e){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}},Pc=function(){return{type:"MOVE_UP",payload:null}},Rc=function(){return{type:"MOVE_DOWN",payload:null}},Ac=function(){return{type:"MOVE_RIGHT",payload:null}},Oc=function(){return{type:"MOVE_LEFT",payload:null}},Cr=function(){return{type:"FLUSH",payload:null}},Mc=function(e){return{type:"DROP_ANIMATE",payload:e}},Dr=function(e){return{type:"DROP_COMPLETE",payload:e}},Ia=function(e){return{type:"DROP",payload:e}},Lc=function(e){return{type:"DROP_PENDING",payload:e}},ka=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},Bc=function(t){return function(e){var r=e.getState,n=e.dispatch;return function(i){return function(a){if(a.type!=="LIFT"){i(a);return}var o=a.payload,l=o.id,c=o.clientSelection,p=o.movementMode,m=r();m.phase==="DROP_ANIMATING"&&n(Dr({completed:m.completed})),r().phase!=="IDLE"&&P(),n(Cr()),n(wc({draggableId:l,movementMode:p}));var u={shouldPublishImmediately:p==="SNAP"},d={draggableId:l,scrollOptions:u},g=t.startPublishing(d),f=g.critical,y=g.dimensions,x=g.viewport;n(Nc({critical:f,dimensions:y,clientSelection:c,movementMode:p,viewport:x}))}}}},Fc=function(t){return function(){return function(e){return function(r){r.type==="INITIAL_PUBLISH"&&t.dragging(),r.type==="DROP_ANIMATE"&&t.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&t.resting(),e(r)}}}},Er={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},rt={opacity:{drop:0,combining:.7},scale:{drop:.75}},jr={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Ne=jr.outOfTheWay+"s "+Er.outOfTheWay,Xe={fluid:"opacity "+Ne,snap:"transform "+Ne+", opacity "+Ne,drop:function(e){var r=e+"s "+Er.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+Ne,placeholder:"height "+Ne+", width "+Ne+", margin "+Ne},fn=function(e){return xe(e,z)?null:"translate("+e.x+"px, "+e.y+"px)"},sr={moveTo:fn,drop:function(e,r){var n=fn(e);return n?r?n+" scale("+rt.scale.drop+")":n:null}},lr=jr.minDropTime,Ta=jr.maxDropTime,Wc=Ta-lr,vn=1500,Hc=.6,Uc=function(t){var e=t.current,r=t.destination,n=t.reason,i=_e(e,r);if(i<=0)return lr;if(i>=vn)return Ta;var a=i/vn,o=lr+Wc*a,l=n==="CANCEL"?o*Hc:o;return Number(l.toFixed(2))},Gc=function(t){var e=t.impact,r=t.draggable,n=t.dimensions,i=t.viewport,a=t.afterCritical,o=n.draggables,l=n.droppables,c=ne(e),p=c?l[c]:null,m=l[r.descriptor.droppableId],u=Ca({impact:e,draggable:r,draggables:o,afterCritical:a,droppable:p||m,viewport:i}),d=re(u,r.client.borderBox.center);return d},qc=function(t){var e=t.draggables,r=t.reason,n=t.lastImpact,i=t.home,a=t.viewport,o=t.onLiftImpact;if(!n.at||r!=="DROP"){var l=Na({draggables:e,impact:o,destination:i,viewport:a,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=L({},n,{displaced:et});return{impact:c,didDropInsideDroppable:!0}},$c=function(t){var e=t.getState,r=t.dispatch;return function(n){return function(i){if(i.type!=="DROP"){n(i);return}var a=e(),o=i.payload.reason;if(a.phase==="COLLECTING"){r(Lc({reason:o}));return}if(a.phase!=="IDLE"){var l=a.phase==="DROP_PENDING"&&a.isWaiting;l&&P(),a.phase==="DRAGGING"||a.phase==="DROP_PENDING"||P();var c=a.critical,p=a.dimensions,m=p.draggables[a.critical.draggable.id],u=qc({reason:o,lastImpact:a.impact,afterCritical:a.afterCritical,onLiftImpact:a.onLiftImpact,home:a.dimensions.droppables[a.critical.droppable.id],viewport:a.viewport,draggables:a.dimensions.draggables}),d=u.impact,g=u.didDropInsideDroppable,f=g?xr(d):null,y=g?Tt(d):null,x={index:c.draggable.index,droppableId:c.droppable.id},b={draggableId:m.descriptor.id,type:m.descriptor.type,source:x,reason:o,mode:a.movementMode,destination:f,combine:y},v=Gc({impact:d,draggable:m,dimensions:p,viewport:a.viewport,afterCritical:a.afterCritical}),h={critical:a.critical,afterCritical:a.afterCritical,result:b,impact:d},w=!xe(a.current.client.offset,v)||!!b.combine;if(!w){r(Dr({completed:h}));return}var E=Uc({current:a.current.client.offset,destination:v,reason:o}),T={newHomeClientOffset:v,dropDuration:E,completed:h};r(Mc(T))}}}},Pa=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function Vc(t){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||t()}}}function Yc(t){var e=t.onWindowScroll;function r(){e(Pa())}var n=Qe(r),i=Vc(n),a=he;function o(){return a!==he}function l(){o()&&P(),a=le(window,[i])}function c(){o()||P(),n.cancel(),a(),a=he}return{start:l,stop:c,isActive:o}}var zc=function(e){return e.type==="DROP_COMPLETE"||e.type==="DROP_ANIMATE"||e.type==="FLUSH"},Zc=function(t){var e=Yc({onWindowScroll:function(n){t.dispatch(kc({newScroll:n}))}});return function(r){return function(n){!e.isActive()&&n.type==="INITIAL_PUBLISH"&&e.start(),e.isActive()&&zc(n)&&e.stop(),r(n)}}},Jc=function(t){var e=!1,r=!1,n=setTimeout(function(){r=!0}),i=function(o){e||r||(e=!0,t(o),clearTimeout(n))};return i.wasCalled=function(){return e},i},Xc=function(){var t=[],e=function(a){var o=hr(t,function(p){return p.timerId===a});o===-1&&P();var l=t.splice(o,1),c=l[0];c.callback()},r=function(a){var o=setTimeout(function(){return e(o)}),l={timerId:o,callback:a};t.push(l)},n=function(){if(t.length){var a=[].concat(t);t.length=0,a.forEach(function(o){clearTimeout(o.timerId),o.callback()})}};return{add:r,flush:n}},Kc=function(e,r){return e==null&&r==null?!0:e==null||r==null?!1:e.droppableId===r.droppableId&&e.index===r.index},Qc=function(e,r){return e==null&&r==null?!0:e==null||r==null?!1:e.draggableId===r.draggableId&&e.droppableId===r.droppableId},_c=function(e,r){if(e===r)return!0;var n=e.draggable.id===r.draggable.id&&e.draggable.droppableId===r.draggable.droppableId&&e.draggable.type===r.draggable.type&&e.draggable.index===r.draggable.index,i=e.droppable.id===r.droppable.id&&e.droppable.type===r.droppable.type;return n&&i},Ve=function(e,r){r()},lt=function(e,r){return{draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:r}},Jt=function(e,r,n,i){if(!e){n(i(r));return}var a=Jc(n),o={announce:a};e(r,o),a.wasCalled()||n(i(r))},eu=function(t,e){var r=Xc(),n=null,i=function(d,g){n&&P(),Ve("onBeforeCapture",function(){var f=t().onBeforeCapture;if(f){var y={draggableId:d,mode:g};f(y)}})},a=function(d,g){n&&P(),Ve("onBeforeDragStart",function(){var f=t().onBeforeDragStart;f&&f(lt(d,g))})},o=function(d,g){n&&P();var f=lt(d,g);n={mode:g,lastCritical:d,lastLocation:f.source,lastCombine:null},r.add(function(){Ve("onDragStart",function(){return Jt(t().onDragStart,f,e,pt.onDragStart)})})},l=function(d,g){var f=xr(g),y=Tt(g);n||P();var x=!_c(d,n.lastCritical);x&&(n.lastCritical=d);var b=!Kc(n.lastLocation,f);b&&(n.lastLocation=f);var v=!Qc(n.lastCombine,y);if(v&&(n.lastCombine=y),!(!x&&!b&&!v)){var h=L({},lt(d,n.mode),{combine:y,destination:f});r.add(function(){Ve("onDragUpdate",function(){return Jt(t().onDragUpdate,h,e,pt.onDragUpdate)})})}},c=function(){n||P(),r.flush()},p=function(d){n||P(),n=null,Ve("onDragEnd",function(){return Jt(t().onDragEnd,d,e,pt.onDragEnd)})},m=function(){if(n){var d=L({},lt(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});p(d)}};return{beforeCapture:i,beforeStart:a,start:o,update:l,flush:c,drop:p,abort:m}},tu=function(t,e){var r=eu(t,e);return function(n){return function(i){return function(a){if(a.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(a.payload.draggableId,a.payload.movementMode);return}if(a.type==="INITIAL_PUBLISH"){var o=a.payload.critical;r.beforeStart(o,a.payload.movementMode),i(a),r.start(o,a.payload.movementMode);return}if(a.type==="DROP_COMPLETE"){var l=a.payload.completed.result;r.flush(),i(a),r.drop(l);return}if(i(a),a.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},ru=function(t){return function(e){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){e(r);return}var n=t.getState();n.phase!=="DROP_ANIMATING"&&P(),t.dispatch(Dr({completed:n.completed}))}}},nu=function(t){var e=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),e&&(e(),e=null)}return function(i){return function(a){if((a.type==="FLUSH"||a.type==="DROP_COMPLETE"||a.type==="DROP_ANIMATION_FINISHED")&&n(),i(a),a.type==="DROP_ANIMATE"){var o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=t.getState();c.phase==="DROP_ANIMATING"&&t.dispatch(ka())}};r=requestAnimationFrame(function(){r=null,e=le(window,[o])})}}}},au=function(t){return function(){return function(e){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&t.stopPublishing(),e(r)}}}},iu=function(t){var e=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){e=!0,t.tryRecordFocus(n.payload.critical.draggable.id),r(n),t.tryRestoreFocusRecorded();return}if(r(n),!!e){if(n.type==="FLUSH"){e=!1,t.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){e=!1;var i=n.payload.completed.result;i.combine&&t.tryShiftRecord(i.draggableId,i.combine.draggableId),t.tryRestoreFocusRecorded()}}}}}},ou=function(e){return e.type==="DROP_COMPLETE"||e.type==="DROP_ANIMATE"||e.type==="FLUSH"},su=function(t){return function(e){return function(r){return function(n){if(ou(n)){t.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var i=e.getState();i.phase!=="DRAGGING"&&P(),t.start(i);return}r(n),t.scroll(e.getState())}}}},lu=function(t){return function(e){return function(r){if(e(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=t.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||t.dispatch(Ia({reason:n.reason})))}}}},cu=ti,uu=function(t){var e=t.dimensionMarshal,r=t.focusMarshal,n=t.styleMarshal,i=t.getResponders,a=t.announce,o=t.autoScroller;return ei(yc,cu(ri(Fc(n),au(e),Bc(e),$c,ru,nu,lu,su(o),Zc,iu(r),tu(i,a))))},Xt=function(){return{additions:{},removals:{},modified:{}}};function du(t){var e=t.registry,r=t.callbacks,n=Xt(),i=null,a=function(){i||(r.collectionStarting(),i=requestAnimationFrame(function(){i=null;var m=n,u=m.additions,d=m.removals,g=m.modified,f=Object.keys(u).map(function(b){return e.draggable.getById(b).getDimension(z)}).sort(function(b,v){return b.descriptor.index-v.descriptor.index}),y=Object.keys(g).map(function(b){var v=e.droppable.getById(b),h=v.callbacks.getScrollWhileDragging();return{droppableId:b,scroll:h}}),x={additions:f,removals:Object.keys(d),modified:y};n=Xt(),r.publish(x)}))},o=function(m){var u=m.descriptor.id;n.additions[u]=m,n.modified[m.descriptor.droppableId]=!0,n.removals[u]&&delete n.removals[u],a()},l=function(m){var u=m.descriptor;n.removals[u.id]=!0,n.modified[u.droppableId]=!0,n.additions[u.id]&&delete n.additions[u.id],a()},c=function(){i&&(cancelAnimationFrame(i),i=null,n=Xt())};return{add:o,remove:l,stop:c}}var Ra=function(t){var e=t.scrollHeight,r=t.scrollWidth,n=t.height,i=t.width,a=re({x:r,y:e},{x:i,y:n}),o={x:Math.max(0,a.x),y:Math.max(0,a.y)};return o},Aa=function(){var t=document.documentElement;return t||P(),t},Oa=function(){var t=Aa(),e=Ra({scrollHeight:t.scrollHeight,scrollWidth:t.scrollWidth,width:t.clientWidth,height:t.clientHeight});return e},pu=function(){var t=Pa(),e=Oa(),r=t.y,n=t.x,i=Aa(),a=i.clientWidth,o=i.clientHeight,l=n+a,c=r+o,p=ue({top:r,left:n,right:l,bottom:c}),m={frame:p,scroll:{initial:t,current:t,max:e,diff:{value:z,displacement:z}}};return m},mu=function(t){var e=t.critical,r=t.scrollOptions,n=t.registry,i=pu(),a=i.scroll.current,o=e.droppable,l=n.droppable.getAllByType(o.type).map(function(u){return u.callbacks.getDimensionAndWatchScroll(a,r)}),c=n.draggable.getAllByType(e.draggable.type).map(function(u){return u.getDimension(a)}),p={draggables:ca(c),droppables:la(l)},m={dimensions:p,critical:e,viewport:i};return m};function hn(t,e,r){if(r.descriptor.id===e.id||r.descriptor.type!==e.type)return!1;var n=t.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var gu=function(t,e){var r=null,n=du({callbacks:{publish:e.publishWhileDragging,collectionStarting:e.collectionStarting},registry:t}),i=function(g,f){t.droppable.exists(g)||P(),r&&e.updateDroppableIsEnabled({id:g,isEnabled:f})},a=function(g,f){r&&(t.droppable.exists(g)||P(),e.updateDroppableIsCombineEnabled({id:g,isCombineEnabled:f}))},o=function(g,f){r&&(t.droppable.exists(g)||P(),e.updateDroppableScroll({id:g,newScroll:f}))},l=function(g,f){r&&t.droppable.getById(g).callbacks.scroll(f)},c=function(){if(r){n.stop();var g=r.critical.droppable;t.droppable.getAllByType(g.type).forEach(function(f){return f.callbacks.dragStopped()}),r.unsubscribe(),r=null}},p=function(g){r||P();var f=r.critical.draggable;g.type==="ADDITION"&&hn(t,f,g.value)&&n.add(g.value),g.type==="REMOVAL"&&hn(t,f,g.value)&&n.remove(g.value)},m=function(g){r&&P();var f=t.draggable.getById(g.draggableId),y=t.droppable.getById(f.descriptor.droppableId),x={draggable:f.descriptor,droppable:y.descriptor},b=t.subscribe(p);return r={critical:x,unsubscribe:b},mu({critical:x,registry:t,scrollOptions:g.scrollOptions})},u={updateDroppableIsEnabled:i,updateDroppableIsCombineEnabled:a,scrollDroppable:l,updateDroppableScroll:o,startPublishing:m,stopPublishing:c};return u},Ma=function(t,e){return t.phase==="IDLE"?!0:t.phase!=="DROP_ANIMATING"||t.completed.result.draggableId===e?!1:t.completed.result.reason==="DROP"},fu=function(t){window.scrollBy(t.x,t.y)},vu=Y(function(t){return kt(t).filter(function(e){return!(!e.isEnabled||!e.frame)})}),hu=function(e,r){var n=Se(vu(r),function(i){return i.frame||P(),ba(i.frame.pageMarginBox)(e)});return n},xu=function(t){var e=t.center,r=t.destination,n=t.droppables;if(r){var i=n[r];return i.frame?i:null}var a=hu(e,n);return a},be={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(e){return Math.pow(e,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},bu=function(t,e){var r=t[e.size]*be.startFromPercentage,n=t[e.size]*be.maxScrollAtPercentage,i={startScrollingFrom:r,maxScrollValueAt:n};return i},La=function(t){var e=t.startOfRange,r=t.endOfRange,n=t.current,i=r-e;if(i===0)return 0;var a=n-e,o=a/i;return o},Ir=1,yu=function(t,e){if(t>e.startScrollingFrom)return 0;if(t<=e.maxScrollValueAt)return be.maxPixelScroll;if(t===e.startScrollingFrom)return Ir;var r=La({startOfRange:e.maxScrollValueAt,endOfRange:e.startScrollingFrom,current:t}),n=1-r,i=be.maxPixelScroll*be.ease(n);return Math.ceil(i)},xn=be.durationDampening.accelerateAt,bn=be.durationDampening.stopDampeningAt,wu=function(t,e){var r=e,n=bn,i=Date.now(),a=i-r;if(a>=bn)return t;if(a<xn)return Ir;var o=La({startOfRange:xn,endOfRange:n,current:a}),l=t*be.ease(o);return Math.ceil(l)},yn=function(t){var e=t.distanceToEdge,r=t.thresholds,n=t.dragStartTime,i=t.shouldUseTimeDampening,a=yu(e,r);return a===0?0:i?Math.max(wu(a,n),Ir):a},wn=function(t){var e=t.container,r=t.distanceToEdges,n=t.dragStartTime,i=t.axis,a=t.shouldUseTimeDampening,o=bu(e,i),l=r[i.end]<r[i.start];return l?yn({distanceToEdge:r[i.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a}):-1*yn({distanceToEdge:r[i.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a})},Su=function(t){var e=t.container,r=t.subject,n=t.proposedScroll,i=r.height>e.height,a=r.width>e.width;return!a&&!i?n:a&&i?null:{x:a?0:n.x,y:i?0:n.y}},Nu=oa(function(t){return t===0?0:t}),Ba=function(t){var e=t.dragStartTime,r=t.container,n=t.subject,i=t.center,a=t.shouldUseTimeDampening,o={top:i.y-r.top,right:r.right-i.x,bottom:r.bottom-i.y,left:i.x-r.left},l=wn({container:r,distanceToEdges:o,dragStartTime:e,axis:br,shouldUseTimeDampening:a}),c=wn({container:r,distanceToEdges:o,dragStartTime:e,axis:pa,shouldUseTimeDampening:a}),p=Nu({x:c,y:l});if(xe(p,z))return null;var m=Su({container:r,subject:n,proposedScroll:p});return m?xe(m,z)?null:m:null},Cu=oa(function(t){return t===0?0:t>0?1:-1}),kr=function(){var t=function(r,n){return r<0?r:r>n?r-n:0};return function(e){var r=e.current,n=e.max,i=e.change,a=Z(r,i),o={x:t(a.x,n.x),y:t(a.y,n.y)};return xe(o,z)?null:o}}(),Fa=function(e){var r=e.max,n=e.current,i=e.change,a={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},o=Cu(i),l=kr({max:a,current:n,change:o});return!l||o.x!==0&&l.x===0||o.y!==0&&l.y===0},Tr=function(e,r){return Fa({current:e.scroll.current,max:e.scroll.max,change:r})},Du=function(e,r){if(!Tr(e,r))return null;var n=e.scroll.max,i=e.scroll.current;return kr({current:i,max:n,change:r})},Pr=function(e,r){var n=e.frame;return n?Fa({current:n.scroll.current,max:n.scroll.max,change:r}):!1},Eu=function(e,r){var n=e.frame;return!n||!Pr(e,r)?null:kr({current:n.scroll.current,max:n.scroll.max,change:r})},ju=function(t){var e=t.viewport,r=t.subject,n=t.center,i=t.dragStartTime,a=t.shouldUseTimeDampening,o=Ba({dragStartTime:i,container:e.frame,subject:r,center:n,shouldUseTimeDampening:a});return o&&Tr(e,o)?o:null},Iu=function(t){var e=t.droppable,r=t.subject,n=t.center,i=t.dragStartTime,a=t.shouldUseTimeDampening,o=e.frame;if(!o)return null;var l=Ba({dragStartTime:i,container:o.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:a});return l&&Pr(e,l)?l:null},Sn=function(t){var e=t.state,r=t.dragStartTime,n=t.shouldUseTimeDampening,i=t.scrollWindow,a=t.scrollDroppable,o=e.current.page.borderBoxCenter,l=e.dimensions.draggables[e.critical.draggable.id],c=l.page.marginBox;if(e.isWindowScrollAllowed){var p=e.viewport,m=ju({dragStartTime:r,viewport:p,subject:c,center:o,shouldUseTimeDampening:n});if(m){i(m);return}}var u=xu({center:o,destination:ne(e.impact),droppables:e.dimensions.droppables});if(u){var d=Iu({dragStartTime:r,droppable:u,subject:c,center:o,shouldUseTimeDampening:n});d&&a(u.descriptor.id,d)}},ku=function(t){var e=t.scrollWindow,r=t.scrollDroppable,n=Qe(e),i=Qe(r),a=null,o=function(m){a||P();var u=a,d=u.shouldUseTimeDampening,g=u.dragStartTime;Sn({state:m,scrollWindow:n,scrollDroppable:i,dragStartTime:g,shouldUseTimeDampening:d})},l=function(m){a&&P();var u=Date.now(),d=!1,g=function(){d=!0};Sn({state:m,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:g,scrollDroppable:g}),a={dragStartTime:u,shouldUseTimeDampening:d},d&&o(m)},c=function(){a&&(n.cancel(),i.cancel(),a=null)};return{start:l,stop:c,scroll:o}},Tu=function(t){var e=t.move,r=t.scrollDroppable,n=t.scrollWindow,i=function(p,m){var u=Z(p.current.client.selection,m);e({client:u})},a=function(p,m){if(!Pr(p,m))return m;var u=Eu(p,m);if(!u)return r(p.descriptor.id,m),null;var d=re(m,u);r(p.descriptor.id,d);var g=re(m,d);return g},o=function(p,m,u){if(!p||!Tr(m,u))return u;var d=Du(m,u);if(!d)return n(u),null;var g=re(u,d);n(g);var f=re(u,g);return f},l=function(p){var m=p.scrollJumpRequest;if(m){var u=ne(p.impact);u||P();var d=a(p.dimensions.droppables[u],m);if(d){var g=p.viewport,f=o(p.isWindowScrollAllowed,g,d);f&&i(p,f)}}};return l},Pu=function(t){var e=t.scrollDroppable,r=t.scrollWindow,n=t.move,i=ku({scrollWindow:r,scrollDroppable:e}),a=Tu({move:n,scrollWindow:r,scrollDroppable:e}),o=function(p){if(p.phase==="DRAGGING"){if(p.movementMode==="FLUID"){i.scroll(p);return}p.scrollJumpRequest&&a(p)}},l={scroll:o,start:i.start,stop:i.stop};return l},Oe="data-rbd",Me=function(){var t=Oe+"-drag-handle";return{base:t,draggableId:t+"-draggable-id",contextId:t+"-context-id"}}(),cr=function(){var t=Oe+"-draggable";return{base:t,contextId:t+"-context-id",id:t+"-id"}}(),Ru=function(){var t=Oe+"-droppable";return{base:t,contextId:t+"-context-id",id:t+"-id"}}(),Nn={contextId:Oe+"-scroll-container-context-id"},Au=function(e){return function(r){return"["+r+'="'+e+'"]'}},Ye=function(e,r){return e.map(function(n){var i=n.styles[r];return i?n.selector+" { "+i+" }":""}).join(" ")},Ou="pointer-events: none;",Mu=function(t){var e=Au(t),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:e(Me.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:Ou,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+Xe.outOfTheWay+`;
    `;return{selector:e(cr.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),i={selector:e(Ru.contextId),styles:{always:"overflow-anchor: none;"}},a={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},o=[n,r,i,a];return{always:Ye(o,"always"),resting:Ye(o,"resting"),dragging:Ye(o,"dragging"),dropAnimating:Ye(o,"dropAnimating"),userCancel:Ye(o,"userCancel")}},ae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?S.useLayoutEffect:S.useEffect,Kt=function(){var e=document.querySelector("head");return e||P(),e},Cn=function(e){var r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.type="text/css",r};function Lu(t,e){var r=H(function(){return Mu(t)},[t]),n=S.useRef(null),i=S.useRef(null),a=A(Y(function(u){var d=i.current;d||P(),d.textContent=u}),[]),o=A(function(u){var d=n.current;d||P(),d.textContent=u},[]);ae(function(){!n.current&&!i.current||P();var u=Cn(e),d=Cn(e);return n.current=u,i.current=d,u.setAttribute(Oe+"-always",t),d.setAttribute(Oe+"-dynamic",t),Kt().appendChild(u),Kt().appendChild(d),o(r.always),a(r.resting),function(){var g=function(y){var x=y.current;x||P(),Kt().removeChild(x),y.current=null};g(n),g(i)}},[e,o,a,r.always,r.resting,t]);var l=A(function(){return a(r.dragging)},[a,r.dragging]),c=A(function(u){if(u==="DROP"){a(r.dropAnimating);return}a(r.userCancel)},[a,r.dropAnimating,r.userCancel]),p=A(function(){i.current&&a(r.resting)},[a,r.resting]),m=H(function(){return{dragging:l,dropping:c,resting:p}},[l,c,p]);return m}var Wa=function(t){return t&&t.ownerDocument?t.ownerDocument.defaultView:window};function At(t){return t instanceof Wa(t).HTMLElement}function Bu(t,e){var r="["+Me.contextId+'="'+t+'"]',n=sa(document.querySelectorAll(r));if(!n.length)return null;var i=Se(n,function(a){return a.getAttribute(Me.draggableId)===e});return!i||!At(i)?null:i}function Fu(t){var e=S.useRef({}),r=S.useRef(null),n=S.useRef(null),i=S.useRef(!1),a=A(function(d,g){var f={id:d,focus:g};return e.current[d]=f,function(){var x=e.current,b=x[d];b!==f&&delete x[d]}},[]),o=A(function(d){var g=Bu(t,d);g&&g!==document.activeElement&&g.focus()},[t]),l=A(function(d,g){r.current===d&&(r.current=g)},[]),c=A(function(){n.current||i.current&&(n.current=requestAnimationFrame(function(){n.current=null;var d=r.current;d&&o(d)}))},[o]),p=A(function(d){r.current=null;var g=document.activeElement;g&&g.getAttribute(Me.draggableId)===d&&(r.current=d)},[]);ae(function(){return i.current=!0,function(){i.current=!1;var d=n.current;d&&cancelAnimationFrame(d)}},[]);var m=H(function(){return{register:a,tryRecordFocus:p,tryRestoreFocusRecorded:c,tryShiftRecord:l}},[a,p,c,l]);return m}function Wu(){var t={draggables:{},droppables:{}},e=[];function r(u){return e.push(u),function(){var g=e.indexOf(u);g!==-1&&e.splice(g,1)}}function n(u){e.length&&e.forEach(function(d){return d(u)})}function i(u){return t.draggables[u]||null}function a(u){var d=i(u);return d||P(),d}var o={register:function(d){t.draggables[d.descriptor.id]=d,n({type:"ADDITION",value:d})},update:function(d,g){var f=t.draggables[g.descriptor.id];f&&f.uniqueId===d.uniqueId&&(delete t.draggables[g.descriptor.id],t.draggables[d.descriptor.id]=d)},unregister:function(d){var g=d.descriptor.id,f=i(g);f&&d.uniqueId===f.uniqueId&&(delete t.draggables[g],n({type:"REMOVAL",value:d}))},getById:a,findById:i,exists:function(d){return!!i(d)},getAllByType:function(d){return St(t.draggables).filter(function(g){return g.descriptor.type===d})}};function l(u){return t.droppables[u]||null}function c(u){var d=l(u);return d||P(),d}var p={register:function(d){t.droppables[d.descriptor.id]=d},unregister:function(d){var g=l(d.descriptor.id);g&&d.uniqueId===g.uniqueId&&delete t.droppables[d.descriptor.id]},getById:c,findById:l,exists:function(d){return!!l(d)},getAllByType:function(d){return St(t.droppables).filter(function(g){return g.descriptor.type===d})}};function m(){t.draggables={},t.droppables={},e.length=0}return{draggable:o,droppable:p,subscribe:r,clean:m}}function Hu(){var t=H(Wu,[]);return S.useEffect(function(){return function(){requestAnimationFrame(t.clean)}},[t]),t}var Rr=$.createContext(null),Ct=function(){var t=document.body;return t||P(),t},Uu={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},Gu=function(e){return"rbd-announcement-"+e};function qu(t){var e=H(function(){return Gu(t)},[t]),r=S.useRef(null);S.useEffect(function(){var a=document.createElement("div");return r.current=a,a.id=e,a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),L(a.style,Uu),Ct().appendChild(a),function(){setTimeout(function(){var c=Ct();c.contains(a)&&c.removeChild(a),a===r.current&&(r.current=null)})}},[e]);var n=A(function(i){var a=r.current;if(a){a.textContent=i;return}},[]);return n}var $u=0,Vu={separator:"::"};function Ar(t,e){return e===void 0&&(e=Vu),H(function(){return""+t+e.separator+$u++},[e.separator,t])}function Yu(t){var e=t.contextId,r=t.uniqueId;return"rbd-hidden-text-"+e+"-"+r}function zu(t){var e=t.contextId,r=t.text,n=Ar("hidden-text",{separator:"-"}),i=H(function(){return Yu({contextId:e,uniqueId:n})},[n,e]);return S.useEffect(function(){var o=document.createElement("div");return o.id=i,o.textContent=r,o.style.display="none",Ct().appendChild(o),function(){var c=Ct();c.contains(o)&&c.removeChild(o)}},[i,r]),i}var Ot=$.createContext(null);function Ha(t){var e=S.useRef(t);return S.useEffect(function(){e.current=t}),e}function Zu(){var t=null;function e(){return!!t}function r(o){return o===t}function n(o){t&&P();var l={abandon:o};return t=l,l}function i(){t||P(),t=null}function a(){t&&(t.abandon(),i())}return{isClaimed:e,isActive:r,claim:n,release:i,tryAbandon:a}}var Ju=9,Xu=13,Or=27,Ua=32,Ku=33,Qu=34,_u=35,ed=36,td=37,rd=38,nd=39,ad=40,ct,id=(ct={},ct[Xu]=!0,ct[Ju]=!0,ct),Ga=function(t){id[t.keyCode]&&t.preventDefault()},Mt=function(){var t="visibilitychange";if(typeof document>"u")return t;var e=[t,"ms"+t,"webkit"+t,"moz"+t,"o"+t],r=Se(e,function(n){return"on"+n in document});return r||t}(),qa=0,Dn=5;function od(t,e){return Math.abs(e.x-t.x)>=Dn||Math.abs(e.y-t.y)>=Dn}var En={type:"IDLE"};function sd(t){var e=t.cancel,r=t.completed,n=t.getPhase,i=t.setPhase;return[{eventName:"mousemove",fn:function(o){var l=o.button,c=o.clientX,p=o.clientY;if(l===qa){var m={x:c,y:p},u=n();if(u.type==="DRAGGING"){o.preventDefault(),u.actions.move(m);return}u.type!=="PENDING"&&P();var d=u.point;if(od(d,m)){o.preventDefault();var g=u.actions.fluidLift(m);i({type:"DRAGGING",actions:g})}}}},{eventName:"mouseup",fn:function(o){var l=n();if(l.type!=="DRAGGING"){e();return}o.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(o){n().type==="DRAGGING"&&o.preventDefault(),e()}},{eventName:"keydown",fn:function(o){var l=n();if(l.type==="PENDING"){e();return}if(o.keyCode===Or){o.preventDefault(),e();return}Ga(o)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:function(o){var l=n();if(l.type==="IDLE"&&P(),l.actions.shouldRespectForcePress()){e();return}o.preventDefault()}},{eventName:Mt,fn:e}]}function ld(t){var e=S.useRef(En),r=S.useRef(he),n=H(function(){return{eventName:"mousedown",fn:function(u){if(!u.defaultPrevented&&u.button===qa&&!(u.ctrlKey||u.metaKey||u.shiftKey||u.altKey)){var d=t.findClosestDraggableId(u);if(d){var g=t.tryGetLock(d,o,{sourceEvent:u});if(g){u.preventDefault();var f={x:u.clientX,y:u.clientY};r.current(),p(g,f)}}}}}},[t]),i=H(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(u){if(!u.defaultPrevented){var d=t.findClosestDraggableId(u);if(d){var g=t.findOptionsForDraggable(d);g&&(g.shouldRespectForcePress||t.canGetLock(d)&&u.preventDefault())}}}}},[t]),a=A(function(){var u={passive:!1,capture:!0};r.current=le(window,[i,n],u)},[i,n]),o=A(function(){var m=e.current;m.type!=="IDLE"&&(e.current=En,r.current(),a())},[a]),l=A(function(){var m=e.current;o(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[o]),c=A(function(){var u={capture:!0,passive:!1},d=sd({cancel:l,completed:o,getPhase:function(){return e.current},setPhase:function(f){e.current=f}});r.current=le(window,d,u)},[l,o]),p=A(function(u,d){e.current.type!=="IDLE"&&P(),e.current={type:"PENDING",point:d,actions:u},c()},[c]);ae(function(){return a(),function(){r.current()}},[a])}var Re;function cd(){}var ud=(Re={},Re[Qu]=!0,Re[Ku]=!0,Re[ed]=!0,Re[_u]=!0,Re);function dd(t,e){function r(){e(),t.cancel()}function n(){e(),t.drop()}return[{eventName:"keydown",fn:function(a){if(a.keyCode===Or){a.preventDefault(),r();return}if(a.keyCode===Ua){a.preventDefault(),n();return}if(a.keyCode===ad){a.preventDefault(),t.moveDown();return}if(a.keyCode===rd){a.preventDefault(),t.moveUp();return}if(a.keyCode===nd){a.preventDefault(),t.moveRight();return}if(a.keyCode===td){a.preventDefault(),t.moveLeft();return}if(ud[a.keyCode]){a.preventDefault();return}Ga(a)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:Mt,fn:r}]}function pd(t){var e=S.useRef(cd),r=H(function(){return{eventName:"keydown",fn:function(a){if(a.defaultPrevented||a.keyCode!==Ua)return;var o=t.findClosestDraggableId(a);if(!o)return;var l=t.tryGetLock(o,m,{sourceEvent:a});if(!l)return;a.preventDefault();var c=!0,p=l.snapLift();e.current();function m(){c||P(),c=!1,e.current(),n()}e.current=le(window,dd(p,m),{capture:!0,passive:!1})}}},[t]),n=A(function(){var a={passive:!1,capture:!0};e.current=le(window,[r],a)},[r]);ae(function(){return n(),function(){e.current()}},[n])}var Qt={type:"IDLE"},md=120,gd=.15;function fd(t){var e=t.cancel,r=t.getPhase;return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:function(i){i.preventDefault()}},{eventName:"keydown",fn:function(i){if(r().type!=="DRAGGING"){e();return}i.keyCode===Or&&i.preventDefault(),e()}},{eventName:Mt,fn:e}]}function vd(t){var e=t.cancel,r=t.completed,n=t.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(a){var o=n();if(o.type!=="DRAGGING"){e();return}o.hasMoved=!0;var l=a.touches[0],c=l.clientX,p=l.clientY,m={x:c,y:p};a.preventDefault(),o.actions.move(m)}},{eventName:"touchend",fn:function(a){var o=n();if(o.type!=="DRAGGING"){e();return}a.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(a){if(n().type!=="DRAGGING"){e();return}a.preventDefault(),e()}},{eventName:"touchforcechange",fn:function(a){var o=n();o.type==="IDLE"&&P();var l=a.touches[0];if(l){var c=l.force>=gd;if(c){var p=o.actions.shouldRespectForcePress();if(o.type==="PENDING"){p&&e();return}if(p){if(o.hasMoved){a.preventDefault();return}e();return}a.preventDefault()}}}},{eventName:Mt,fn:e}]}function hd(t){var e=S.useRef(Qt),r=S.useRef(he),n=A(function(){return e.current},[]),i=A(function(g){e.current=g},[]),a=H(function(){return{eventName:"touchstart",fn:function(g){if(!g.defaultPrevented){var f=t.findClosestDraggableId(g);if(f){var y=t.tryGetLock(f,l,{sourceEvent:g});if(y){var x=g.touches[0],b=x.clientX,v=x.clientY,h={x:b,y:v};r.current(),u(y,h)}}}}}},[t]),o=A(function(){var g={capture:!0,passive:!1};r.current=le(window,[a],g)},[a]),l=A(function(){var d=e.current;d.type!=="IDLE"&&(d.type==="PENDING"&&clearTimeout(d.longPressTimerId),i(Qt),r.current(),o())},[o,i]),c=A(function(){var d=e.current;l(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[l]),p=A(function(){var g={capture:!0,passive:!1},f={cancel:c,completed:l,getPhase:n},y=le(window,vd(f),g),x=le(window,fd(f),g);r.current=function(){y(),x()}},[c,n,l]),m=A(function(){var g=n();g.type!=="PENDING"&&P();var f=g.actions.fluidLift(g.point);i({type:"DRAGGING",actions:f,hasMoved:!1})},[n,i]),u=A(function(g,f){n().type!=="IDLE"&&P();var y=setTimeout(m,md);i({type:"PENDING",point:f,actions:g,longPressTimerId:y}),p()},[p,n,i,m]);ae(function(){return o(),function(){r.current();var f=n();f.type==="PENDING"&&(clearTimeout(f.longPressTimerId),i(Qt))}},[n,o,i]),ae(function(){var g=le(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return g},[])}var xd={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function $a(t,e){if(e==null)return!1;var r=!!xd[e.tagName.toLowerCase()];if(r)return!0;var n=e.getAttribute("contenteditable");return n==="true"||n===""?!0:e===t?!1:$a(t,e.parentElement)}function bd(t,e){var r=e.target;return At(r)?$a(t,r):!1}var yd=function(t){return ue(t.getBoundingClientRect()).center};function wd(t){return t instanceof Wa(t).Element}var Sd=function(){var t="matches";if(typeof document>"u")return t;var e=[t,"msMatchesSelector","webkitMatchesSelector"],r=Se(e,function(n){return n in Element.prototype});return r||t}();function Va(t,e){return t==null?null:t[Sd](e)?t:Va(t.parentElement,e)}function Nd(t,e){return t.closest?t.closest(e):Va(t,e)}function Cd(t){return"["+Me.contextId+'="'+t+'"]'}function Dd(t,e){var r=e.target;if(!wd(r))return null;var n=Cd(t),i=Nd(r,n);return!i||!At(i)?null:i}function Ed(t,e){var r=Dd(t,e);return r?r.getAttribute(Me.draggableId):null}function jd(t,e){var r="["+cr.contextId+'="'+t+'"]',n=sa(document.querySelectorAll(r)),i=Se(n,function(a){return a.getAttribute(cr.id)===e});return!i||!At(i)?null:i}function Id(t){t.preventDefault()}function ut(t){var e=t.expected,r=t.phase,n=t.isLockActive;return t.shouldWarn,!(!n()||e!==r)}function Ya(t){var e=t.lockAPI,r=t.store,n=t.registry,i=t.draggableId;if(e.isClaimed())return!1;var a=n.draggable.findById(i);return!(!a||!a.options.isEnabled||!Ma(r.getState(),i))}function kd(t){var e=t.lockAPI,r=t.contextId,n=t.store,i=t.registry,a=t.draggableId,o=t.forceSensorStop,l=t.sourceEvent,c=Ya({lockAPI:e,store:n,registry:i,draggableId:a});if(!c)return null;var p=i.draggable.getById(a),m=jd(r,p.descriptor.id);if(!m||l&&!p.options.canDragInteractiveElements&&bd(m,l))return null;var u=e.claim(o||he),d="PRE_DRAG";function g(){return p.options.shouldRespectForcePress}function f(){return e.isActive(u)}function y(T,I){ut({expected:T,phase:d,isLockActive:f,shouldWarn:!0})&&n.dispatch(I())}var x=y.bind(null,"DRAGGING");function b(T){function I(){e.release(),d="COMPLETED"}d!=="PRE_DRAG"&&(I(),d!=="PRE_DRAG"&&P()),n.dispatch(Sc(T.liftActionArgs)),d="DRAGGING";function N(D,O){if(O===void 0&&(O={shouldBlockNextClick:!1}),T.cleanup(),O.shouldBlockNextClick){var C=le(window,[{eventName:"click",fn:Id,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(C)}I(),n.dispatch(Ia({reason:D}))}return L({isActive:function(){return ut({expected:"DRAGGING",phase:d,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:g,drop:function(O){return N("DROP",O)},cancel:function(O){return N("CANCEL",O)}},T.actions)}function v(T){var I=Qe(function(D){x(function(){return ja({client:D})})}),N=b({liftActionArgs:{id:a,clientSelection:T,movementMode:"FLUID"},cleanup:function(){return I.cancel()},actions:{move:I}});return L({},N,{move:I})}function h(){var T={moveUp:function(){return x(Pc)},moveRight:function(){return x(Ac)},moveDown:function(){return x(Rc)},moveLeft:function(){return x(Oc)}};return b({liftActionArgs:{id:a,clientSelection:yd(m),movementMode:"SNAP"},cleanup:he,actions:T})}function w(){var T=ut({expected:"PRE_DRAG",phase:d,isLockActive:f,shouldWarn:!0});T&&e.release()}var E={isActive:function(){return ut({expected:"PRE_DRAG",phase:d,isLockActive:f,shouldWarn:!1})},shouldRespectForcePress:g,fluidLift:v,snapLift:h,abort:w};return E}var Td=[ld,pd,hd];function Pd(t){var e=t.contextId,r=t.store,n=t.registry,i=t.customSensors,a=t.enableDefaultSensors,o=[].concat(a?Td:[],i||[]),l=S.useState(function(){return Zu()})[0],c=A(function(v,h){v.isDragging&&!h.isDragging&&l.tryAbandon()},[l]);ae(function(){var v=r.getState(),h=r.subscribe(function(){var w=r.getState();c(v,w),v=w});return h},[l,r,c]),ae(function(){return l.tryAbandon},[l.tryAbandon]);for(var p=A(function(b){return Ya({lockAPI:l,registry:n,store:r,draggableId:b})},[l,n,r]),m=A(function(b,v,h){return kd({lockAPI:l,registry:n,contextId:e,store:r,draggableId:b,forceSensorStop:v,sourceEvent:h&&h.sourceEvent?h.sourceEvent:null})},[e,l,n,r]),u=A(function(b){return Ed(e,b)},[e]),d=A(function(b){var v=n.draggable.findById(b);return v?v.options:null},[n.draggable]),g=A(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(Cr()))},[l,r]),f=A(l.isClaimed,[l]),y=H(function(){return{canGetLock:p,tryGetLock:m,findClosestDraggableId:u,findOptionsForDraggable:d,tryReleaseLock:g,isLockClaimed:f}},[p,m,u,d,g,f]),x=0;x<o.length;x++)o[x](y)}var Rd=function(e){return{onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}};function ze(t){return t.current||P(),t.current}function Ad(t){var e=t.contextId,r=t.setCallbacks,n=t.sensors,i=t.nonce,a=t.dragHandleUsageInstructions,o=S.useRef(null),l=Ha(t),c=A(function(){return Rd(l.current)},[l]),p=qu(e),m=zu({contextId:e,text:a}),u=Lu(e,i),d=A(function(D){ze(o).dispatch(D)},[]),g=H(function(){return Wr({publishWhileDragging:Cc,updateDroppableScroll:Ec,updateDroppableIsEnabled:jc,updateDroppableIsCombineEnabled:Ic,collectionStarting:Dc},d)},[d]),f=Hu(),y=H(function(){return gu(f,g)},[f,g]),x=H(function(){return Pu(L({scrollWindow:fu,scrollDroppable:y.scrollDroppable},Wr({move:ja},d)))},[y.scrollDroppable,d]),b=Fu(e),v=H(function(){return uu({announce:p,autoScroller:x,dimensionMarshal:y,focusMarshal:b,getResponders:c,styleMarshal:u})},[p,x,y,b,c,u]);o.current=v;var h=A(function(){var D=ze(o),O=D.getState();O.phase!=="IDLE"&&D.dispatch(Cr())},[]),w=A(function(){var D=ze(o).getState();return D.isDragging||D.phase==="DROP_ANIMATING"},[]),E=H(function(){return{isDragging:w,tryAbort:h}},[w,h]);r(E);var T=A(function(D){return Ma(ze(o).getState(),D)},[]),I=A(function(){return De(ze(o).getState())},[]),N=H(function(){return{marshal:y,focus:b,contextId:e,canLift:T,isMovementAllowed:I,dragHandleUsageInstructionsId:m,registry:f}},[e,y,m,b,T,I,f]);return Pd({contextId:e,store:v,registry:f,customSensors:n,enableDefaultSensors:t.enableDefaultSensors!==!1}),S.useEffect(function(){return h},[h]),$.createElement(Ot.Provider,{value:N},$.createElement(Ns,{context:Rr,store:v},t.children))}var Od=0;function Md(){return H(function(){return""+Od++},[])}function Ld(t){var e=Md(),r=t.dragHandleUsageInstructions||pt.dragHandleUsageInstructions;return $.createElement(pl,null,function(n){return $.createElement(Ad,{nonce:t.nonce,contextId:e,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:t.enableDefaultSensors,sensors:t.sensors,onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragUpdate:t.onDragUpdate,onDragEnd:t.onDragEnd},t.children)})}var za=function(e){return function(r){return e===r}},Bd=za("scroll"),Fd=za("auto"),jn=function(e,r){return r(e.overflowX)||r(e.overflowY)},Wd=function(e){var r=window.getComputedStyle(e),n={overflowX:r.overflowX,overflowY:r.overflowY};return jn(n,Bd)||jn(n,Fd)},Hd=function(){return!1},Ud=function t(e){return e==null?null:e===document.body?Hd()?e:null:e===document.documentElement?null:Wd(e)?e:t(e.parentElement)},ur=function(t){return{x:t.scrollLeft,y:t.scrollTop}},Gd=function t(e){if(!e)return!1;var r=window.getComputedStyle(e);return r.position==="fixed"?!0:t(e.parentElement)},qd=function(t){var e=Ud(t),r=Gd(t);return{closestScrollable:e,isFixedOnPage:r}},$d=function(t){var e=t.descriptor,r=t.isEnabled,n=t.isCombineEnabled,i=t.isFixedOnPage,a=t.direction,o=t.client,l=t.page,c=t.closest,p=function(){if(!c)return null;var g=c.scrollSize,f=c.client,y=Ra({scrollHeight:g.scrollHeight,scrollWidth:g.scrollWidth,height:f.paddingBox.height,width:f.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:f,scrollSize:g,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:y,diff:{value:z,displacement:z}}}}(),m=a==="vertical"?br:pa,u=Ae({page:l,withPlaceholder:null,axis:m,frame:p}),d={descriptor:e,isCombineEnabled:n,isFixedOnPage:i,axis:m,isEnabled:r,client:o,page:l,frame:p,subject:u};return d},Vd=function(e,r){var n=ra(e);if(!r||e!==r)return n;var i=n.paddingBox.top-r.scrollTop,a=n.paddingBox.left-r.scrollLeft,o=i+r.scrollHeight,l=a+r.scrollWidth,c={top:i,right:l,bottom:o,left:a},p=gr(c,n.border),m=fr({borderBox:p,margin:n.margin,border:n.border,padding:n.padding});return m},Yd=function(t){var e=t.ref,r=t.descriptor,n=t.env,i=t.windowScroll,a=t.direction,o=t.isDropDisabled,l=t.isCombineEnabled,c=t.shouldClipSubject,p=n.closestScrollable,m=Vd(e,p),u=bt(m,i),d=function(){if(!p)return null;var f=ra(p),y={scrollHeight:p.scrollHeight,scrollWidth:p.scrollWidth};return{client:f,page:bt(f,i),scroll:ur(p),scrollSize:y,shouldClipSubject:c}}(),g=$d({descriptor:r,isEnabled:!o,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:a,client:m,page:u,closest:d});return g},zd={passive:!1},Zd={passive:!0},In=function(t){return t.shouldPublishImmediately?zd:Zd};function Dt(t){var e=S.useContext(t);return e||P(),e}var dt=function(e){return e&&e.env.closestScrollable||null};function Jd(t){var e=S.useRef(null),r=Dt(Ot),n=Ar("droppable"),i=r.registry,a=r.marshal,o=Ha(t),l=H(function(){return{id:t.droppableId,type:t.type,mode:t.mode}},[t.droppableId,t.mode,t.type]),c=S.useRef(l),p=H(function(){return Y(function(w,E){e.current||P();var T={x:w,y:E};a.updateDroppableScroll(l.id,T)})},[l.id,a]),m=A(function(){var w=e.current;return!w||!w.env.closestScrollable?z:ur(w.env.closestScrollable)},[]),u=A(function(){var w=m();p(w.x,w.y)},[m,p]),d=H(function(){return Qe(u)},[u]),g=A(function(){var w=e.current,E=dt(w);w&&E||P();var T=w.scrollOptions;if(T.shouldPublishImmediately){u();return}d()},[d,u]),f=A(function(w,E){e.current&&P();var T=o.current,I=T.getDroppableRef();I||P();var N=qd(I),D={ref:I,descriptor:l,env:N,scrollOptions:E};e.current=D;var O=Yd({ref:I,descriptor:l,env:N,windowScroll:w,direction:T.direction,isDropDisabled:T.isDropDisabled,isCombineEnabled:T.isCombineEnabled,shouldClipSubject:!T.ignoreContainerClipping}),C=N.closestScrollable;return C&&(C.setAttribute(Nn.contextId,r.contextId),C.addEventListener("scroll",g,In(D.scrollOptions))),O},[r.contextId,l,g,o]),y=A(function(){var w=e.current,E=dt(w);return w&&E||P(),ur(E)},[]),x=A(function(){var w=e.current;w||P();var E=dt(w);e.current=null,E&&(d.cancel(),E.removeAttribute(Nn.contextId),E.removeEventListener("scroll",g,In(w.scrollOptions)))},[g,d]),b=A(function(w){var E=e.current;E||P();var T=dt(E);T||P(),T.scrollTop+=w.y,T.scrollLeft+=w.x},[]),v=H(function(){return{getDimensionAndWatchScroll:f,getScrollWhileDragging:y,dragStopped:x,scroll:b}},[x,f,y,b]),h=H(function(){return{uniqueId:n,descriptor:l,callbacks:v}},[v,l,n]);ae(function(){return c.current=h.descriptor,i.droppable.register(h),function(){e.current&&x(),i.droppable.unregister(h)}},[v,l,x,h,a,i.droppable]),ae(function(){e.current&&a.updateDroppableIsEnabled(c.current.id,!t.isDropDisabled)},[t.isDropDisabled,a]),ae(function(){e.current&&a.updateDroppableIsCombineEnabled(c.current.id,t.isCombineEnabled)},[t.isCombineEnabled,a])}function _t(){}var kn={width:0,height:0,margin:xl},Xd=function(e){var r=e.isAnimatingOpenOnMount,n=e.placeholder,i=e.animate;return r||i==="close"?kn:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},Kd=function(e){var r=e.isAnimatingOpenOnMount,n=e.placeholder,i=e.animate,a=Xd({isAnimatingOpenOnMount:r,placeholder:n,animate:i});return{display:n.display,boxSizing:"border-box",width:a.width,height:a.height,marginTop:a.margin.top,marginRight:a.margin.right,marginBottom:a.margin.bottom,marginLeft:a.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:i!=="none"?Xe.placeholder:null}};function Qd(t){var e=S.useRef(null),r=A(function(){e.current&&(clearTimeout(e.current),e.current=null)},[]),n=t.animate,i=t.onTransitionEnd,a=t.onClose,o=t.contextId,l=S.useState(t.animate==="open"),c=l[0],p=l[1];S.useEffect(function(){return c?n!=="open"?(r(),p(!1),_t):e.current?_t:(e.current=setTimeout(function(){e.current=null,p(!1)}),r):_t},[n,c,r]);var m=A(function(d){d.propertyName==="height"&&(i(),n==="close"&&a())},[n,a,i]),u=Kd({isAnimatingOpenOnMount:c,animate:t.animate,placeholder:t.placeholder});return $.createElement(t.placeholder.tagName,{style:u,"data-rbd-placeholder-context-id":o,onTransitionEnd:m,ref:t.innerRef})}var _d=$.memo(Qd),Mr=$.createContext(null),ep=function(t){zn(e,t);function e(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}e.getDerivedStateFromProps=function(i,a){return i.shouldAnimate?i.on?{isVisible:!0,data:i.on,animate:"open"}:a.isVisible?{isVisible:!0,data:a.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!i.on,data:i.on,animate:"none"}};var r=e.prototype;return r.render=function(){if(!this.state.isVisible)return null;var i={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(i)},e}($.PureComponent),Tn={dragging:5e3,dropAnimating:4500},tp=function(e,r){return r?Xe.drop(r.duration):e?Xe.snap:Xe.fluid},rp=function(e,r){return e?r?rt.opacity.drop:rt.opacity.combining:null},np=function(e){return e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP"};function ap(t){var e=t.dimension,r=e.client,n=t.offset,i=t.combineWith,a=t.dropping,o=!!i,l=np(t),c=!!a,p=c?sr.drop(n,o):sr.moveTo(n),m={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:tp(l,a),transform:p,opacity:rp(o,c),zIndex:c?Tn.dropAnimating:Tn.dragging,pointerEvents:"none"};return m}function ip(t){return{transform:sr.moveTo(t.offset),transition:t.shouldAnimateDisplacement?null:"none"}}function op(t){return t.type==="DRAGGING"?ap(t):ip(t)}function sp(t,e,r){r===void 0&&(r=z);var n=window.getComputedStyle(e),i=e.getBoundingClientRect(),a=ta(i,n),o=bt(a,r),l={client:a,tagName:e.tagName.toLowerCase(),display:n.display},c={x:a.marginBox.width,y:a.marginBox.height},p={descriptor:t,placeholder:l,displaceBy:c,client:a,page:o};return p}function lp(t){var e=Ar("draggable"),r=t.descriptor,n=t.registry,i=t.getDraggableRef,a=t.canDragInteractiveElements,o=t.shouldRespectForcePress,l=t.isEnabled,c=H(function(){return{canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:l}},[a,l,o]),p=A(function(g){var f=i();return f||P(),sp(r,f,g)},[r,i]),m=H(function(){return{uniqueId:e,descriptor:r,options:c,getDimension:p}},[r,p,c,e]),u=S.useRef(m),d=S.useRef(!0);ae(function(){return n.draggable.register(u.current),function(){return n.draggable.unregister(u.current)}},[n.draggable]),ae(function(){if(d.current){d.current=!1;return}var g=u.current;u.current=m,n.draggable.update(m,g)},[m,n.draggable])}function cp(t){t.preventDefault()}function up(t){var e=S.useRef(null),r=A(function(D){e.current=D},[]),n=A(function(){return e.current},[]),i=Dt(Ot),a=i.contextId,o=i.dragHandleUsageInstructionsId,l=i.registry,c=Dt(Mr),p=c.type,m=c.droppableId,u=H(function(){return{id:t.draggableId,index:t.index,type:p,droppableId:m}},[t.draggableId,t.index,p,m]),d=t.children,g=t.draggableId,f=t.isEnabled,y=t.shouldRespectForcePress,x=t.canDragInteractiveElements,b=t.isClone,v=t.mapped,h=t.dropAnimationFinished;if(!b){var w=H(function(){return{descriptor:u,registry:l,getDraggableRef:n,canDragInteractiveElements:x,shouldRespectForcePress:y,isEnabled:f}},[u,l,n,x,y,f]);lp(w)}var E=H(function(){return f?{tabIndex:0,role:"button","aria-describedby":o,"data-rbd-drag-handle-draggable-id":g,"data-rbd-drag-handle-context-id":a,draggable:!1,onDragStart:cp}:null},[a,o,g,f]),T=A(function(D){v.type==="DRAGGING"&&v.dropping&&D.propertyName==="transform"&&h()},[h,v]),I=H(function(){var D=op(v),O=v.type==="DRAGGING"&&v.dropping?T:null,C={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":a,"data-rbd-draggable-id":g,style:D,onTransitionEnd:O},dragHandleProps:E};return C},[a,E,g,v,T,r]),N=H(function(){return{draggableId:u.id,type:u.type,source:{index:u.index,droppableId:u.droppableId}}},[u.droppableId,u.id,u.index,u.type]);return d(I,v.snapshot,N)}var Za=function(t,e){return t===e},Ja=function(t){var e=t.combine,r=t.destination;return r?r.droppableId:e?e.droppableId:null},dp=function(e){return e.combine?e.combine.draggableId:null},pp=function(e){return e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null};function mp(){var t=Y(function(i,a){return{x:i,y:a}}),e=Y(function(i,a,o,l,c){return{isDragging:!0,isClone:a,isDropAnimating:!!c,dropAnimation:c,mode:i,draggingOver:o,combineWith:l,combineTargetFor:null}}),r=Y(function(i,a,o,l,c,p,m){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:p,mode:a,offset:i,dimension:o,forceShouldAnimate:m,snapshot:e(a,l,c,p,null)}}}),n=function(a,o){if(a.isDragging){if(a.critical.draggable.id!==o.draggableId)return null;var l=a.current.client.offset,c=a.dimensions.draggables[o.draggableId],p=ne(a.impact),m=pp(a.impact),u=a.forceShouldAnimate;return r(t(l.x,l.y),a.movementMode,c,o.isClone,p,m,u)}if(a.phase==="DROP_ANIMATING"){var d=a.completed;if(d.result.draggableId!==o.draggableId)return null;var g=o.isClone,f=a.dimensions.draggables[o.draggableId],y=d.result,x=y.mode,b=Ja(y),v=dp(y),h=a.dropDuration,w={duration:h,curve:Er.drop,moveTo:a.newHomeClientOffset,opacity:v?rt.opacity.drop:null,scale:v?rt.scale.drop:null};return{mapped:{type:"DRAGGING",offset:a.newHomeClientOffset,dimension:f,dropping:w,draggingOver:b,combineWith:v,mode:x,forceShouldAnimate:null,snapshot:e(x,g,b,v,w)}}}return null};return n}function Xa(t){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:t,combineWith:null}}var gp={mapped:{type:"SECONDARY",offset:z,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Xa(null)}};function fp(){var t=Y(function(o,l){return{x:o,y:l}}),e=Y(Xa),r=Y(function(o,l,c){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:o,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:e(l)}}}),n=function(l){return l?r(z,l,!0):null},i=function(l,c,p,m){var u=p.displaced.visible[l],d=!!(m.inVirtualList&&m.effected[l]),g=Tt(p),f=g&&g.draggableId===l?c:null;if(!u){if(!d)return n(f);if(p.displaced.invisible[l])return null;var y=Le(m.displacedBy.point),x=t(y.x,y.y);return r(x,f,!0)}if(d)return n(f);var b=p.displacedBy.point,v=t(b.x,b.y);return r(v,f,u.shouldAnimate)},a=function(l,c){if(l.isDragging)return l.critical.draggable.id===c.draggableId?null:i(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var p=l.completed;return p.result.draggableId===c.draggableId?null:i(c.draggableId,p.result.draggableId,p.impact,p.afterCritical)}return null};return a}var vp=function(){var e=mp(),r=fp(),n=function(a,o){return e(a,o)||r(a,o)||gp};return n},hp={dropAnimationFinished:ka},xp=_n(vp,hp,null,{context:Rr,pure:!0,areStatePropsEqual:Za})(up);function Ka(t){var e=Dt(Mr),r=e.isUsingCloneFor;return r===t.draggableId&&!t.isClone?null:$.createElement(xp,t)}function bp(t){var e=typeof t.isDragDisabled=="boolean"?!t.isDragDisabled:!0,r=!!t.disableInteractiveElementBlocking,n=!!t.shouldRespectForcePress;return $.createElement(Ka,L({},t,{isClone:!1,isEnabled:e,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function yp(t){var e=S.useContext(Ot);e||P();var r=e.contextId,n=e.isMovementAllowed,i=S.useRef(null),a=S.useRef(null),o=t.children,l=t.droppableId,c=t.type,p=t.mode,m=t.direction,u=t.ignoreContainerClipping,d=t.isDropDisabled,g=t.isCombineEnabled,f=t.snapshot,y=t.useClone,x=t.updateViewportMaxScroll,b=t.getContainerForClone,v=A(function(){return i.current},[]),h=A(function(C){i.current=C},[]);A(function(){return a.current},[]);var w=A(function(C){a.current=C},[]),E=A(function(){n()&&x({maxScroll:Oa()})},[n,x]);Jd({droppableId:l,type:c,mode:p,direction:m,isDropDisabled:d,isCombineEnabled:g,ignoreContainerClipping:u,getDroppableRef:v});var T=$.createElement(ep,{on:t.placeholder,shouldAnimate:t.shouldAnimatePlaceholder},function(C){var M=C.onClose,k=C.data,W=C.animate;return $.createElement(_d,{placeholder:k,onClose:M,innerRef:w,animate:W,contextId:r,onTransitionEnd:E})}),I=H(function(){return{innerRef:h,placeholder:T,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,T,h]),N=y?y.dragging.draggableId:null,D=H(function(){return{droppableId:l,type:c,isUsingCloneFor:N}},[l,N,c]);function O(){if(!y)return null;var C=y.dragging,M=y.render,k=$.createElement(Ka,{draggableId:C.draggableId,index:C.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(W,Q){return M(W,Q,C)});return oi.createPortal(k,b())}return $.createElement(Mr.Provider,{value:D},o(I,f),O())}var er=function(e,r){return e===r.droppable.type},Pn=function(e,r){return r.draggables[e.draggable.id]},wp=function(){var e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=L({},e,{shouldAnimatePlaceholder:!1}),n=Y(function(o){return{draggableId:o.id,type:o.type,source:{index:o.index,droppableId:o.droppableId}}}),i=Y(function(o,l,c,p,m,u){var d=m.descriptor.id,g=m.descriptor.droppableId===o;if(g){var f=u?{render:u,dragging:n(m.descriptor)}:null,y={isDraggingOver:c,draggingOverWith:c?d:null,draggingFromThisWith:d,isUsingPlaceholder:!0};return{placeholder:m.placeholder,shouldAnimatePlaceholder:!1,snapshot:y,useClone:f}}if(!l)return r;if(!p)return e;var x={isDraggingOver:c,draggingOverWith:d,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:m.placeholder,shouldAnimatePlaceholder:!0,snapshot:x,useClone:null}}),a=function(l,c){var p=c.droppableId,m=c.type,u=!c.isDropDisabled,d=c.renderClone;if(l.isDragging){var g=l.critical;if(!er(m,g))return r;var f=Pn(g,l.dimensions),y=ne(l.impact)===p;return i(p,u,y,y,f,d)}if(l.phase==="DROP_ANIMATING"){var x=l.completed;if(!er(m,x.critical))return r;var b=Pn(x.critical,l.dimensions);return i(p,u,Ja(x.result)===p,ne(x.impact)===p,b,d)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var v=l.completed;if(!er(m,v.critical))return r;var h=ne(v.impact)===p,w=!!(v.impact.at&&v.impact.at.type==="COMBINE"),E=v.critical.droppable.id===p;return h?w?e:r:E?e:r}return r};return a},Sp={updateViewportMaxScroll:Tc};function Np(){return document.body||P(),document.body}var Cp={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Np},Qa=_n(wp,Sp,null,{context:Rr,pure:!0,areStatePropsEqual:Za})(yp);Qa.defaultProps=Cp;const Dp=t=>{if(!t)return"var(--color-normal)";switch(t){case"WARMUP":return"var(--color-warmup)";case"EASY":return"var(--color-easy)";case"MODERATE":return"var(--color-moderate)";case"HARD":return"var(--color-hard)";default:return"var(--color-moderate)"}},Rn=({exercise:t,onEdit:e,onDelete:r,showActions:n=!0,exerciseNumber:i,subNumber:a,isHidden:o=!1,onToggleVisibility:l})=>{const[c,p]=S.useState(!1),m=S.useRef(null),{state:u,toggleExerciseSelection:d,isExerciseInSuperset:g,startCreating:f}=nt(),y=g(t.id||""),x=u.selectedExercises.includes(t.id||"");S.useEffect(()=>{const E=T=>{m.current&&!m.current.contains(T.target)&&p(!1)};return c&&document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[c]);const b=()=>{t.id&&d(t.id)},v=()=>t.sets.reduce((E,T)=>E+T.weight*T.reps,0),h=()=>{var T,I;return o?s.jsx("div",{className:"text-sm text-gray-300",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[t.activityType&&t.activityType!==j.RESISTANCE&&s.jsx("span",{className:"px-2 py-1 bg-blue-600/20 text-blue-300 text-xs rounded-full",children:t.activityType.charAt(0).toUpperCase()+t.activityType.slice(1)}),s.jsxs("span",{className:"text-gray-400",children:[((T=t.sets)==null?void 0:T.length)||0," set",(((I=t.sets)==null?void 0:I.length)||0)!==1?"s":""]})]}),t.sets&&t.sets.length>0&&t.sets[0].weight&&s.jsxs("span",{className:"text-white font-medium",children:[v(),"kg total"]})]})}):(()=>{var N;if(t.activityType===j.SPEED_AGILITY||t.activityType&&t.activityType!==j.RESISTANCE)return!0;if((N=t.sets)!=null&&N[0]){const D=t.sets[0],O=D.weight&&D.weight>0&&D.reps&&D.reps>1,C=D.duration||D.distance||D.calories||D.averageHeartRate||D.holdTime||D.pace;if(!O&&C)return!0}return!1})()?s.jsxs("div",{className:"text-sm text-gray-300",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsxs("span",{className:"px-2 py-1 bg-blue-600/20 text-blue-300 text-xs rounded-full",children:[(t.activityType||"Unknown").charAt(0).toUpperCase()+(t.activityType||"Unknown").slice(1)," Activity"]})}),t.sets&&t.sets.length>0&&(()=>{const N=t.sets[0],D=O=>O!=null&&O!==""&&!(typeof O=="string"&&O.trim()==="")&&!(typeof O=="number"&&isNaN(O));return s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[D(N.reps)&&(t.activityType===j.SPEED_AGILITY||t.activityType===j.STRETCHING)&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Reps"}),s.jsx("div",{className:"text-white font-medium",children:N.reps})]}),D(N.duration)&&t.activityType!==j.SPEED_AGILITY&&t.activityType!==j.STRETCHING&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Duration"}),s.jsx("div",{className:"text-white font-medium",children:(t.activityType||"unknown")==="endurance"?`${N.duration} min`:`${N.duration} sec`})]}),D(N.distance)&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Distance"}),s.jsx("div",{className:"text-white font-medium",children:(t.activityType||"unknown")==="endurance"?`${N.distance} km`:`${N.distance} m`})]}),D(N.height)&&t.activityType===j.SPEED_AGILITY&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Height"}),s.jsxs("div",{className:"text-white font-medium",children:[N.height," cm"]})]}),D(N.calories)&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Calories"}),s.jsxs("div",{className:"text-white font-medium",children:[N.calories," kcal"]})]}),D(N.holdTime)&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Hold Time"}),s.jsxs("div",{className:"text-white font-medium",children:[N.holdTime,"s"]})]}),D(N.stretchType)&&t.activityType===j.STRETCHING&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Stretch Type"}),s.jsx("div",{className:"text-white font-medium capitalize",children:N.stretchType})]}),D(N.restTime)&&t.activityType===j.SPEED_AGILITY&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Rest Time"}),s.jsxs("div",{className:"text-white font-medium",children:[N.restTime,"s"]})]}),D(N.rpe)&&t.activityType===j.SPEED_AGILITY&&s.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"RPE"}),s.jsxs("div",{className:"text-white font-medium",children:[N.rpe,"/10"]})]})]}),(D(N.heartRate)||D(N.maxHeartRate)||D(N.averageHeartRate))&&s.jsxs("div",{className:"bg-red-900/20 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-red-300 mb-2 font-medium",children:"Heart Rate (Strain)"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[D(N.averageHeartRate)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Avg:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.averageHeartRate," bpm"]})]}),D(N.maxHeartRate)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Max:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.maxHeartRate," bpm"]})]}),D(N.heartRate)&&!D(N.averageHeartRate)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"HR:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.heartRate," bpm"]})]})]})]}),(D(N.hrZone1)||D(N.hrZone2)||D(N.hrZone3)||D(N.hrZone4)||D(N.hrZone5))&&s.jsxs("div",{className:"bg-red-900/20 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-red-300 mb-2 font-medium",children:"HR Zones (Strain Distribution)"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[D(N.hrZone1)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Z1:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.hrZone1,"m"]})]}),D(N.hrZone2)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Z2:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.hrZone2,"m"]})]}),D(N.hrZone3)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Z3:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.hrZone3,"m"]})]}),D(N.hrZone4)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Z4:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.hrZone4,"m"]})]}),D(N.hrZone5)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Z5:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.hrZone5,"m"]})]})]})]}),t.activityType===j.SPEED_AGILITY&&D(N.restTime)&&s.jsxs("div",{className:"bg-red-900/20 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-red-300 mb-2 font-medium",children:"Recovery (Strain)"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-400",children:"Rest Time:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.restTime,"s"]})]})]}),(D(N.rpe)&&t.activityType!==j.SPEED_AGILITY||D(N.intensity)&&t.activityType!==j.SPEED_AGILITY||D(N.performance))&&s.jsxs("div",{className:"bg-yellow-900/20 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-yellow-300 mb-2 font-medium",children:"Intensity"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[D(N.rpe)&&t.activityType!==j.SPEED_AGILITY&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"RPE:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.rpe,"/10"]})]}),D(N.intensity)&&t.activityType!==j.SPEED_AGILITY&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Intensity:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.intensity,"/10"]})]}),D(N.performance)&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-400",children:"Performance:"}),s.jsxs("span",{className:"text-white ml-1",children:[N.performance,"/10"]})]})]})]}),D(N.notes)&&s.jsxs("div",{className:"bg-gray-800/40 rounded-lg p-3 border-l-2 border-blue-500",children:[s.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Performance Notes"}),s.jsx("div",{className:"text-white text-sm",children:N.notes})]})]})})()]}):"sets"in t&&t.sets?s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{className:"flex flex-wrap items-center mb-2",children:t.sets.map((N,D)=>s.jsxs("div",{className:"flex items-center",style:{marginRight:D===t.sets.length-1?0:8},children:[s.jsxs("span",{className:"font-medium whitespace-nowrap",style:{color:Dp(N.difficulty)},children:[N.weight,"kg ",N.reps,"r"]}),D<t.sets.length-1&&s.jsx("span",{className:"text-gray-500 mx-1",children:"|"})]},D))}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-400",children:"Total Volume"}),s.jsxs("span",{className:"text-white",children:[v(),"kg"]})]}),(()=>{const N=C=>C!=null&&C!==""&&!(typeof C=="string"&&C.trim()==="")&&!(typeof C=="number"&&isNaN(C)),D=[];return t.sets.forEach(C=>{N(C.rpe)&&D.push({label:"RPE",value:`${C.rpe}/10`}),N(C.intensity)&&D.push({label:"Intensity",value:`${C.intensity}/10`}),N(C.performance)&&D.push({label:"Performance",value:`${C.performance}/10`}),N(C.restTime)&&D.push({label:"Rest Time",value:`${C.restTime}s`}),N(C.tempo)&&D.push({label:"Tempo",value:C.tempo}),N(C.notes)&&D.push({label:"Performance Notes",value:C.notes})}),D.filter((C,M,k)=>M===k.findIndex(W=>W.label===C.label)).map((C,M)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-400",children:C.label}),s.jsx("span",{className:"text-white",children:C.value})]},M))})()]})]}):s.jsx("div",{className:"text-sm text-gray-300",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-400",children:"Type"}),s.jsx("span",{className:"text-white capitalize",children:t.activityType||"Exercise"})]})})},w=`bg-[#1a1a1a] rounded-lg p-3 transition-all duration-200 ${y?"bg-[#2196F3]/5":x?"bg-[#8B5CF6]/10 border-l-2 border-[#8B5CF6]":"hover:bg-black/20"}`;return s.jsxs("div",{className:w,children:[u.isCreating&&s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",checked:x,onChange:b,className:"w-4 h-4 text-[#8B5CF6] bg-gray-100 border-gray-300 rounded focus:ring-[#8B5CF6] focus:ring-2"}),s.jsx("span",{className:"text-sm text-gray-400",children:"Select for superset"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[i&&s.jsxs("div",{className:"flex items-center justify-center min-w-6 h-6 bg-[#8B5CF6] text-white text-xs font-bold rounded-full px-1.5",children:[i,a?String.fromCharCode(96+a):""]}),s.jsx("h3",{className:"text-base font-medium text-white",children:t.exerciseName}),l&&s.jsx("button",{onClick:l,className:"p-1 hover:bg-white/10 rounded transition-colors","aria-label":o?"Show exercise details":"Hide exercise details",children:s.jsx("svg",{className:`w-4 h-4 text-gray-400 hover:text-white transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),n&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{y||(u.isCreating?b():(f(),t.id&&setTimeout(()=>{d(t.id||"")},50)))},className:`p-2 rounded-lg transition-colors ${y?"bg-[#2196F3] text-white":x?"bg-[#8B5CF6] text-white":"hover:bg-white/10 text-gray-400 hover:text-white"}`,"aria-label":y?"In superset":x?"Selected for superset":"Add to superset",children:y?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.1a3 3 0 004.24-4.24l-1.1-1.102z"})}):x?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),e&&s.jsx("button",{onClick:e,className:"p-2 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Edit exercise",children:s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),r&&s.jsx("button",{onClick:r,className:"p-2 hover:bg-white/10 rounded-lg transition-colors text-red-500","aria-label":"Delete exercise",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m4-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),"      ",s.jsx("div",{className:"mt-3",children:h()})]})},Ep=({exerciseId:t})=>{const{getSupersetByExercise:e,breakSuperset:r,renameSuperset:n}=nt(),[i,a]=S.useState(!1),[o,l]=S.useState(!1),[c,p]=S.useState(""),m=S.useRef(null),u=e(t),d=!!u;S.useEffect(()=>{o&&u&&(p(u.name||"Superset"),setTimeout(()=>{var x;(x=m.current)==null||x.focus()},50))},[o,u]);const g=()=>{u&&(r(u.id),a(!1))},f=()=>{u&&c.trim()&&(n(u.id,c.trim()),l(!1),a(!1))},y=x=>{x.stopPropagation(),l(!0)};return S.useEffect(()=>{const x=b=>{var v;if(i){if(o&&((v=m.current)!=null&&v.contains(b.target)))return;a(!1),l(!1)}};return i&&setTimeout(()=>{document.addEventListener("click",x)},0),()=>{document.removeEventListener("click",x)}},[i,o]),d?s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:x=>{x.stopPropagation(),a(!i)},className:"flex items-center gap-1 px-2 py-1 text-xs text-[#2196F3] bg-[#2196F3]/10 rounded-full hover:bg-[#2196F3]/20 transition-colors","aria-label":"Superset Actions",children:[s.jsx("span",{children:(u==null?void 0:u.name)||"Superset"}),s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&s.jsx("div",{className:"absolute z-20 mt-1 right-0 bg-[#1a1a1a] border border-white/10 rounded-lg shadow-xl p-2 min-w-[180px]",children:o?s.jsxs("div",{className:"p-2",children:[s.jsx("input",{ref:m,type:"text",value:c,onChange:x=>p(x.target.value),className:"w-full px-2 py-1 bg-[#2a2a2a] text-white rounded border border-[#8B5CF6] focus:outline-none",placeholder:"Superset name",maxLength:30,onKeyDown:x=>{x.key==="Enter"?f():x.key==="Escape"&&l(!1)}}),s.jsxs("div",{className:"flex justify-end mt-2 gap-2",children:[s.jsx("button",{onClick:x=>{x.stopPropagation(),l(!1)},className:"text-xs text-gray-400 hover:text-white px-2 py-1 rounded transition-colors",children:"Cancel"}),s.jsx("button",{onClick:x=>{x.stopPropagation(),f()},className:"text-xs bg-[#8B5CF6] text-white px-2 py-1 rounded hover:bg-[#7C3AED] transition-colors",children:"Save"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:x=>{x.stopPropagation(),g()},className:"flex w-full items-center gap-2 px-3 py-2 text-white hover:bg-white/10 rounded transition-colors text-left",children:[s.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Break Superset"]}),s.jsxs("button",{onClick:y,className:"flex w-full items-center gap-2 px-3 py-2 text-white hover:bg-white/10 rounded transition-colors text-left",children:[s.jsx("svg",{className:"w-4 h-4 text-[#8B5CF6]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Rename"]})]})})]}):null},jp=({exercises:t,onEditExercise:e,onDeleteExercise:r,onReorderExercises:n})=>{const{state:i,updateExerciseOrder:a}=nt(),[o,l]=S.useState(new Set),c=u=>{if(!u.destination)return;const d=Array.from(t),[g]=d.splice(u.source.index,1);d.splice(u.destination.index,0,g),n(d);const f=d.map(y=>y.id||"").filter(y=>y!=="");a(f)},p=u=>{l(d=>{const g=new Set(d);return g.has(u)?g.delete(u):g.add(u),g})};S.useEffect(()=>{const u=t.map(d=>d.id||"").filter(d=>d!=="");u.length>0&&a(u)},[t,a]);const m=$.useMemo(()=>{const u=[],d=new Set;return i.supersets.forEach(g=>{const f=[],y=[];g.exerciseIds.forEach(x=>{const b=t.findIndex(v=>v.id===x);b!==-1&&(f.push(t[b]),y.push(b),d.add(x))}),f.length>0&&u.push({superset:g,exercises:f,originalIndices:y})}),t.forEach((g,f)=>{g.id&&!d.has(g.id)&&u.push({superset:null,exercises:[g],originalIndices:[f]})}),u},[t,i.supersets]);return t.length===0?s.jsx("div",{className:"text-center py-8 text-gray-400",children:s.jsx("p",{children:"No exercises logged yet. Start by adding your first exercise!"})}):s.jsx(Ld,{onDragEnd:c,children:s.jsx(Qa,{droppableId:"exercises",children:u=>s.jsxs("div",{...u.droppableProps,ref:u.innerRef,className:"space-y-6",children:[m.map((d,g)=>s.jsx(bp,{draggableId:d.exercises[0].id||`group-${g}`,index:g,children:(f,y)=>{var x;return s.jsxs("div",{ref:f.innerRef,...f.draggableProps,className:`transition-all duration-200 ${y.isDragging?"scale-105 shadow-2xl":""}`,children:[s.jsx("div",{...f.dragHandleProps,className:"mb-2 flex justify-center relative",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full hover:bg-gray-300 cursor-grab active:cursor-grabbing"})}),d.superset?s.jsxs("div",{className:"relative bg-[#1a1a1a] border-l-4 border-[#2196F3] rounded-lg p-3 shadow-md mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 bg-[#2196F3] rounded-full"}),s.jsxs("h3",{className:"text-sm font-medium text-white flex items-center",children:[s.jsx("span",{className:"text-[#2196F3]",children:"Superset:"}),s.jsx("span",{className:"ml-1",children:d.superset.name}),s.jsxs("span",{className:"ml-2 text-xs text-[#2196F3]/70",children:["(",d.exercises.length,")"]})]})]}),((x=d.exercises[0])==null?void 0:x.id)&&s.jsx("div",{className:"flex items-center",children:s.jsx(Ep,{exerciseId:d.exercises[0].id})})]}),s.jsx("div",{className:"space-y-3",children:d.exercises.map((b,v)=>s.jsxs("div",{className:"relative",children:[v<d.exercises.length-1&&s.jsx("div",{className:"absolute -bottom-2 left-4 h-3 w-0.5 bg-[#2196F3]/40"}),s.jsx("div",{className:"transition-all duration-200 hover:bg-black/20 rounded-lg",children:s.jsx(Rn,{exercise:b,exerciseNumber:g+1,subNumber:v+1,onEdit:()=>e(b),onDelete:()=>r(b),showActions:!0,isHidden:o.has(b.id||""),onToggleVisibility:()=>p(b.id||"")})})]},b.id||v))})]}):s.jsx("div",{className:"border-l-4 border-white/20 rounded-lg shadow-sm mb-4",children:s.jsx(Rn,{exercise:d.exercises[0],exerciseNumber:g+1,onEdit:()=>e(d.exercises[0]),onDelete:()=>r(d.exercises[0]),showActions:!0,isHidden:o.has(d.exercises[0].id||""),onToggleVisibility:()=>p(d.exercises[0].id||"")})})]})}},d.exercises[0].id||`group-${g}`)),u.placeholder]})})})},Ip=()=>{const{state:t,cancelCreating:e,createSuperset:r}=nt(),[n,i]=S.useState(""),[a,o]=S.useState(!1);if(!t.isCreating||t.selectedExercises.length===0)return null;const l=()=>{if(t.selectedExercises.length<2){alert("Please select at least 2 exercises to create a superset");return}if(!a){o(!0);return}r(n||void 0),i(""),o(!1)},c=()=>{a?(o(!1),i("")):e()};return s.jsxs("div",{className:"fixed bottom-20 left-1/2 transform -translate-x-1/2 z-50 bg-[#1a1a1a] rounded-lg border border-[#8B5CF6] shadow-lg shadow-[#8B5CF6]/20 p-4 w-11/12 max-w-md",children:[s.jsxs("div",{className:"mb-3 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:"Create Superset"}),s.jsxs("span",{className:"text-sm bg-[#8B5CF6]/20 text-[#8B5CF6] px-2 py-1 rounded-full",children:[t.selectedExercises.length," selected"]})]}),a?s.jsx("div",{className:"mb-3",children:s.jsx("input",{type:"text",placeholder:"Superset name (optional)",value:n,onChange:p=>i(p.target.value),className:"w-full px-3 py-2 bg-[#2a2a2a] text-white rounded-lg border border-gray-600 focus:border-[#8B5CF6] focus:outline-none",maxLength:30,autoFocus:!0})}):s.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Select exercises and save to create a superset"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:l,disabled:t.selectedExercises.length<2,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-[#8B5CF6] text-white rounded-lg hover:bg-[#7C3AED] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),a?"Save Superset":"Save"]}),s.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-4 py-2 bg-[#2a2a2a] text-white rounded-lg hover:bg-[#3a3a3a] transition-colors",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]})]})]})},kp=[{name:"Barbell Back Squat",description:"A fundamental compound exercise for lower body strength",activityType:j.RESISTANCE,category:"compound",primaryMuscles:["quadriceps","glutes","hamstrings"],secondaryMuscles:["core","calves","lower_back"],equipment:["barbell","squat_rack"],instructions:["Position bar on upper back","Feet shoulder-width apart","Lower until thighs parallel to ground","Drive through heels to stand"],tips:["Keep chest up","Maintain neutral spine"],defaultUnit:"kg",isDefault:!0,metrics:{trackWeight:!0,trackReps:!0,trackRPE:!0}},{name:"Deadlift",description:"A fundamental compound exercise for posterior chain strength",activityType:j.RESISTANCE,category:"compound",primaryMuscles:["hamstrings","glutes","lower_back"],secondaryMuscles:["traps","forearms","core"],equipment:["barbell"],instructions:["Stand with feet hip-width apart","Grip bar outside legs","Keep back straight, chest up","Drive through heels and hips"],defaultUnit:"kg",isDefault:!0,metrics:{trackWeight:!0,trackReps:!0,trackRPE:!0}},{name:"Bench Press",description:"A fundamental compound exercise for upper body pushing strength",activityType:j.RESISTANCE,category:"compound",primaryMuscles:["chest","shoulders","triceps"],secondaryMuscles:["core"],equipment:["barbell","bench"],instructions:["Lie on bench with feet on floor","Grip bar slightly wider than shoulders","Lower bar to chest","Press bar up to full extension"],defaultUnit:"kg",isDefault:!0,metrics:{trackWeight:!0,trackReps:!0,trackRPE:!0}}],Tp=[{name:"Football Match",description:"Competitive football/soccer match",activityType:j.SPORT,category:"team_sport",sportType:"football",skillLevel:"intermediate",teamBased:!0,equipment:["football","boots","shin_guards"],primarySkills:["passing","dribbling","shooting","defending"],isDefault:!0,metrics:{trackDuration:!0,trackScore:!0,trackIntensity:!0,trackOpponent:!0,trackPerformance:!0}},{name:"Basketball Training",description:"Basketball skills practice session",activityType:j.SPORT,category:"team_sport",sportType:"basketball",skillLevel:"intermediate",teamBased:!0,equipment:["basketball","basketball_shoes"],primarySkills:["shooting","dribbling","passing","defense"],isDefault:!0,metrics:{trackDuration:!0,trackScore:!1,trackIntensity:!0,trackPerformance:!0}},{name:"Tennis Match",description:"Competitive tennis match",activityType:j.SPORT,category:"racket_sport",sportType:"tennis",skillLevel:"intermediate",teamBased:!1,equipment:["tennis_racket","tennis_balls","tennis_shoes"],primarySkills:["serve","forehand","backhand","volley"],isDefault:!0,metrics:{trackDuration:!0,trackScore:!0,trackIntensity:!0,trackOpponent:!0,trackPerformance:!0}},{name:"Swimming Training",description:"Swimming technique and endurance training",activityType:j.SPORT,category:"aquatic_sport",sportType:"swimming",skillLevel:"intermediate",teamBased:!1,equipment:["goggles","swimsuit","swim_cap"],primarySkills:["freestyle","backstroke","breaststroke","butterfly"],isDefault:!0,metrics:{trackDuration:!0,trackScore:!1,trackIntensity:!0,trackPerformance:!0}}],Pp=[{name:"Hamstring Stretch",description:"Static stretch for hamstring flexibility",activityType:j.STRETCHING,category:"static",stretchType:"static",targetMuscles:["hamstrings"],bodyRegion:["legs"],difficulty:"beginner",instructions:["Sit with one leg extended","Reach forward toward toes","Hold stretch without bouncing","Feel stretch in back of thigh"],isDefault:!0,metrics:{trackDuration:!0,trackHoldTime:!0,trackIntensity:!0,trackFlexibility:!0}},{name:"Shoulder Cross-Body Stretch",description:"Static stretch for shoulder flexibility",activityType:j.STRETCHING,category:"static",stretchType:"static",targetMuscles:["shoulders","rear_deltoids"],bodyRegion:["upper_body"],difficulty:"beginner",instructions:["Pull arm across body","Use opposite hand to assist","Hold stretch gently","Feel stretch in shoulder"],isDefault:!0,metrics:{trackDuration:!0,trackHoldTime:!0,trackIntensity:!0,trackFlexibility:!0}},{name:"Leg Swings",description:"Dynamic leg mobility exercise",activityType:j.STRETCHING,category:"dynamic",stretchType:"dynamic",targetMuscles:["hip_flexors","hamstrings","glutes"],bodyRegion:["legs","hips"],difficulty:"beginner",instructions:["Hold wall or support for balance","Swing leg forward and back","Keep torso upright","Control the movement"],isDefault:!0,metrics:{trackDuration:!0,trackHoldTime:!1,trackIntensity:!0,trackFlexibility:!0}}],Rp=[{name:"Outdoor Running",description:"Running outdoors for cardiovascular fitness",activityType:j.ENDURANCE,category:"running",enduranceType:"running",environment:"outdoor",intensity:"moderate",equipment:["running_shoes","fitness_tracker"],isDefault:!0,metrics:{trackDistance:!0,trackDuration:!0,trackPace:!0,trackHeartRate:!0,trackCalories:!0,trackElevation:!0}},{name:"Treadmill Running",description:"Indoor treadmill running session",activityType:j.ENDURANCE,category:"running",enduranceType:"running",environment:"indoor",intensity:"moderate",equipment:["treadmill","running_shoes"],isDefault:!0,metrics:{trackDistance:!0,trackDuration:!0,trackPace:!0,trackHeartRate:!0,trackCalories:!0}},{name:"Road Cycling",description:"Outdoor road cycling for endurance",activityType:j.ENDURANCE,category:"cycling",enduranceType:"cycling",environment:"outdoor",intensity:"moderate",equipment:["bicycle","helmet","cycling_shoes"],isDefault:!0,metrics:{trackDistance:!0,trackDuration:!0,trackPace:!0,trackHeartRate:!0,trackCalories:!0,trackElevation:!0}},{name:"Stationary Bike",description:"Indoor stationary bike session",activityType:j.ENDURANCE,category:"cycling",enduranceType:"cycling",environment:"indoor",intensity:"moderate",equipment:["stationary_bike"],isDefault:!0,metrics:{trackDistance:!0,trackDuration:!0,trackPace:!0,trackHeartRate:!0,trackCalories:!0}},{name:"Pool Swimming",description:"Swimming laps for cardiovascular fitness",activityType:j.ENDURANCE,category:"swimming",enduranceType:"swimming",environment:"indoor",intensity:"moderate",equipment:["goggles","swimsuit","swim_cap"],isDefault:!0,metrics:{trackDistance:!0,trackDuration:!0,trackPace:!0,trackHeartRate:!0,trackCalories:!0}}],Ap=[{name:"Meditation Session",description:"Mindfulness and meditation practice",activityType:j.OTHER,category:"wellness",customCategory:"mindfulness",customFields:[{fieldId:"duration",label:"Duration",type:"duration",required:!0,unit:"minutes"},{fieldId:"technique",label:"Meditation Technique",type:"select",required:!1,options:["mindfulness","breathing","body_scan","loving_kindness"]},{fieldId:"focus_level",label:"Focus Level",type:"number",required:!1,validation:{min:1,max:10}}],isDefault:!0,metrics:{duration:!0,technique:!0,focus_level:!0}},{name:"Physiotherapy Session",description:"Physical therapy and rehabilitation exercises",activityType:j.OTHER,category:"rehabilitation",customCategory:"therapy",customFields:[{fieldId:"duration",label:"Session Duration",type:"duration",required:!0,unit:"minutes"},{fieldId:"body_part",label:"Target Body Part",type:"select",required:!0,options:["knee","shoulder","back","ankle","wrist","hip"]},{fieldId:"pain_level_before",label:"Pain Level Before",type:"number",required:!1,validation:{min:0,max:10}},{fieldId:"pain_level_after",label:"Pain Level After",type:"number",required:!1,validation:{min:0,max:10}}],isDefault:!0,metrics:{duration:!0,body_part:!0,pain_level_before:!0,pain_level_after:!0}}];j.RESISTANCE+"",j.SPORT+"",j.STRETCHING+"",j.ENDURANCE+"",j.OTHER+"",j.SPEED_AGILITY+"";class Op{async logResistanceExercise(e,r,n,i,a=new Date){const o={activityId:e,activityType:j.RESISTANCE,activityName:r,userId:i,timestamp:a,sets:n.map((c,p)=>({setNumber:p+1,weight:c.weight||0,reps:c.reps||0,rpe:c.rpe,restTime:c.restTime,notes:c.notes}))};return await this.saveActivityLog(o)}async logSportActivity(e,r,n,i,a=new Date){const o={activityId:e,activityType:j.SPORT,activityName:r,userId:i,timestamp:a,sessions:n.map((c,p)=>({sessionNumber:p+1,duration:c.duration||0,distance:c.distance,calories:c.calories,intensity:c.intensity||5,score:c.score,opponent:c.opponent,performance:c.performance||5,skills:c.skills||[],notes:c.notes}))};return await this.saveActivityLog(o)}async logStretchingExercise(e,r,n,i,a=new Date){const o={activityId:e,activityType:j.STRETCHING,activityName:r,userId:i,timestamp:a,stretches:n.map((c,p)=>({setNumber:p+1,duration:c.duration||0,holdTime:c.holdTime,intensity:c.intensity||5,flexibility:c.flexibility||5,stretchType:c.stretchType,bodyPart:c.bodyPart,notes:c.notes}))};return await this.saveActivityLog(o)}async logEnduranceExercise(e,r,n,i,a=new Date){console.log("🏃 Logging endurance exercise with sessions:",n);const o={activityId:e,activityType:j.ENDURANCE,activityName:r,userId:i,timestamp:a,sessions:n.map((c,p)=>(console.log("🏃 Processing endurance session:",c),{sessionNumber:p+1,distance:c.distance,duration:c.duration||0,pace:c.pace,averageHeartRate:c.averageHeartRate||c.averageHR,maxHeartRate:c.maxHeartRate||c.maxHR,calories:c.calories,elevation:c.elevation,rpe:c.rpe,hrZone1:c.hrZone1,hrZone2:c.hrZone2,hrZone3:c.hrZone3,notes:c.notes}))};return console.log("🏃 Final endurance log data:",o),await this.saveActivityLog(o)}async logOtherActivity(e,r,n,i,a=new Date){const o={activityId:e,activityType:j.OTHER,activityName:r,userId:i,timestamp:a,customData:n.map((c,p)=>({sessionNumber:p+1,duration:c.duration,calories:c.calories,heartRate:c.heartRate,intensity:c.intensity,notes:c.notes,customValues:c.customValues||{},...c}))};return await this.saveActivityLog(o)}async logSpeedAgilityExercise(e,r,n,i,a=new Date){console.log("⚡ Logging speed & agility exercise with sessions:",n);const o={activityId:e,activityType:j.SPEED_AGILITY,activityName:r,userId:i,timestamp:a,sessions:n.map((c,p)=>(console.log("⚡ Processing speed & agility session:",c),{sessionNumber:p+1,reps:c.reps||0,time:c.time,distance:c.distance,height:c.height,restTime:c.restTime,rpe:c.rpe||0,notes:c.notes}))};return console.log("⚡ Final speed & agility log data:",o),await this.saveActivityLog(o)}async saveActivityLog(e){const r=`log-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n={...e,id:r},i=JSON.parse(localStorage.getItem("activity-logs")||"[]");return i.push(n),localStorage.setItem("activity-logs",JSON.stringify(i)),console.log("Activity log saved:",n),r}async getActivityLogs(e,r,n,i){let o=JSON.parse(localStorage.getItem("activity-logs")||"[]").filter(l=>l.userId===e);return r&&(o=o.filter(l=>new Date(l.timestamp)>=r)),n&&(o=o.filter(l=>new Date(l.timestamp)<=n)),i&&(o=o.filter(l=>l.activityType===i)),o.map(l=>({...l,timestamp:new Date(l.timestamp)}))}async deleteActivityLog(e,r){try{const i=JSON.parse(localStorage.getItem("activity-logs")||"[]").filter(a=>!(a.id===e&&a.userId===r));return localStorage.setItem("activity-logs",JSON.stringify(i)),!0}catch(n){return console.error("Error deleting activity log:",n),!1}}}const Mp=new Op;function Lp(t){var r,n,i;console.log("🔄 Converting activity log:",{activityType:t.activityType,activityName:t.activityName,rawLog:t});const e={id:t.id,exerciseName:t.activityName,timestamp:t.timestamp,userId:t.userId,sets:[],activityType:t.activityType,activityData:t};if(t.activityType===j.RESISTANCE)e.sets=t.sessions||[];else if(t.activityType===j.SPORT){const a=t;e.sets=((r=a.sessions)==null?void 0:r.map((o,l)=>({setNumber:l+1,duration:o.duration,distance:o.distance,calories:o.calories,intensity:o.intensity,score:o.score,notes:o.notes,...o.opponent&&{opponent:o.opponent},...o.performance&&{performance:o.performance},...o.skills&&{skills:o.skills}})))||[]}else if(t.activityType===j.STRETCHING){const a=t,o=a.stretches||a.sessions||[];e.sets=o.map((l,c)=>({setNumber:c+1,reps:l.reps,intensity:l.intensity,notes:l.notes,...l.holdTime&&{holdTime:l.holdTime},...l.flexibility&&{flexibility:l.flexibility},...l.stretchType&&{stretchType:l.stretchType},...l.bodyPart&&{bodyPart:l.bodyPart}}))||[]}else if(t.activityType===j.ENDURANCE){const a=t;e.sets=((n=a.sessions)==null?void 0:n.map((o,l)=>({setNumber:l+1,duration:o.duration,...o.distance&&{distance:o.distance},...o.pace&&{pace:o.pace},...o.averageHeartRate&&{averageHeartRate:o.averageHeartRate},...o.averageHR&&{averageHeartRate:o.averageHR},...o.maxHeartRate&&{maxHeartRate:o.maxHeartRate},...o.maxHR&&{maxHeartRate:o.maxHR},...o.calories&&{calories:o.calories},...o.elevation&&{elevation:o.elevation},...o.rpe&&{rpe:o.rpe},...o.hrZone1&&{hrZone1:o.hrZone1},...o.hrZone2&&{hrZone2:o.hrZone2},...o.hrZone3&&{hrZone3:o.hrZone3},notes:o.notes})))||[]}else if(t.activityType===j.OTHER){const a=t,o=a.customData||a.sessions||[];e.sets=o.map((l,c)=>({setNumber:c+1,duration:l.duration,...l.calories&&{calories:l.calories},...l.heartRate&&{heartRate:l.heartRate},...l.intensity&&{intensity:l.intensity},notes:l.notes,...l.customValues&&l.customValues,...Object.keys(l).reduce((p,m)=>(["sessionNumber","duration","calories","heartRate","intensity","notes","customValues"].includes(m)||(p[m]=l[m]),p),{})}))||[]}else if(t.activityType===j.SPEED_AGILITY){const a=t;e.sets=((i=a.sessions)==null?void 0:i.map((o,l)=>({setNumber:l+1,reps:o.reps,...o.distance&&{distance:o.distance},...o.height&&{height:o.height},...o.restTime&&{restTime:o.restTime},rpe:o.rpe,notes:o.notes})))||[]}return console.log("✅ Converted data result:",{id:e.id,exerciseName:e.exerciseName,activityType:e.activityType,sets:e.sets,firstSet:e.sets[0]}),e}async function An(t,e){try{const r=new Date(t);r.setHours(0,0,0,0);const n=new Date(t);n.setHours(23,59,59,999);const a=(await Vr(e,r,n)).map(p=>({id:p.id,exerciseName:p.exerciseName,timestamp:p.timestamp||t,userId:p.userId||e,sets:p.sets||[],deviceId:p.deviceId,activityType:p.activityType||j.RESISTANCE})),l=(await Mp.getActivityLogs(e,r,n)).map(Lp);return[...a,...l].sort((p,m)=>{var g,f;const u=((g=p.timestamp)==null?void 0:g.getTime())||0,d=((f=m.timestamp)==null?void 0:f.getTime())||0;return u-d})}catch(r){console.error("Error getting all exercises by date:",r);try{const n=new Date(t);n.setHours(0,0,0,0);const i=new Date(t);return i.setHours(23,59,59,999),(await Vr(e,n,i)).map(o=>({id:o.id,exerciseName:o.exerciseName,timestamp:o.timestamp||t,userId:o.userId||e,sets:o.sets||[],deviceId:o.deviceId,activityType:o.activityType||j.RESISTANCE}))}catch(n){return console.error("Fallback also failed:",n),[]}}}async function Bp(t,e){try{console.log("🗑️ Starting dual deletion for exercise:",{id:t.id,exerciseName:t.exerciseName,activityType:t.activityType});let r=!1,n=!1,i=[];if(t.id)try{await Ri(t.id,e),r=!0,console.log("✅ Deleted from Firestore:",t.id)}catch(o){const l=o instanceof Error?o.message:"Unknown Firestore error";i.push(`Firestore: ${l}`),console.warn("⚠️ Firestore deletion failed:",l)}try{const l=Ke().filter(c=>c.id!==t.id);if(localStorage.setItem("exerciseLogs",JSON.stringify(l)),t.activityType&&t.activityType!==j.RESISTANCE){const p=JSON.parse(localStorage.getItem("activity-logs")||"[]").filter(m=>!(m.id===t.id&&m.userId===e));localStorage.setItem("activity-logs",JSON.stringify(p))}n=!0,console.log("✅ Deleted from localStorage:",t.id)}catch(o){const l=o instanceof Error?o.message:"Unknown localStorage error";i.push(`localStorage: ${l}`),console.warn("⚠️ localStorage deletion failed:",l)}const a=r||n;return a?(console.log("✅ Exercise deletion completed:",{firestoreDeleted:r,localStorageDeleted:n,exerciseId:t.id}),i.length>0&&console.warn("⚠️ Some deletions failed but exercise was removed from at least one location:",i)):console.error("❌ Exercise deletion failed completely:",i),a}catch(r){return console.error("❌ Error in deleteExercise:",r),!1}}const Fp=()=>{const t=si(),{user:e}=Ie(R=>R.auth),{removeExerciseFromSuperset:r,loadSupersetsForDate:n,saveSupersetsForDate:i}=nt(),a=S.useCallback(R=>{const B=new Date(R);return B.setHours(0,0,0,0),B},[]),o=S.useCallback((R,B)=>{const F=a(R),q=a(B);return F.getTime()===q.getTime()},[a]),l=S.useCallback(R=>{const B=a(R),F=new Date(B);return F.setHours(23,59,59,999),{startOfDay:B,endOfDay:F}},[a]),[c,p]=S.useState({showLogOptions:!1,showCalendar:!1,showSetLogger:!1,showImportModal:!1,showExportModal:!1,showWorkoutSummary:!1,showMenu:!1,showProgramModal:!1}),m=S.useCallback((R,B)=>{p(F=>({...F,[R]:B}))},[]),u=S.useCallback(R=>{m("showCalendar",R??!c.showCalendar)},[c.showCalendar,m]),[d,g]=S.useState(()=>a(new Date)),[f,y]=S.useState([]),[x,b]=S.useState(!1),[v,h]=S.useState(null),[w,E]=S.useState(null),T=S.useCallback((R,B)=>({id:R.id??Hr(),exerciseName:R.exerciseName,sets:R.sets,timestamp:new Date(R.timestamp),userId:B,deviceId:R.deviceId||localStorage.getItem("device_id")||""}),[]),I=S.useCallback(async R=>{const B=e==null?void 0:e.id;if(!B){b(!1),y([]);return}const F=a(R);b(!0);const q=F.toISOString().split("T")[0];n(q);try{const V=await An(F,B),{startOfDay:J,endOfDay:de}=l(F),ie=dr(jt(ve,"users",B,"exercises"),gt("timestamp",">=",J),gt("timestamp","<=",de)),ke=(await pr(ie)).docs.map(ee=>{const te=ee.data();return T({id:ee.id,exerciseName:te.exerciseName,sets:te.sets,timestamp:te.timestamp.toDate(),deviceId:te.deviceId},B)}).filter(ee=>!V.some(te=>te.id===ee.id)),Te=[...V,...ke];Te.sort((ee,te)=>ee.timestamp instanceof Date&&te.timestamp instanceof Date?ee.timestamp.getTime()-te.timestamp.getTime():0),y(Te)}catch(V){console.error("Error fetching exercises:",V);try{const J=await An(F,B);y(J)}catch(J){console.error("Error in fallback:",J);const de=yi(F).map(ie=>T(ie,B));y(de)}}finally{b(!1)}},[e==null?void 0:e.id,o,a,l,T,n]);S.useEffect(()=>{d||g(new Date)},[d]);const N=S.useCallback(async R=>{const B=a(R);B&&(b(!0),g(B),await I(B),u(!1))},[a,I,u]);S.useEffect(()=>{e!=null&&e.id&&I(d)},[e==null?void 0:e.id,I,d]);const D=S.useCallback(R=>{u(!1)},[u]),O=S.useCallback(()=>{h(null),m("showSetLogger",!1)},[m]),C=S.useCallback(async(R,B)=>{if(!v||!(e!=null&&e.id)){console.error("Cannot save sets: missing exercise or user");return}try{console.log("💾 Saving sets for exercise:",{exerciseId:B,exerciseName:v.exerciseName,setCount:R.length});const F={...v,id:B||Hr(),sets:R,timestamp:d},q=await pe({exerciseName:F.exerciseName,userId:e.id,sets:R},d,F.id);console.log("✅ Exercise saved to Firestore successfully"),await Ur({...F,id:q,userId:e.id}),console.log("✅ Exercise saved to local storage"),O(),await I(d)}catch(F){console.error("❌ Error saving exercise sets:",F),alert("Failed to save exercise sets. Please try again.")}},[v,e,d,O,I]),M=async R=>{if(!(e!=null&&e.id)){console.error("Cannot delete exercise: missing user ID",{userId:e==null?void 0:e.id}),alert("Cannot delete exercise: user not authenticated");return}if(window.confirm("Are you sure you want to delete this exercise?")){y(B=>B.filter(F=>F.id!==R.id));try{if(console.log("🗑️ Attempting to delete exercise:",{exerciseId:R.id,userId:e.id,exerciseName:R.exerciseName,timestamp:R.timestamp,activityType:R.activityType}),await Bp(R,e.id))console.log("✅ Exercise deleted successfully"),R.id&&r(R.id),await I(d);else throw new Error("Delete operation returned false")}catch(B){console.error("❌ Error deleting exercise:",B),y(q=>[...q,R]);const F=B instanceof Error?B.message:"Unknown error occurred";alert(`Failed to delete exercise: ${F}`),await I(d)}}},k=S.useCallback(async(R,B,F="both")=>{try{await vs(void 0,R,B,F)}catch(q){console.error("Export failed:",q),alert("Export failed. Please try again.")}},[]),W=R=>{E(R),m("showLogOptions",!0)},Q=S.useCallback(R=>{y(R);const B=d.toISOString().split("T")[0],F=new Date(d);F.setHours(12,0,0,0),R.forEach((q,V)=>{if(!q.id||!(e!=null&&e.id))return;const J=new Date(F);J.setMilliseconds(V*100);const de={...q,timestamp:J,userId:e.id,id:q.id};Ur(de)}),i(B),console.log("✅ Exercise order saved")},[d,e,i]),_=S.useCallback(R=>R?R.toLocaleDateString("no-NO",{day:"numeric",month:"long"}).toLowerCase():"",[]),ge=async R=>{var F;const B=(F=R.target.files)==null?void 0:F[0];if(!(!B||!(e!=null&&e.id)))try{const q=await hs(B);q&&q.length>0&&y(V=>[...V,...q.map(J=>T(J,e.id))]),m("showImportModal",!1)}catch(q){console.error("Error importing data:",q)}};return S.useEffect(()=>{if(e!=null&&e.id&&d){const R=setTimeout(()=>{I(d)},50);return()=>clearTimeout(R)}else y([]),b(!1)},[d,e==null?void 0:e.id]),S.useEffect(()=>{v&&!o(v.timestamp,d)&&O()},[d,v,o,O]),S.useEffect(()=>{console.log("Auth state:",{isAuthenticated:!!e,userId:e==null?void 0:e.id,hasRequiredFields:e?{hasId:!!e.id,hasEmail:!!e.email,hasFirstName:!!e.firstName,hasLastName:!!e.lastName,hasRole:!!e.role}:null})},[e]),s.jsxs("div",{className:"relative min-h-screen bg-black",children:[s.jsxs("header",{className:"flex items-center justify-between px-4 py-4 bg-black/95 backdrop-blur-sm fixed top-0 left-0 right-0 z-50 border-b border-white/10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",onClick:()=>p(R=>({...R,showMenu:!0})),"aria-label":"Open menu",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),s.jsx("h1",{className:"text-white text-xl font-medium",children:_(d)})]}),s.jsxs("div",{className:"flex items-center",children:["          ",s.jsx("button",{onClick:()=>u(),className:`p-2 rounded-lg transition-colors ${c.showCalendar?"bg-white/10":"hover:bg-white/10"}`,"aria-label":"Open calendar","aria-expanded":c.showCalendar,children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})]}),s.jsx("main",{className:"px-4 pb-24 pt-20",children:s.jsxs("div",{className:"relative flex flex-col h-full",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Exercise Log - ",d.toLocaleDateString()]}),s.jsx("button",{onClick:()=>u(),className:"px-4 py-2 text-white rounded-lg transition-colors","aria-label":"Toggle calendar","aria-expanded":c.showCalendar,children:c.showCalendar?"Hide Calendar":"Show Calendar"})]}),s.jsx("div",{className:"flex-grow",children:x?s.jsx("div",{className:"flex justify-center items-center h-32",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#8B5CF6]"})}):f.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-400",children:[s.jsx("p",{className:"text-lg",children:"No exercises logged for this date"}),s.jsx("button",{onClick:()=>m("showLogOptions",!0),className:"mt-4 px-4 py-2 bg-[#8B5CF6] hover:bg-[#7C3AED] text-white rounded-lg transition-colors",children:"Add Exercise"})]}):s.jsx("div",{className:"space-y-4",children:s.jsx(jp,{exercises:f,onEditExercise:W,onDeleteExercise:M,onReorderExercises:Q})})})]})}),c.showCalendar&&s.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50",children:["          ",s.jsx(Xi,{onClose:()=>u(!1),onSelectExercises:D,onDateSelect:N,selectedDate:d})]}),s.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:s.jsx("button",{onClick:()=>m("showLogOptions",!0),className:"w-16 h-16 bg-[#8B5CF6] hover:bg-[#7C3AED] rounded-full flex items-center justify-center text-white shadow-lg transition-colors","aria-label":"Add Exercise",children:s.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}),c.showProgramModal&&s.jsx(li,{isOpen:c.showProgramModal,onClose:()=>p(R=>({...R,showProgramModal:!1})),onSave:()=>p(R=>({...R,showProgramModal:!1}))}),s.jsx(xs,{isOpen:c.showExportModal,onClose:()=>m("showExportModal",!1),onExport:k}),s.jsx(Ip,{}),s.jsx(ai,{isOpen:c.showMenu,onClose:()=>m("showMenu",!1),onImport:()=>m("showImportModal",!0),onExport:()=>m("showExportModal",!0),onShowWorkoutSummary:()=>m("showWorkoutSummary",!0),onNavigateToday:()=>g(new Date),onNavigatePrograms:()=>{t("/programs")},onNavigateExercises:()=>{t("/exercises")}}),c.showLogOptions&&s.jsx("div",{className:"fixed inset-0 bg-black/90 z-50",children:s.jsx(Ji,{onClose:()=>{m("showLogOptions",!1),E(null)},onExerciseAdded:()=>{I(d),E(null)},selectedDate:d,editingExercise:w})}),c.showSetLogger&&v&&v.id&&s.jsx("div",{className:"fixed inset-0 bg-black/90 z-50",children:s.jsx(ss,{exercise:{id:v.id,name:v.exerciseName,sets:v.sets.map(R=>({reps:R.reps,weight:R.weight||0,difficulty:R.difficulty}))},onSave:C,onCancel:()=>m("showSetLogger",!1),isEditing:!0,previousSet:v.sets.length>0?v.sets[v.sets.length-1]:void 0,showPreviousSets:!0,useExerciseId:!0})}),c.showImportModal&&s.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-[#1a1a1a] rounded-xl p-6 max-w-md w-full border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl text-white font-medium",children:"Import Exercise Data"}),s.jsx("button",{onClick:()=>m("showImportModal",!1),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("p",{className:"text-gray-300 mb-4",children:"Select a JSON backup file to import your exercise data."}),s.jsx("div",{className:"mb-6",children:s.jsx("input",{type:"file",accept:".json",onChange:ge,className:"block w-full text-white p-3 rounded-xl bg-[#2a2a2a] border border-white/10 focus:outline-none focus:border-[#8B5CF6]"})}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:()=>m("showImportModal",!1),className:"px-6 py-3 bg-[#2a2a2a] text-white rounded-xl hover:bg-[#3a3a3a] transition-colors",children:"Cancel"})})]})}),c.showWorkoutSummary&&f.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black/90 z-50",children:s.jsx(cs,{exercises:f.map(R=>({id:R.id||"temp-id",exerciseName:R.exerciseName,sets:R.sets,timestamp:R.timestamp})),onClose:()=>m("showWorkoutSummary",!1)})})]})},zp=()=>s.jsx(ni,{fallback:s.jsx("div",{className:"text-white p-4",children:"Error loading exercises. Please try again."}),children:s.jsx(Ti,{children:s.jsx(Fp,{})})});export{zp as default};
//# sourceMappingURL=ExerciseLog-DEcIf9Jp.js.map
