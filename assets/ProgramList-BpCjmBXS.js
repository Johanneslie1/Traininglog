import{j as e,E,g as L}from"./index-CwklxJwA.js";import{b as l,d as D}from"./react-vendor-DQubVtpq.js";import{P as F}from"./ProgramModal-B2E4SvE3.js";import{F as S,a as M,P as U}from"./ProgramBuilder-9c_VX2pN.js";import{F as k}from"./ExerciseHistoryPicker-BOb1YIKN.js";import{j as B}from"./firebase-vendor-C56ojj1e.js";import"./CreateExerciseDialog-BzC3l2rX.js";import"./auth-D3eg-LZj.js";import"./localStorageUtils-B-xqxCNH.js";function $(c,x){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:x},c),l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}))}const z=l.forwardRef($);function I(c,x){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:x},c),l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const O=l.forwardRef(I),R=({onClose:c,onUseTemplate:x})=>{const[g,f]=l.useState([]),[i,v]=l.useState(null),[y,h]=l.useState(!1);l.useEffect(()=>{N()},[]);const N=()=>{try{const s=localStorage.getItem("program-templates");if(s){const r=JSON.parse(s);f(r.sort((a,p)=>new Date(p.createdAt).getTime()-new Date(a.createdAt).getTime()))}}catch(s){console.error("Error loading templates:",s)}},b=s=>{if(confirm("Are you sure you want to delete this template?"))try{const r=g.filter(a=>a.id!==s);localStorage.setItem("program-templates",JSON.stringify(r)),f(r),(i==null?void 0:i.id)===s&&(v(null),h(!1))}catch(r){console.error("Error deleting template:",r),alert("Failed to delete template")}},P=s=>{try{const r={...s,id:Date.now().toString(),name:`${s.name} (Copy)`,createdAt:new Date().toISOString()},a=[...g,r];localStorage.setItem("program-templates",JSON.stringify(a)),f(a.sort((p,C)=>new Date(C.createdAt).getTime()-new Date(p.createdAt).getTime()))}catch(r){console.error("Error duplicating template:",r),alert("Failed to duplicate template")}},w=s=>{x(s.exercises)},j=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),u=s=>{v(s),h(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-60 z-50",children:e.jsxs("div",{className:"bg-[#23272F] rounded-lg w-full max-w-4xl h-5/6 flex flex-col shadow-xl",children:[e.jsxs("div",{className:"p-6 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Program Templates"}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-white text-2xl",children:"×"})]}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Use saved templates to quickly create new programs"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:g.length===0?e.jsxs("div",{className:"text-center text-gray-400 py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-700 rounded-lg flex items-center justify-center",children:e.jsx(k,{className:"w-8 h-8"})}),e.jsx("p",{className:"text-lg mb-2",children:"No templates saved yet"}),e.jsx("p",{className:"text-sm",children:"Create a program and save it as a template to see it here"})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.map(s=>e.jsxs("div",{className:"bg-[#181A20] rounded-lg p-4 border border-white/10 hover:border-white/20 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-medium text-lg mb-1",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:[s.exercises.length," exercise",s.exercises.length!==1?"s":""]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Created ",j(s.createdAt)]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Exercises:"}),e.jsxs("div",{className:"space-y-1",children:[s.exercises.slice(0,3).map((r,a)=>e.jsxs("div",{className:"text-sm text-gray-300 truncate",children:["• ",r.exercise.name]},a)),s.exercises.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",s.exercises.length-3," more..."]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>w(s),className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 flex items-center justify-center gap-1",children:[e.jsx(O,{className:"w-4 h-4"}),"Use"]}),e.jsx("button",{onClick:()=>u(s),className:"px-3 py-2 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:"Preview"}),e.jsx("button",{onClick:()=>P(s),className:"px-3 py-2 bg-green-600 text-white rounded text-sm hover:bg-green-700",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(s.id),className:"px-3 py-2 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:e.jsx(S,{className:"w-4 h-4"})})]})]},s.id))})}),e.jsx("div",{className:"p-6 border-t border-white/10",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:c,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})})})]})}),y&&i&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-60",children:e.jsxs("div",{className:"bg-[#23272F] rounded-lg w-full max-w-2xl max-h-5/6 flex flex-col shadow-xl",children:[e.jsx("div",{className:"p-6 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:i.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[i.exercises.length," exercises • Created ",j(i.createdAt)]})]}),e.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white text-2xl",children:"×"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"space-y-4",children:i.exercises.map((s,r)=>e.jsxs("div",{className:"bg-[#181A20] rounded-lg p-4 border border-white/10",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:s.exercise.name}),e.jsx("div",{className:"space-y-2",children:s.sets.map((a,p)=>e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400 w-8",children:["#",p+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-white",children:[a.weight||0,"kg"]}),e.jsx("span",{className:"text-gray-400",children:"×"}),e.jsxs("span",{className:"text-white",children:[a.reps||0," reps"]}),a.difficulty&&e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-700 text-gray-300 rounded",children:a.difficulty})]})]},p))}),s.exercise.description&&e.jsx("div",{className:"mt-3 text-sm text-gray-400",children:s.exercise.description})]},r))})}),e.jsx("div",{className:"p-6 border-t border-white/10",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Close"}),e.jsx("button",{onClick:()=>{w(i),h(!1)},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Use This Template"})]})})]})})]})},J={Any:"bg-gray-500",Beginner:"bg-green-600",Intermediate:"bg-yellow-600",Advanced:"bg-red-600"},V=({onSelect:c})=>{const x=D(),{programs:g,addProgram:f,refresh:i,deleteProgram:v}=L(),[y,h]=l.useState(!1),[N,b]=l.useState(!1),[P,w]=l.useState(!1),[j,u]=l.useState(null),[s,r]=l.useState(null),a=B(),p=async t=>{u(null);const n=a.currentUser;if(!n){u("You must be logged in to create a program");return}const d={name:t.name,description:t.description||"",level:t.level.toLowerCase(),createdBy:n.uid,sessions:[],isPublic:!1,tags:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};console.log("[ProgramList] Creating new program:",d);try{await f(d),console.log("[ProgramList] Program created successfully"),h(!1),await i();const o=g.find(m=>m.name===t.name&&m.userId===n.uid&&m.createdBy===n.uid);o?x(`/programs/${o.id}`):console.log("[ProgramList] Created program not found in list, staying on programs page")}catch(o){const m=o instanceof Error?o.message:"Failed to create program";console.error("[ProgramList] Error in handleAdd:",o),u(m)}},C=async t=>{try{console.log("[ProgramList] Creating program from builder:",t),await f(t),b(!1),await i();const n=g.find(d=>{var o,m;return d.name===t.name&&d.userId===((o=a.currentUser)==null?void 0:o.uid)&&d.createdBy===((m=a.currentUser)==null?void 0:m.uid)});n&&x(`/programs/${n.id}`)}catch(n){const d=n instanceof Error?n.message:"Failed to create program";console.error("Error creating program from builder:",n),u(d)}},T=t=>{w(!1),b(!0),console.log("Using template with exercises:",t)},A=async(t,n,d)=>{if(d.stopPropagation(),window.confirm(`Are you sure you want to delete the program "${n}"? This action cannot be undone.`)){r(t),u(null);try{console.log("[ProgramList] Deleting program:",t),await v(t),console.log("[ProgramList] Program deleted successfully"),await i()}catch(o){const m=o instanceof Error?o.message:"Failed to delete program";console.error("[ProgramList] Error deleting program:",o),u(m)}finally{r(null)}}};return e.jsxs("div",{className:"relative min-h-screen pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Programs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Templates"]}),e.jsxs("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Builder"]})]})]}),j&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:j}),g.length===0?e.jsx("div",{className:"text-center p-8 text-gray-500",children:"No programs found. Click the + button to create one."}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:g.map(t=>e.jsxs("div",{className:"relative bg-[#23272F] rounded-xl p-4 flex flex-col items-start justify-between min-h-[120px] shadow-md cursor-pointer overflow-hidden group",onClick:()=>c?c(t.id):x(`/programs/${t.id}`),children:[e.jsx("div",{className:"absolute right-3 top-3 opacity-20 text-5xl pointer-events-none select-none",children:e.jsx("span",{role:"img","aria-label":"kettlebell",children:"🏋️‍♂️"})}),e.jsx("button",{onClick:n=>A(t.id,t.name,n),disabled:s===t.id,className:"absolute top-2 left-2 p-1.5 bg-red-600/80 hover:bg-red-500 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-200 z-20 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete program","aria-label":`Delete program ${t.name}`,children:s===t.id?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(S,{className:"w-4 h-4"})}),e.jsx("div",{className:"font-semibold text-lg text-white mb-1 z-10",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 z-10",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs text-white ${J[t.level.charAt(0).toUpperCase()+t.level.slice(1)]||"bg-gray-700"}`,children:t.level.charAt(0).toUpperCase()+t.level.slice(1)}),t.sessions&&t.sessions.length>0&&e.jsxs("span",{className:"text-gray-400 text-xs",children:[t.sessions.length," session",t.sessions.length!==1?"s":""]})]}),t.description&&e.jsx("div",{className:"text-gray-400 text-xs mt-2 z-10 line-clamp-2",children:t.description})]},t.id))}),e.jsx("button",{className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-500 text-white rounded-full w-14 h-14 flex items-center justify-center text-3xl shadow-lg z-50",onClick:()=>h(!0),"aria-label":"Add Program",children:"+"}),e.jsx(F,{isOpen:y,onClose:()=>{h(!1),u(null)},onSave:p}),N&&e.jsx(U,{onClose:()=>b(!1),onSave:C}),P&&e.jsx(R,{onClose:()=>w(!1),onUseTemplate:T})]})},_=c=>e.jsx(E,{fallback:e.jsx("div",{className:"text-white p-4",children:"Error loading programs. Please try again."}),children:e.jsx(V,{...c})});export{_ as default};
//# sourceMappingURL=ProgramList-BpCjmBXS.js.map
