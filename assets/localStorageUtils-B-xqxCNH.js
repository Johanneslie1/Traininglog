import{a as y}from"./index-CwklxJwA.js";import"./firebase-vendor-C56ojj1e.js";const n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function p(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}let i;const D=new Uint8Array(16);function I(){if(!i){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");i=crypto.getRandomValues.bind(crypto)}return i(D)}const S=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),m={randomUUID:S};function u(e,t,r){var o;if(m.randomUUID&&!e)return m.randomUUID();e=e||{};const s=e.random??((o=e.rng)==null?void 0:o.call(e))??I();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,p(s)}const c="exercise_logs",x=e=>{const t=new Date(e);t.setHours(0,0,0,0);const r=new Date(e);return r.setHours(23,59,59,999),{startOfDay:t,endOfDay:r}},w=()=>{let e=localStorage.getItem("device_id");return e||(e=u(),localStorage.setItem("device_id",e)),e},d=()=>{const e=localStorage.getItem(c);if(!e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t.map(r=>({...r,timestamp:new Date(r.timestamp)})):[]}catch(t){return console.error("Error parsing exercise logs:",t),[]}},L=e=>{const t=d(),{startOfDay:r,endOfDay:s}=x(e);return t.filter(o=>{const a=new Date(o.timestamp);return a>=r&&a<=s})},O=e=>{var g;const t=d(),r={...e,id:e.id||u(),deviceId:e.deviceId||w(),timestamp:e.timestamp||new Date,userId:((g=y.currentUser)==null?void 0:g.uid)||"anonymous"},s={...r,timestamp:r.timestamp instanceof Date?r.timestamp.toISOString():new Date(r.timestamp).toISOString()},o=t.findIndex(l=>l.id===e.id);let a;return o!==-1?a=[...t.slice(0,o),s,...t.slice(o+1)]:a=[...t,s],localStorage.setItem(c,JSON.stringify(a)),r},b=e=>{const r=d().filter(s=>s.id!==e);localStorage.setItem(c,JSON.stringify(r))};export{L as a,b as d,d as g,O as s,u as v};
//# sourceMappingURL=localStorageUtils-B-xqxCNH.js.map
