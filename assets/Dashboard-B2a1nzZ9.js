const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/unifiedExerciseUtils-_WvBlEod.js","assets/index-CwklxJwA.js","assets/react-vendor-DQubVtpq.js","assets/firebase-vendor-C56ojj1e.js","assets/index-BzF0zcID.css","assets/localStorageUtils-B-xqxCNH.js"])))=>i.map(i=>d[i]);
import{u as b,j as e,_ as k}from"./index-CwklxJwA.js";import{d as N,b as i}from"./react-vendor-DQubVtpq.js";import{g as D,E,d as C}from"./unifiedExerciseUtils-_WvBlEod.js";import"./firebase-vendor-C56ojj1e.js";import"./localStorageUtils-B-xqxCNH.js";const S=()=>{const m=N(),s=b(t=>t.auth.user),[g,c]=i.useState([]),[a,y]=i.useState(new Date),[j,d]=i.useState(!0),[p,n]=i.useState(null),h=i.useCallback(t=>{const r=new Date(t);return r.setHours(0,0,0,0),r},[]),u=i.useCallback(async t=>{if(d(!0),n(null),!(s!=null&&s.id)){c([]),d(!1);return}const r=h(t);try{const o=await D(r,s.id);console.log("📊 Dashboard loaded exercises:",{date:r,totalCount:o.length,byType:o.reduce((l,f)=>(l[f.activityType||"resistance"]=(l[f.activityType||"resistance"]||0)+1,l),{}),exercises:o}),c(o)}catch(o){console.error("Error fetching exercises:",o),n("Failed to load exercises"),c([])}finally{d(!1)}},[h,s==null?void 0:s.id]);i.useEffect(()=>{s!=null&&s.id?u(a):(c([]),d(!1))},[s==null?void 0:s.id,a]);const x=i.useCallback(t=>{const r=h(t);y(r)},[h]),v=t=>t.toLocaleDateString("no-NO",{day:"numeric",month:"long"}),w=async t=>{if(!t.id||!(s!=null&&s.id)){const r="Cannot delete exercise: missing user ID or exercise ID";console.error(r,{userId:s==null?void 0:s.id,exerciseId:t.id}),n(r);return}if(window.confirm(`Are you sure you want to delete "${t.exerciseName}"?`))try{if(console.log("🗑️ Attempting to delete exercise:",{exerciseId:t.id,userId:s.id,activityType:t.activityType}),t.activityType&&t.activityType!=="resistance"){const{deleteActivityLog:r}=await k(async()=>{const{deleteActivityLog:o}=await import("./unifiedExerciseUtils-_WvBlEod.js").then(l=>l.c);return{deleteActivityLog:o}},__vite__mapDeps([0,1,2,3,4,5]));await r(t.id,s.id),console.log("✅ Activity log deleted successfully")}else await C(t,s.id),console.log("✅ Exercise deleted from Firestore successfully");await u(a)}catch(r){console.error("❌ Error deleting exercise:",r);const o=r instanceof Error?r.message:"An unknown error occurred";n(`Failed to delete exercise: ${o}`),await u(a)}};return j?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"p-4 bg-black min-h-screen text-white",children:[p&&e.jsxs("div",{className:"bg-red-500 text-white p-4 rounded-lg mb-4 flex justify-between items-center",children:[e.jsx("span",{children:p}),e.jsx("button",{onClick:()=>n(null),className:"text-white",children:"✕"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m("/"),className:"p-2 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Back to Exercise Log",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Dashboard - ",v(a)]}),e.jsx("small",{className:"text-gray-400",children:"Exercise Summary"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",onClick:()=>x(new Date(a.getTime()-864e5)),"aria-label":"Previous day",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",onClick:()=>x(new Date),"aria-label":"Today",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",onClick:()=>x(new Date(a.getTime()+864e5)),"aria-label":"Next day",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),e.jsx("div",{className:"space-y-4",children:g.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx("p",{children:"No exercises logged for this date"}),e.jsx("button",{onClick:()=>m("/"),className:"mt-4 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors",children:"Go to Exercise Log"})]}):g.map(t=>{const r={...t,timestamp:t.timestamp instanceof Date?t.timestamp:new Date(t.timestamp),userId:t.userId??(s?s.id:"")};return e.jsx(E,{exercise:r,onDelete:()=>w(r)},t.id||`${t.exerciseName}-${new Date(t.timestamp).getTime()}`)})}),e.jsx("button",{className:"fixed right-6 bottom-6 w-16 h-16 bg-green-600 rounded-full flex items-center justify-center text-white shadow-lg hover:bg-green-700 transition-colors",onClick:()=>m("/"),"aria-label":"Go to Exercise Log",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})};export{S as default};
//# sourceMappingURL=Dashboard-B2a1nzZ9.js.map
